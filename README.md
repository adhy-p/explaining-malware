# explaining-malware
Explaining Malware Behaviours using Graphs - NUS B. Comp. Dissertation Project

## Setting up
The programs (outside python) used in this project are as follows:
- `IDA Pro v7.6`
- `graphviz`

The python dependencies can be found in:
```
requirements.txt
```

It is recommended to create a virtual environment before installing the dependencies. To automatically install the (python) dependencies, run:
```
setup.sh
```

## Directory Structure
The directory structure of this project is as follows:
```
.
├── inputs
│   └── 00be6858156b0be404b4fa4852ffc550c25565236beaa4cb13ffe288bcb48d8e
├── outputs
│   └── 00be6858156b0be404b4fa4852ffc550c25565236beaa4cb13ffe288bcb48d8e
│       ├── behavior-graph.dot
│       └── intermediate-outputs
│           ├── capabilities.json
│           ├── cfg.dot
│           └── metadata.json
├── README.md
├── requirements.txt
├── setup.sh
└── src
    ├── behavior_graph_gen.py
    ├── capa_parser.py
    ├── ida_cfg_gen.py
    └── run_me.py
```
Explanation:
- The malware samples (PE/ELF) are located in the `inputs` directory
- The scripts used to generate the behavior graph are located in the `src` directory
- After running the script, the behavior graph is located in the `outputs/{MALWARE_NAME}/behavior-graph.dot`
  - Inside the `outputs/{MALWARE_NAME}` directory, the intermediate outputs generated in the process are preserved.
  - `capabilities.json` : list of malware capabilities generated by `capa`
  - `cfg.dot` : control flow graph of the malware in DOT format
  - `metadata.json` : contains information about the starting address and ending address of each basic block in the cfg.

## Running the program
Before running the program, put the malware samples in the `inputs/` directory. Then, go to the `src/` directory and simply type:
```
python3 run_me.py
```
