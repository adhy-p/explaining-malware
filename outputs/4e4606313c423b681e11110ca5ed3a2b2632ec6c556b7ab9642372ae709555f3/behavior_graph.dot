digraph cfg {
	graph [name=cfg];
	node [shape=box];
	0	[capa_id="[]",
		capa_node=True,
		capa_title="['contain loop', 'contain a resource (.rsrc) section']",
		end_ea=268439600,
		fill=red,
		instruction_sets="sub_10001000:\lpush    ebp\lmov     ebp, esp\lsub     esp, 10h\lmov     eax, ___security_cookie\lxor     eax, ebp\lmov     [ebp+\
var_4], eax\lpush    esi\lpush    edi\lpush    0Ah\llea     eax, [ebp+var_C]\lpush    eax\lmov     esi, edx\lpush    ecx\lmov     [\
ebp+var_10], esi\lcall    __itoa\llea     ecx, [ebp+var_C]\ladd     esp, 0Ch\llea     edx, [ecx+1]\llea     esp, [esp+0]\l",
		is_top_node=True,
		label="['contain loop', 'contain a resource (.rsrc) section']",
		location="[268439552, 268517376]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=268439552,
		style=filled];
	1	[capa_id="[]",
		capa_node=True,
		capa_title="['contain loop']",
		end_ea=268439607,
		fill=red,
		instruction_sets="mov     al, [ecx]\linc     ecx\ltest    al, al\ljnz     short loc_10001030\l",
		is_top_node=False,
		label="['contain loop']",
		location="[268439600]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=268439600,
		style=filled];
	0 -> 1	[key=0];
	1 -> 1	[key=0,
		color=darkgreen,
		label=true];
	85	[capa_id="['C0028']",
		capa_node=True,
		capa_title="['create new key via CryptAcquireContext']",
		end_ea=268440721,
		fill=red,
		instruction_sets="mov     ebx, ds:CryptAcquireContextW\lpush    10h\lpush    1\lpush    offset aMicrosoftEnhan; \"Microsoft Enhanced Cryptographic \
Provid\"...\lpush    offset aTest; \"{test}\"\llea     eax, [ebp+var_4]\lpush    eax\lcall    ebx ; CryptAcquireContextW\lpush    8\lpush    \
1\lpush    offset aMicrosoftEnhan; \"Microsoft Enhanced Cryptographic Provid\"...\lpush    offset aTest; \"{test}\"\llea     eax, [ebp+\
var_4]\lpush    eax\lcall    ebx ; CryptAcquireContextW\ltest    eax, eax\ljz      loc_1000155B\l",
		is_top_node=False,
		label="['create new key via CryptAcquireContext']",
		location="[268440693]",
		mbc_id="['C0028']",
		mbc_title="['Cryptography::Encryption Key']",
		start_ea=268440667,
		style=filled];
	86	[capa_id="['C0031']",
		capa_node=True,
		capa_title="['encrypt or decrypt via WinCrypt']",
		end_ea=268440752,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_1C]\lpush    eax\lpush    0\lpush    0\lpush    [ebp+var_C]\lpush    [ebp+var_18]\lpush    [ebp+var_4]\lcall    \
ds:CryptImportKey\ltest    eax, eax\ljz      loc_1000155B\l",
		is_top_node=False,
		label="['encrypt or decrypt via WinCrypt']",
		location="[268440738]",
		mbc_id="['C0031']",
		mbc_title="['Cryptography::Decrypt Data']",
		start_ea=268440721,
		style=filled];
	85 -> 86	[key=0,
		color=red,
		label=false];
	91	[capa_id="['C0031']",
		capa_node=True,
		capa_title="['encrypt or decrypt via WinCrypt']",
		end_ea=268440829,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_8]\lpush    eax\lmov     eax, [ebp+var_14]\lmov     eax, [eax]\ladd     eax, ebx\lpush    eax\lxor     eax, \
eax\lcmp     esi, ecx\lsetz    al\lpush    0\lpush    eax\lpush    0\lpush    [ebp+var_1C]\lcall    ds:CryptDecrypt\ltest    eax, \
eax\ljz      short loc_1000155B\l",
		is_top_node=False,
		label="['encrypt or decrypt via WinCrypt']",
		location="[268440819]",
		mbc_id="['C0031']",
		mbc_title="['Cryptography::Decrypt Data']",
		start_ea=268440792,
		style=filled];
	86 -> 91	[key=0,
		color=red,
		label=false];
	91 -> 91	[key=0,
		color=red,
		label=false];
	93	[capa_id="['C0028', 'C0031']",
		capa_node=True,
		capa_title="['create new key via CryptAcquireContext', 'encrypt or decrypt via WinCrypt']",
		end_ea=268440923,
		fill=red,
		instruction_sets="mov     esi, [ebp+var_10]\lmov     eax, [esi]\lsub     eax, ebx\lpush    eax\lmov     eax, [ebp+var_14]\lpush    0\lmov     eax, [\
eax]\ladd     eax, ebx\lpush    eax\lcall    _memset\lpush    [ebp+var_18]\lmov     [esi], ebx\lcall    j__free\ladd     esp, 10h\lpush    [\
ebp+var_1C]\lcall    ds:CryptDestroyKey\lpush    10h\lpush    1\lpush    offset aMicrosoftEnhan; \"Microsoft Enhanced Cryptographic \
Provid\"...\lpush    offset aTest; \"{test}\"\llea     eax, [ebp+var_4]\lpush    eax\lcall    ds:CryptAcquireContextW\lpush    0\lpush    [\
ebp+var_4]\lcall    ds:CryptReleaseContext\l",
		is_top_node=False,
		label="['create new key via CryptAcquireContext', 'encrypt or decrypt via WinCrypt']",
		location="[268440906]",
		mbc_id="['C0028', 'C0031']",
		mbc_title="['Cryptography::Encryption Key', 'Cryptography::Decrypt Data']",
		start_ea=268440843,
		style=filled];
	91 -> 93	[key=0,
		color=red,
		label=false];
	95	[capa_id="['T1129']",
		capa_node=True,
		capa_title="['link many functions at runtime']",
		end_ea=268440954,
		fill=red,
		instruction_sets="sub_10001570:\lpush    esi\lpush    edi\ltest    ecx, ecx\ljz      loc_10001E1A\l",
		is_top_node=True,
		label="['link many functions at runtime']",
		location="[268440944]",
		mbc_id="['T1129']",
		mbc_title="['Execution::Shared Modules']",
		start_ea=268440944,
		style=filled];
	96	[capa_id="['T1129', 'T1129']",
		capa_node=True,
		capa_title="['link function at runtime on Windows', 'link many functions at runtime']",
		end_ea=268440993,
		fill=red,
		instruction_sets="push    3B4h\lmov     edx, offset unk_10010F30\lxor     ecx, ecx\lcall    sub_10001000\lmov     edi, ds:LoadLibraryA\lpush    eax\lcall    \
edi ; LoadLibraryA\lmov     dword_10012500, eax\ltest    eax, eax\ljz      loc_10001E15\l",
		is_top_node=False,
		label="['link function at runtime on Windows', 'link many functions at runtime']",
		location="[268440978]",
		mbc_id="['T1129', 'T1129']",
		mbc_title="['Execution::Shared Modules', 'Execution::Shared Modules']",
		start_ea=268440954,
		style=filled];
	95 -> 96	[key=0,
		color=red,
		label=false];
	134	[capa_id="['T1129', 'T1129']",
		capa_node=True,
		capa_title="['link function at runtime on Windows', 'link many functions at runtime']",
		end_ea=268442703,
		fill=red,
		instruction_sets="push    3B4h\lmov     edx, offset unk_10010F30\lmov     ecx, 26h ; '&'\lcall    sub_10001000\lpush    eax\lpush    dword_1001294C\lcall    \
esi ; GetProcAddress\lmov     dword_10012958, eax\ltest    eax, eax\ljz      loc_10001E15\l",
		is_top_node=False,
		label="['link function at runtime on Windows', 'link many functions at runtime']",
		location="[268442688]",
		mbc_id="['T1129', 'T1129']",
		mbc_title="['Execution::Shared Modules', 'Execution::Shared Modules']",
		start_ea=268442661,
		style=filled];
	96 -> 134	[key=0,
		color=red,
		label=false];
	249	[capa_id="['C0042']",
		capa_node=True,
		capa_title="['create mutex']",
		end_ea=268445879,
		fill=red,
		instruction_sets="NvStart:\lpush    ebp\lmov     ebp, esp\land     esp, 0FFFFFFF8h\lsub     esp, 58h\lmov     eax, ___security_cookie\lxor     eax, \
esp\lmov     [esp+58h+var_4], eax\lpush    esi\lpush    edi\lpush    offset aMtx; \"mtx\"\lpush    1\lpush    0\lcall    ds:CreateMutexW\lpush    \
ecx\lmov     ecx, 0Fh\lmov     edi, eax\lcall    sub_10001180\lmov     esi, eax\llea     eax, [esi+2]\l",
		is_top_node=True,
		label="['create mutex']",
		location="[268445855]",
		mbc_id="['C0042']",
		mbc_title="['Process::Create Mutex']",
		start_ea=268445824,
		style=filled];
	893	[capa_id="[]",
		capa_node=True,
		capa_title="['get thread local storage value']",
		end_ea=268453628,
		fill=red,
		instruction_sets="call    ds:TlsGetValue\lpop     ebp\lretn\l",
		is_top_node=False,
		label="['get thread local storage value']",
		location="[268453620]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=268453620,
		style=filled];
	1683	[capa_id="[]",
		capa_node=True,
		capa_title="['print debug messages']",
		end_ea=268463563,
		fill=red,
		instruction_sets="push    eax; lpOutputString\lcall    ds:OutputDebugStringW\l",
		is_top_node=False,
		label="['print debug messages']",
		location="[268463557]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=268463556,
		style=filled];
	2168	[capa_id="['C0052']",
		capa_node=True,
		capa_title="['write file on Windows']",
		end_ea=268470683,
		fill=red,
		instruction_sets="push    2; SrcSizeInBytes\lpush    edx; SrcCh\llea     eax, [ebp+var_1AC4]\lpush    eax; DstCh\lcall    sub_10009415\ladd     esp, \
0Ch\lcmp     eax, 0FFFFFFFFh\ljz      loc_10008B76\l",
		is_top_node=False,
		label="['write file on Windows']",
		location="[268470656]",
		mbc_id="['C0052']",
		mbc_title="['File System::Writes File']",
		start_ea=268470656,
		style=filled];
	2168 -> 2168	[key=0,
		color=red,
		label=false];
	2228	[capa_id="['C0052']",
		capa_node=True,
		capa_title="['write file on Windows']",
		end_ea=268471965,
		fill=red,
		instruction_sets="push    0; lpOverlapped\lsub     eax, ecx\llea     edx, [ebp+var_1AD8]\lpush    edx; lpNumberOfBytesWritten\lpush    eax; nNumberOfBytesToWrite\llea     \
eax, [ebp+var_1410]\ladd     eax, ecx\lmov     ecx, [ebp+var_1AEC]\lpush    eax; lpBuffer\lmov     eax, [ebp+var_1AD0]\lmov     \
eax, dword_10011670[eax*4]\lpush    dword ptr [ecx+eax]; hFile\lcall    ds:WriteFile\ltest    eax, eax\ljz      short loc_10008EBB\l",
		is_top_node=False,
		label="['write file on Windows']",
		location="[268471955]",
		mbc_id="['C0052']",
		mbc_title="['File System::Writes File']",
		start_ea=268471912,
		style=filled];
	2228 -> 2228	[key=0,
		color=red,
		label=false];
}
