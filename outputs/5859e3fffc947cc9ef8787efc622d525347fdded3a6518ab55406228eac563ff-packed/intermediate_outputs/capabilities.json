{"meta": {"timestamp": "2023-04-04T16:10:49.473607", "version": "5.0.0", "argv": ["-j", "../inputs//5859e3fffc947cc9ef8787efc622d525347fdded3a6518ab55406228eac563ff"], "sample": {"md5": "fad06d7b4450c4631302264486611ec3", "sha1": "0d17a58c24753e5f8fd5276f62c8c7394d8e1481", "sha256": "5859e3fffc947cc9ef8787efc622d525347fdded3a6518ab55406228eac563ff", "path": "../inputs/5859e3fffc947cc9ef8787efc622d525347fdded3a6518ab55406228eac563ff"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/Desktop/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4214788}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218944}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203920}}, {"address": {"type": "absolute", "value": 4218974}}, {"address": {"type": "absolute", "value": 4218992}}, {"address": {"type": "absolute", "value": 4219003}}, {"address": {"type": "absolute", "value": 4219040}}, {"address": {"type": "absolute", "value": 4219051}}, {"address": {"type": "absolute", "value": 4219069}}, {"address": {"type": "absolute", "value": 4219080}}, {"address": {"type": "absolute", "value": 4219097}}, {"address": {"type": "absolute", "value": 4219132}}, {"address": {"type": "absolute", "value": 4219147}}, {"address": {"type": "absolute", "value": 4219176}}, {"address": {"type": "absolute", "value": 4219218}}, {"address": {"type": "absolute", "value": 4219265}}]}]}, "feature_counts": {"file": 159, "functions": [{"address": {"type": "absolute", "value": 4214788}, "count": 30}, {"address": {"type": "absolute", "value": 4218944}, "count": 99}]}, "library_functions": []}}, "rules": {"contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4218944}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218944}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4219132}, {"type": "absolute", "value": 4219117}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "packed with generic packer": {"meta": {"name": "packed with generic packer", "namespace": "anti-analysis/packer/generic", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Software Packing"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "Software Packing", "id": "T1027.002"}], "mbc": [{"parts": ["Anti-Static Analysis", "Software Packing", "Standard Compression"], "objective": "Anti-Static Analysis", "behavior": "Software Packing", "method": "Standard Compression", "id": "F0001.002"}], "references": [], "examples": ["Practical Malware Analysis Lab 18-01.exe_:0x409dc0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: packed with generic packer\n    namespace: anti-analysis/packer/generic\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]\n    mbc:\n      - Anti-Static Analysis::Software Packing::Standard Compression [F0001.002]\n    examples:\n      - Practical Malware Analysis Lab 18-01.exe_:0x409dc0\n  features:\n    - and:\n      - or:\n        - mnemonic: pusha\n        - mnemonic: pushad  # vivisect\n      - or:\n        - mnemonic: popa\n        - mnemonic: popad  # vivisect\n      - characteristic: cross section flow\n      - not:\n        - match: contain pusha popa sequence\n", "matches": [[{"type": "absolute", "value": 4218944}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "cross section flow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4219279}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "contain pusha popa sequence"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pusha"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushad"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218944}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popa"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "popad"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4219278}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "packed with UPX": {"meta": {"name": "packed with UPX", "namespace": "anti-analysis/packer/upx", "authors": ["william.ballenthin@mandiant.com"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Software Packing"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "Software Packing", "id": "T1027.002"}], "mbc": [{"parts": ["Anti-Static Analysis", "Software Packing", "UPX"], "objective": "Anti-Static Analysis", "behavior": "Software Packing", "method": "UPX", "id": "F0001.008"}], "references": [], "examples": ["CD2CBA9E6313E8DF2C1273593E649682", "Practical Malware Analysis Lab 01-02.exe_:0x0401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: packed with UPX\n    namespace: anti-analysis/packer/upx\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]\n    mbc:\n      - Anti-Static Analysis::Software Packing::UPX [F0001.008]\n    examples:\n      - CD2CBA9E6313E8DF2C1273593E649682\n      - Practical Malware Analysis Lab 01-02.exe_:0x0401000\n  features:\n    - or:\n      - and:\n        - format: pe\n        - or:\n          - section: UPX0\n          - section: UPX1\n      - and:\n        - format: elf\n        - or:\n          - string: \"UPX!\"\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "format", "format": "elf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "UPX!"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 992}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "format", "format": "pe"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "section", "section": "UPX0"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198400}], "captures": {}}, {"success": true, "node": {"feature": {"type": "section", "section": "UPX1"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214784}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "(internal) packer file limitation": {"meta": {"name": "(internal) packer file limitation", "namespace": "internal/limitation/file", "authors": ["william.ballenthin@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["CD2CBA9E6313E8DF2C1273593E649682"], "description": "This sample appears to be packed.\n\nPacked samples have often been obfuscated to hide their logic.\ncapa cannot handle obfuscation well. This means the results may be misleading or incomplete.\nIf possible, you should try to unpack this input file before analyzing it with capa.\n", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: (internal) packer file limitation\n    namespace: internal/limitation/file\n    authors:\n      - william.ballenthin@mandiant.com\n    description: |\n      This sample appears to be packed.\n\n      Packed samples have often been obfuscated to hide their logic.\n      capa cannot handle obfuscation well. This means the results may be misleading or incomplete.\n      If possible, you should try to unpack this input file before analyzing it with capa.\n    scope: file\n    examples:\n      - CD2CBA9E6313E8DF2C1273593E649682\n  features:\n    - or:\n      - match: anti-analysis/packer\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "anti-analysis/packer"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "format", "format": "elf"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "string", "string": "UPX!"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 992}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "format", "format": "pe"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "section", "section": "UPX0"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198400}], "captures": {}}, {"success": true, "node": {"feature": {"type": "section", "section": "UPX1"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214784}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "cross section flow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4219279}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "contain pusha popa sequence"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "pusha"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "pushad"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218944}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "mnemonic", "mnemonic": "popa"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "popad"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4219278}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4218944}, {"type": "no address"}], "captures": {}}], "locations": [], "captures": {}}]]}}}
