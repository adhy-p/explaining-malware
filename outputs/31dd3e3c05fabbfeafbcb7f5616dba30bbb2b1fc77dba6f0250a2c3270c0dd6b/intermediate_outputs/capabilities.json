{"meta": {"timestamp": "2023-04-04T14:56:49.358840", "version": "5.0.0", "argv": ["-j", "../inputs//31dd3e3c05fabbfeafbcb7f5616dba30bbb2b1fc77dba6f0250a2c3270c0dd6b"], "sample": {"md5": "540e4a7a28ca1514e53c2564993d8d87", "sha1": "2663eb655918c598be1b2231d7c018d8350a0ef9", "sha256": "31dd3e3c05fabbfeafbcb7f5616dba30bbb2b1fc77dba6f0250a2c3270c0dd6b", "path": "../inputs/31dd3e3c05fabbfeafbcb7f5616dba30bbb2b1fc77dba6f0250a2c3270c0dd6b"}, "analysis": {"format": "pe", "arch": "amd64", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/Desktop/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 6442450944}, "layout": {"functions": [{"address": {"type": "absolute", "value": 6442455040}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442455044}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455044}}]}, {"address": {"type": "absolute", "value": 6442455280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455280}}]}, {"address": {"type": "absolute", "value": 6442455532}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455636}}]}, {"address": {"type": "absolute", "value": 6442455656}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455656}}, {"address": {"type": "absolute", "value": 6442455792}}, {"address": {"type": "absolute", "value": 6442455951}}, {"address": {"type": "absolute", "value": 6442455974}}]}, {"address": {"type": "absolute", "value": 6442456136}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456136}}, {"address": {"type": "absolute", "value": 6442456327}}, {"address": {"type": "absolute", "value": 6442456355}}, {"address": {"type": "absolute", "value": 6442456511}}]}, {"address": {"type": "absolute", "value": 6442456556}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456606}}, {"address": {"type": "absolute", "value": 6442456663}}]}, {"address": {"type": "absolute", "value": 6442456676}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456763}}]}, {"address": {"type": "absolute", "value": 6442456776}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442456840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456840}}]}, {"address": {"type": "absolute", "value": 6442456876}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442456904}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442456936}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456983}}, {"address": {"type": "absolute", "value": 6442456994}}]}, {"address": {"type": "absolute", "value": 6442457012}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457016}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457052}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457068}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457068}}, {"address": {"type": "absolute", "value": 6442457087}}, {"address": {"type": "absolute", "value": 6442457156}}]}, {"address": {"type": "absolute", "value": 6442457188}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457220}}]}, {"address": {"type": "absolute", "value": 6442457256}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457264}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457272}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457280}}]}, {"address": {"type": "absolute", "value": 6442457492}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457500}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442457508}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457508}}, {"address": {"type": "absolute", "value": 6442457630}}, {"address": {"type": "absolute", "value": 6442457778}}, {"address": {"type": "absolute", "value": 6442457929}}, {"address": {"type": "absolute", "value": 6442458044}}, {"address": {"type": "absolute", "value": 6442458304}}]}, {"address": {"type": "absolute", "value": 6442458492}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458529}}]}, {"address": {"type": "absolute", "value": 6442458556}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459503}}]}, {"address": {"type": "absolute", "value": 6442458564}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458564}}]}, {"address": {"type": "absolute", "value": 6442458776}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458866}}]}, {"address": {"type": "absolute", "value": 6442458872}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458872}}]}, {"address": {"type": "absolute", "value": 6442458896}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458896}}]}, {"address": {"type": "absolute", "value": 6442458940}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458990}}, {"address": {"type": "absolute", "value": 6442459082}}]}, {"address": {"type": "absolute", "value": 6442459112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459112}}, {"address": {"type": "absolute", "value": 6442459248}}, {"address": {"type": "absolute", "value": 6442459432}}]}, {"address": {"type": "absolute", "value": 6442459464}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459503}}]}, {"address": {"type": "absolute", "value": 6442459512}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459512}}]}, {"address": {"type": "absolute", "value": 6442459552}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459512}}]}, {"address": {"type": "absolute", "value": 6442459560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459503}}]}, {"address": {"type": "absolute", "value": 6442459568}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459568}}]}, {"address": {"type": "absolute", "value": 6442459776}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442459780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459780}}, {"address": {"type": "absolute", "value": 6442459990}}, {"address": {"type": "absolute", "value": 6442460109}}]}, {"address": {"type": "absolute", "value": 6442460292}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442460296}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460296}}, {"address": {"type": "absolute", "value": 6442460621}}, {"address": {"type": "absolute", "value": 6442460685}}]}, {"address": {"type": "absolute", "value": 6442460712}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460712}}]}, {"address": {"type": "absolute", "value": 6442460904}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460904}}]}, {"address": {"type": "absolute", "value": 6442461020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442461020}}]}, {"address": {"type": "absolute", "value": 6442461176}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442461176}}, {"address": {"type": "absolute", "value": 6442461856}}, {"address": {"type": "absolute", "value": 6442461987}}, {"address": {"type": "absolute", "value": 6442472650}}, {"address": {"type": "absolute", "value": 6442472804}}, {"address": {"type": "absolute", "value": 6442472842}}]}, {"address": {"type": "absolute", "value": 6442462008}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442462008}}, {"address": {"type": "absolute", "value": 6442463771}}, {"address": {"type": "absolute", "value": 6442463923}}, {"address": {"type": "absolute", "value": 6442472650}}, {"address": {"type": "absolute", "value": 6442472804}}, {"address": {"type": "absolute", "value": 6442472842}}]}, {"address": {"type": "absolute", "value": 6442463944}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442463944}}]}, {"address": {"type": "absolute", "value": 6442463956}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442463956}}, {"address": {"type": "absolute", "value": 6442464025}}]}, {"address": {"type": "absolute", "value": 6442464048}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464081}}]}, {"address": {"type": "absolute", "value": 6442464088}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464130}}, {"address": {"type": "absolute", "value": 6442464222}}]}, {"address": {"type": "absolute", "value": 6442464240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442464272}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442464304}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464477}}]}, {"address": {"type": "absolute", "value": 6442464500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464542}}, {"address": {"type": "absolute", "value": 6442464582}}, {"address": {"type": "absolute", "value": 6442464603}}, {"address": {"type": "absolute", "value": 6442464624}}, {"address": {"type": "absolute", "value": 6442464643}}, {"address": {"type": "absolute", "value": 6442464679}}, {"address": {"type": "absolute", "value": 6442464703}}]}, {"address": {"type": "absolute", "value": 6442464732}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464732}}, {"address": {"type": "absolute", "value": 6442464841}}]}, {"address": {"type": "absolute", "value": 6442464860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464860}}, {"address": {"type": "absolute", "value": 6442464925}}]}, {"address": {"type": "absolute", "value": 6442464940}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464940}}]}, {"address": {"type": "absolute", "value": 6442464984}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465049}}, {"address": {"type": "absolute", "value": 6442465083}}, {"address": {"type": "absolute", "value": 6442465087}}, {"address": {"type": "absolute", "value": 6442465110}}]}, {"address": {"type": "absolute", "value": 6442465144}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442465208}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465361}}]}, {"address": {"type": "absolute", "value": 6442465392}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465563}}]}, {"address": {"type": "absolute", "value": 6442465648}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465819}}]}, {"address": {"type": "absolute", "value": 6442465884}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466055}}]}, {"address": {"type": "absolute", "value": 6442466112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466265}}]}, {"address": {"type": "absolute", "value": 6442466296}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466459}}]}, {"address": {"type": "absolute", "value": 6442466500}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442466788}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467005}}, {"address": {"type": "absolute", "value": 6442467073}}]}, {"address": {"type": "absolute", "value": 6442467100}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467100}}, {"address": {"type": "absolute", "value": 6442467194}}]}, {"address": {"type": "absolute", "value": 6442467220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467100}}, {"address": {"type": "absolute", "value": 6442467194}}]}, {"address": {"type": "absolute", "value": 6442467236}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442467276}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442467300}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442467372}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467567}}]}, {"address": {"type": "absolute", "value": 6442467580}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467783}}]}, {"address": {"type": "absolute", "value": 6442467820}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468017}}]}, {"address": {"type": "absolute", "value": 6442468056}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467783}}, {"address": {"type": "absolute", "value": 6442468056}}]}, {"address": {"type": "absolute", "value": 6442468092}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468017}}, {"address": {"type": "absolute", "value": 6442468106}}, {"address": {"type": "absolute", "value": 6442468132}}]}, {"address": {"type": "absolute", "value": 6442468140}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468311}}]}, {"address": {"type": "absolute", "value": 6442468360}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467783}}, {"address": {"type": "absolute", "value": 6442468056}}]}, {"address": {"type": "absolute", "value": 6442468368}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468017}}, {"address": {"type": "absolute", "value": 6442468106}}, {"address": {"type": "absolute", "value": 6442468132}}]}, {"address": {"type": "absolute", "value": 6442468376}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468477}}]}, {"address": {"type": "absolute", "value": 6442468488}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469169}}]}, {"address": {"type": "absolute", "value": 6442469196}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469877}}]}, {"address": {"type": "absolute", "value": 6442469904}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442470056}}]}, {"address": {"type": "absolute", "value": 6442470084}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442470245}}]}, {"address": {"type": "absolute", "value": 6442470284}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442470886}}, {"address": {"type": "absolute", "value": 6442471135}}]}, {"address": {"type": "absolute", "value": 6442471164}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442471376}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442472228}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442472440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442472469}}]}, {"address": {"type": "absolute", "value": 6442472480}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442472508}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442472650}}, {"address": {"type": "absolute", "value": 6442472804}}, {"address": {"type": "absolute", "value": 6442472842}}]}, {"address": {"type": "absolute", "value": 6442472964}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442473004}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442473032}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473062}}, {"address": {"type": "absolute", "value": 6442473081}}]}, {"address": {"type": "absolute", "value": 6442473116}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473195}}]}, {"address": {"type": "absolute", "value": 6442473228}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473228}}]}, {"address": {"type": "absolute", "value": 6442473292}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473355}}, {"address": {"type": "absolute", "value": 6442473390}}, {"address": {"type": "absolute", "value": 6442473422}}, {"address": {"type": "absolute", "value": 6442473459}}, {"address": {"type": "absolute", "value": 6442473465}}, {"address": {"type": "absolute", "value": 6442473499}}]}, {"address": {"type": "absolute", "value": 6442473508}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473541}}]}, {"address": {"type": "absolute", "value": 6442473560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473593}}]}, {"address": {"type": "absolute", "value": 6442473608}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473541}}, {"address": {"type": "absolute", "value": 6442473608}}, {"address": {"type": "absolute", "value": 6442473665}}, {"address": {"type": "absolute", "value": 6442473690}}]}, {"address": {"type": "absolute", "value": 6442473724}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473757}}]}, {"address": {"type": "absolute", "value": 6442473772}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442473881}}, {"address": {"type": "absolute", "value": 6442473964}}]}, {"address": {"type": "absolute", "value": 6442473976}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474036}}, {"address": {"type": "absolute", "value": 6442474040}}]}, {"address": {"type": "absolute", "value": 6442474072}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474121}}]}, {"address": {"type": "absolute", "value": 6442474148}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474148}}, {"address": {"type": "absolute", "value": 6442474217}}, {"address": {"type": "absolute", "value": 6442474242}}]}, {"address": {"type": "absolute", "value": 6442474272}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442474280}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474333}}]}, {"address": {"type": "absolute", "value": 6442474372}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474544}}]}, {"address": {"type": "absolute", "value": 6442474624}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442474795}}]}, {"address": {"type": "absolute", "value": 6442474852}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442475023}}]}, {"address": {"type": "absolute", "value": 6442475080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442475243}}]}, {"address": {"type": "absolute", "value": 6442475284}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442475455}}]}, {"address": {"type": "absolute", "value": 6442475504}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442475865}}]}, {"address": {"type": "absolute", "value": 6442475912}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476091}}]}, {"address": {"type": "absolute", "value": 6442476112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476172}}, {"address": {"type": "absolute", "value": 6442476203}}]}, {"address": {"type": "absolute", "value": 6442476220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476220}}, {"address": {"type": "absolute", "value": 6442476333}}]}, {"address": {"type": "absolute", "value": 6442476344}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476473}}]}, {"address": {"type": "absolute", "value": 6442476492}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476672}}]}, {"address": {"type": "absolute", "value": 6442476696}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476715}}, {"address": {"type": "absolute", "value": 6442476760}}]}, {"address": {"type": "absolute", "value": 6442476772}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476772}}, {"address": {"type": "absolute", "value": 6442476790}}]}, {"address": {"type": "absolute", "value": 6442476932}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442476932}}, {"address": {"type": "absolute", "value": 6442476986}}]}, {"address": {"type": "absolute", "value": 6442477000}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477061}}]}, {"address": {"type": "absolute", "value": 6442477084}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477084}}]}, {"address": {"type": "absolute", "value": 6442477164}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477287}}, {"address": {"type": "absolute", "value": 6442477297}}]}, {"address": {"type": "absolute", "value": 6442477324}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477324}}]}, {"address": {"type": "absolute", "value": 6442477384}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477466}}, {"address": {"type": "absolute", "value": 6442477502}}, {"address": {"type": "absolute", "value": 6442477591}}]}, {"address": {"type": "absolute", "value": 6442477636}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477698}}, {"address": {"type": "absolute", "value": 6442477743}}]}, {"address": {"type": "absolute", "value": 6442477780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442477895}}, {"address": {"type": "absolute", "value": 6442477907}}]}, {"address": {"type": "absolute", "value": 6442477936}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442478133}}]}, {"address": {"type": "absolute", "value": 6442478144}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442478144}}, {"address": {"type": "absolute", "value": 6442479129}}]}, {"address": {"type": "absolute", "value": 6442479156}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442479196}}]}, {"address": {"type": "absolute", "value": 6442479252}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442479311}}]}, {"address": {"type": "absolute", "value": 6442479340}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442479340}}]}, {"address": {"type": "absolute", "value": 6442479500}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442479523}}]}, {"address": {"type": "absolute", "value": 6442479616}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442479785}}, {"address": {"type": "absolute", "value": 6442480037}}, {"address": {"type": "absolute", "value": 6442480148}}]}, {"address": {"type": "absolute", "value": 6442480232}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442480232}}, {"address": {"type": "absolute", "value": 6442480424}}, {"address": {"type": "absolute", "value": 6442480585}}]}, {"address": {"type": "absolute", "value": 6442480616}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442480705}}]}, {"address": {"type": "absolute", "value": 6442480716}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442480716}}]}, {"address": {"type": "absolute", "value": 6442481316}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442481392}}, {"address": {"type": "absolute", "value": 6442482194}}]}, {"address": {"type": "absolute", "value": 6442482224}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442482224}}, {"address": {"type": "absolute", "value": 6442482809}}, {"address": {"type": "absolute", "value": 6442482922}}, {"address": {"type": "absolute", "value": 6442483093}}]}, {"address": {"type": "absolute", "value": 6442483172}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442483172}}, {"address": {"type": "absolute", "value": 6442483655}}, {"address": {"type": "absolute", "value": 6442483809}}, {"address": {"type": "absolute", "value": 6442483906}}]}, {"address": {"type": "absolute", "value": 6442483992}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442484262}}, {"address": {"type": "absolute", "value": 6442484505}}, {"address": {"type": "absolute", "value": 6442484664}}]}, {"address": {"type": "absolute", "value": 6442484684}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442484735}}, {"address": {"type": "absolute", "value": 6442484757}}, {"address": {"type": "absolute", "value": 6442484822}}]}, {"address": {"type": "absolute", "value": 6442484840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442485113}}, {"address": {"type": "absolute", "value": 6442485343}}, {"address": {"type": "absolute", "value": 6442485465}}]}, {"address": {"type": "absolute", "value": 6442485504}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442485504}}, {"address": {"type": "absolute", "value": 6442485547}}, {"address": {"type": "absolute", "value": 6442485627}}]}, {"address": {"type": "absolute", "value": 6442485636}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442485636}}, {"address": {"type": "absolute", "value": 6442485740}}, {"address": {"type": "absolute", "value": 6442485904}}, {"address": {"type": "absolute", "value": 6442485947}}, {"address": {"type": "absolute", "value": 6442486631}}, {"address": {"type": "absolute", "value": 6442486713}}, {"address": {"type": "absolute", "value": 6442486889}}]}, {"address": {"type": "absolute", "value": 6442487400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487400}}, {"address": {"type": "absolute", "value": 6442487422}}]}, {"address": {"type": "absolute", "value": 6442487432}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442487472}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487612}}]}, {"address": {"type": "absolute", "value": 6442487644}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487726}}]}, {"address": {"type": "absolute", "value": 6442487744}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487744}}, {"address": {"type": "absolute", "value": 6442487849}}]}, {"address": {"type": "absolute", "value": 6442487860}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487926}}]}, {"address": {"type": "absolute", "value": 6442487932}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442487955}}, {"address": {"type": "absolute", "value": 6442487965}}]}, {"address": {"type": "absolute", "value": 6442487976}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442488041}}, {"address": {"type": "absolute", "value": 6442488082}}]}, {"address": {"type": "absolute", "value": 6442488136}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442488172}}]}, {"address": {"type": "absolute", "value": 6442488184}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442488256}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442488306}}, {"address": {"type": "absolute", "value": 6442488397}}, {"address": {"type": "absolute", "value": 6442488530}}]}, {"address": {"type": "absolute", "value": 6442488544}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442488627}}, {"address": {"type": "absolute", "value": 6442488658}}, {"address": {"type": "absolute", "value": 6442488914}}]}, {"address": {"type": "absolute", "value": 6442488964}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442488964}}]}, {"address": {"type": "absolute", "value": 6442489012}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489108}}]}, {"address": {"type": "absolute", "value": 6442489124}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489160}}]}, {"address": {"type": "absolute", "value": 6442489172}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489205}}]}, {"address": {"type": "absolute", "value": 6442489220}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489318}}, {"address": {"type": "absolute", "value": 6442489401}}, {"address": {"type": "absolute", "value": 6442489605}}, {"address": {"type": "absolute", "value": 6442489649}}, {"address": {"type": "absolute", "value": 6442489686}}]}, {"address": {"type": "absolute", "value": 6442489708}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489896}}, {"address": {"type": "absolute", "value": 6442489913}}]}, {"address": {"type": "absolute", "value": 6442489932}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442489991}}, {"address": {"type": "absolute", "value": 6442490513}}]}, {"address": {"type": "absolute", "value": 6442490544}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442490544}}, {"address": {"type": "absolute", "value": 6442490616}}, {"address": {"type": "absolute", "value": 6442491103}}, {"address": {"type": "absolute", "value": 6442491186}}, {"address": {"type": "absolute", "value": 6442491215}}]}, {"address": {"type": "absolute", "value": 6442491284}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442491296}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442491390}}]}, {"address": {"type": "absolute", "value": 6442491412}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442491449}}]}, {"address": {"type": "absolute", "value": 6442491468}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442491468}}, {"address": {"type": "absolute", "value": 6442491687}}]}, {"address": {"type": "absolute", "value": 6442491712}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442491718}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442491724}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 6442491730}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 640, "functions": [{"address": {"type": "absolute", "value": 6442455040}, "count": 8}, {"address": {"type": "absolute", "value": 6442455044}, "count": 65}, {"address": {"type": "absolute", "value": 6442455280}, "count": 74}, {"address": {"type": "absolute", "value": 6442455532}, "count": 32}, {"address": {"type": "absolute", "value": 6442455656}, "count": 82}, {"address": {"type": "absolute", "value": 6442456136}, "count": 83}, {"address": {"type": "absolute", "value": 6442456556}, "count": 51}, {"address": {"type": "absolute", "value": 6442456676}, "count": 27}, {"address": {"type": "absolute", "value": 6442456776}, "count": 30}, {"address": {"type": "absolute", "value": 6442456840}, "count": 20}, {"address": {"type": "absolute", "value": 6442456936}, "count": 36}, {"address": {"type": "absolute", "value": 6442457012}, "count": 6}, {"address": {"type": "absolute", "value": 6442457016}, "count": 14}, {"address": {"type": "absolute", "value": 6442457052}, "count": 12}, {"address": {"type": "absolute", "value": 6442457068}, "count": 61}, {"address": {"type": "absolute", "value": 6442457188}, "count": 33}, {"address": {"type": "absolute", "value": 6442457272}, "count": 11}, {"address": {"type": "absolute", "value": 6442457280}, "count": 59}, {"address": {"type": "absolute", "value": 6442457500}, "count": 11}, {"address": {"type": "absolute", "value": 6442457508}, "count": 147}, {"address": {"type": "absolute", "value": 6442458492}, "count": 30}, {"address": {"type": "absolute", "value": 6442458556}, "count": 26}, {"address": {"type": "absolute", "value": 6442458564}, "count": 67}, {"address": {"type": "absolute", "value": 6442458776}, "count": 42}, {"address": {"type": "absolute", "value": 6442458872}, "count": 16}, {"address": {"type": "absolute", "value": 6442458896}, "count": 26}, {"address": {"type": "absolute", "value": 6442458940}, "count": 63}, {"address": {"type": "absolute", "value": 6442459112}, "count": 62}, {"address": {"type": "absolute", "value": 6442459464}, "count": 23}, {"address": {"type": "absolute", "value": 6442459512}, "count": 24}, {"address": {"type": "absolute", "value": 6442459552}, "count": 24}, {"address": {"type": "absolute", "value": 6442459560}, "count": 24}, {"address": {"type": "absolute", "value": 6442459568}, "count": 66}, {"address": {"type": "absolute", "value": 6442459776}, "count": 7}, {"address": {"type": "absolute", "value": 6442459780}, "count": 95}, {"address": {"type": "absolute", "value": 6442460292}, "count": 9}, {"address": {"type": "absolute", "value": 6442460296}, "count": 112}, {"address": {"type": "absolute", "value": 6442460712}, "count": 63}, {"address": {"type": "absolute", "value": 6442460904}, "count": 56}, {"address": {"type": "absolute", "value": 6442461020}, "count": 48}, {"address": {"type": "absolute", "value": 6442461176}, "count": 137}, {"address": {"type": "absolute", "value": 6442462008}, "count": 198}, {"address": {"type": "absolute", "value": 6442463944}, "count": 12}, {"address": {"type": "absolute", "value": 6442463956}, "count": 50}, {"address": {"type": "absolute", "value": 6442464048}, "count": 18}, {"address": {"type": "absolute", "value": 6442464088}, "count": 47}, {"address": {"type": "absolute", "value": 6442464240}, "count": 20}, {"address": {"type": "absolute", "value": 6442464272}, "count": 22}, {"address": {"type": "absolute", "value": 6442464304}, "count": 43}, {"address": {"type": "absolute", "value": 6442464500}, "count": 72}, {"address": {"type": "absolute", "value": 6442464732}, "count": 36}, {"address": {"type": "absolute", "value": 6442464860}, "count": 37}, {"address": {"type": "absolute", "value": 6442464940}, "count": 26}, {"address": {"type": "absolute", "value": 6442464984}, "count": 68}, {"address": {"type": "absolute", "value": 6442465144}, "count": 33}, {"address": {"type": "absolute", "value": 6442465208}, "count": 55}, {"address": {"type": "absolute", "value": 6442465392}, "count": 69}, {"address": {"type": "absolute", "value": 6442465648}, "count": 67}, {"address": {"type": "absolute", "value": 6442465884}, "count": 59}, {"address": {"type": "absolute", "value": 6442466112}, "count": 54}, {"address": {"type": "absolute", "value": 6442466296}, "count": 55}, {"address": {"type": "absolute", "value": 6442466500}, "count": 81}, {"address": {"type": "absolute", "value": 6442466788}, "count": 68}, {"address": {"type": "absolute", "value": 6442467100}, "count": 40}, {"address": {"type": "absolute", "value": 6442467220}, "count": 45}, {"address": {"type": "absolute", "value": 6442467236}, "count": 17}, {"address": {"type": "absolute", "value": 6442467276}, "count": 15}, {"address": {"type": "absolute", "value": 6442467300}, "count": 27}, {"address": {"type": "absolute", "value": 6442467372}, "count": 51}, {"address": {"type": "absolute", "value": 6442467580}, "count": 61}, {"address": {"type": "absolute", "value": 6442467820}, "count": 59}, {"address": {"type": "absolute", "value": 6442468056}, "count": 66}, {"address": {"type": "absolute", "value": 6442468092}, "count": 64}, {"address": {"type": "absolute", "value": 6442468140}, "count": 59}, {"address": {"type": "absolute", "value": 6442468360}, "count": 66}, {"address": {"type": "absolute", "value": 6442468368}, "count": 64}, {"address": {"type": "absolute", "value": 6442468376}, "count": 27}, {"address": {"type": "absolute", "value": 6442468488}, "count": 72}, {"address": {"type": "absolute", "value": 6442469196}, "count": 72}, {"address": {"type": "absolute", "value": 6442469904}, "count": 55}, {"address": {"type": "absolute", "value": 6442470084}, "count": 59}, {"address": {"type": "absolute", "value": 6442470284}, "count": 110}, {"address": {"type": "absolute", "value": 6442471164}, "count": 66}, {"address": {"type": "absolute", "value": 6442471376}, "count": 107}, {"address": {"type": "absolute", "value": 6442472228}, "count": 66}, {"address": {"type": "absolute", "value": 6442472440}, "count": 25}, {"address": {"type": "absolute", "value": 6442472480}, "count": 23}, {"address": {"type": "absolute", "value": 6442472508}, "count": 90}, {"address": {"type": "absolute", "value": 6442472964}, "count": 22}, {"address": {"type": "absolute", "value": 6442473004}, "count": 17}, {"address": {"type": "absolute", "value": 6442473032}, "count": 22}, {"address": {"type": "absolute", "value": 6442473116}, "count": 39}, {"address": {"type": "absolute", "value": 6442473228}, "count": 29}, {"address": {"type": "absolute", "value": 6442473292}, "count": 58}, {"address": {"type": "absolute", "value": 6442473508}, "count": 27}, {"address": {"type": "absolute", "value": 6442473560}, "count": 24}, {"address": {"type": "absolute", "value": 6442473608}, "count": 55}, {"address": {"type": "absolute", "value": 6442473724}, "count": 24}, {"address": {"type": "absolute", "value": 6442473772}, "count": 53}, {"address": {"type": "absolute", "value": 6442473976}, "count": 48}, {"address": {"type": "absolute", "value": 6442474072}, "count": 41}, {"address": {"type": "absolute", "value": 6442474148}, "count": 49}, {"address": {"type": "absolute", "value": 6442474272}, "count": 8}, {"address": {"type": "absolute", "value": 6442474280}, "count": 35}, {"address": {"type": "absolute", "value": 6442474372}, "count": 69}, {"address": {"type": "absolute", "value": 6442474624}, "count": 63}, {"address": {"type": "absolute", "value": 6442474852}, "count": 63}, {"address": {"type": "absolute", "value": 6442475080}, "count": 55}, {"address": {"type": "absolute", "value": 6442475284}, "count": 63}, {"address": {"type": "absolute", "value": 6442475504}, "count": 41}, {"address": {"type": "absolute", "value": 6442475912}, "count": 55}, {"address": {"type": "absolute", "value": 6442476112}, "count": 35}, {"address": {"type": "absolute", "value": 6442476220}, "count": 45}, {"address": {"type": "absolute", "value": 6442476344}, "count": 55}, {"address": {"type": "absolute", "value": 6442476492}, "count": 64}, {"address": {"type": "absolute", "value": 6442476696}, "count": 46}, {"address": {"type": "absolute", "value": 6442476772}, "count": 63}, {"address": {"type": "absolute", "value": 6442476932}, "count": 30}, {"address": {"type": "absolute", "value": 6442477000}, "count": 37}, {"address": {"type": "absolute", "value": 6442477084}, "count": 29}, {"address": {"type": "absolute", "value": 6442477164}, "count": 56}, {"address": {"type": "absolute", "value": 6442477324}, "count": 23}, {"address": {"type": "absolute", "value": 6442477384}, "count": 69}, {"address": {"type": "absolute", "value": 6442477636}, "count": 53}, {"address": {"type": "absolute", "value": 6442477780}, "count": 38}, {"address": {"type": "absolute", "value": 6442477936}, "count": 36}, {"address": {"type": "absolute", "value": 6442478144}, "count": 102}, {"address": {"type": "absolute", "value": 6442479156}, "count": 37}, {"address": {"type": "absolute", "value": 6442479252}, "count": 35}, {"address": {"type": "absolute", "value": 6442479340}, "count": 42}, {"address": {"type": "absolute", "value": 6442479500}, "count": 48}, {"address": {"type": "absolute", "value": 6442479616}, "count": 95}, {"address": {"type": "absolute", "value": 6442480232}, "count": 83}, {"address": {"type": "absolute", "value": 6442480616}, "count": 27}, {"address": {"type": "absolute", "value": 6442480716}, "count": 81}, {"address": {"type": "absolute", "value": 6442481316}, "count": 94}, {"address": {"type": "absolute", "value": 6442482224}, "count": 135}, {"address": {"type": "absolute", "value": 6442483172}, "count": 138}, {"address": {"type": "absolute", "value": 6442483992}, "count": 123}, {"address": {"type": "absolute", "value": 6442484684}, "count": 66}, {"address": {"type": "absolute", "value": 6442484840}, "count": 115}, {"address": {"type": "absolute", "value": 6442485504}, "count": 52}, {"address": {"type": "absolute", "value": 6442485636}, "count": 123}, {"address": {"type": "absolute", "value": 6442487400}, "count": 23}, {"address": {"type": "absolute", "value": 6442487432}, "count": 9}, {"address": {"type": "absolute", "value": 6442487472}, "count": 49}, {"address": {"type": "absolute", "value": 6442487644}, "count": 50}, {"address": {"type": "absolute", "value": 6442487744}, "count": 54}, {"address": {"type": "absolute", "value": 6442487860}, "count": 34}, {"address": {"type": "absolute", "value": 6442487932}, "count": 35}, {"address": {"type": "absolute", "value": 6442487976}, "count": 63}, {"address": {"type": "absolute", "value": 6442488136}, "count": 26}, {"address": {"type": "absolute", "value": 6442488184}, "count": 17}, {"address": {"type": "absolute", "value": 6442488256}, "count": 77}, {"address": {"type": "absolute", "value": 6442488544}, "count": 101}, {"address": {"type": "absolute", "value": 6442488964}, "count": 23}, {"address": {"type": "absolute", "value": 6442489012}, "count": 36}, {"address": {"type": "absolute", "value": 6442489124}, "count": 26}, {"address": {"type": "absolute", "value": 6442489172}, "count": 24}, {"address": {"type": "absolute", "value": 6442489220}, "count": 99}, {"address": {"type": "absolute", "value": 6442489708}, "count": 65}, {"address": {"type": "absolute", "value": 6442489932}, "count": 88}, {"address": {"type": "absolute", "value": 6442490544}, "count": 93}, {"address": {"type": "absolute", "value": 6442491284}, "count": 11}, {"address": {"type": "absolute", "value": 6442491296}, "count": 47}, {"address": {"type": "absolute", "value": 6442491412}, "count": 31}, {"address": {"type": "absolute", "value": 6442491468}, "count": 65}, {"address": {"type": "absolute", "value": 6442491712}, "count": 8}, {"address": {"type": "absolute", "value": 6442491718}, "count": 8}, {"address": {"type": "absolute", "value": 6442491724}, "count": 8}, {"address": {"type": "absolute", "value": 6442491730}, "count": 8}]}, "library_functions": [{"address": {"type": "absolute", "value": 6442456876}, "name": "strchr"}, {"address": {"type": "absolute", "value": 6442456904}, "name": "?__memcpy@@YAPEAXPEAXPEBX_K@Z"}, {"address": {"type": "absolute", "value": 6442457256}, "name": "?"}, {"address": {"type": "absolute", "value": 6442457264}, "name": "?"}, {"address": {"type": "absolute", "value": 6442457492}, "name": "?"}]}}, "rules": {"calculate modulo 256 via x86 assembly": {"meta": {"name": "calculate modulo 256 via x86 assembly", "authors": ["moritz.raabe@mandiant.com"], "scope": "instruction", "attack": [], "mbc": [{"parts": ["Data", "Modulo"], "objective": "Data", "behavior": "Modulo", "method": "", "id": "C0058"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n", "matches": [[{"type": "absolute", "value": 6442472820}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442472820}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442472820}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "encode data using Base64 via WinAPI": {"meta": {"name": "encode data using Base64 via WinAPI", "namespace": "data-manipulation/encoding/base64", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [], "references": [], "examples": ["mimikatz.exe_:0x40622D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encode data using Base64 via WinAPI\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    examples:\n      - mimikatz.exe_:0x40622D\n  features:\n    - and:\n      - number: 1 = dwFlags=CRYPT_STRING_BASE64\n      - api: CryptBinaryToString\n", "matches": [[{"type": "absolute", "value": 6442455044}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "dwFlags=CRYPT_STRING_BASE64"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455228}, {"type": "absolute", "value": 6442455087}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "CryptBinaryToString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455195}, {"type": "absolute", "value": 6442455102}], "captures": {}}], "locations": [], "captures": {}}]]}, "decode data using Base64 via WinAPI": {"meta": {"name": "decode data using Base64 via WinAPI", "namespace": "data-manipulation/encoding/base64", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Deobfuscate/Decode Files or Information"], "tactic": "Defense Evasion", "technique": "Deobfuscate/Decode Files or Information", "subtechnique": "", "id": "T1140"}], "mbc": [], "references": [], "examples": ["mimikatz.exe_:0x40D742"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: decode data using Base64 via WinAPI\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Deobfuscate/Decode Files or Information [T1140]\n    examples:\n      - mimikatz.exe_:0x40D742\n  features:\n    - and:\n      - or:\n        - number: 0x1 = dwFlags=CRYPT_STRING_BASE64\n        - number: 0x6 = dwFlags=CRYPT_STRING_BASE64_ANY\n        - number: 0x7 = dwFlags=CRYPT_STRING_ANY\n      - api: CryptStringToBinary\n", "matches": [[{"type": "absolute", "value": 6442455280}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CryptStringToBinary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455339}, {"type": "absolute", "value": 6442455444}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "dwFlags=CRYPT_STRING_BASE64"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455368}, {"type": "absolute", "value": 6442455425}, {"type": "absolute", "value": 6442455473}, {"type": "absolute", "value": 6442455335}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 6, "description": "dwFlags=CRYPT_STRING_BASE64_ANY"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 7, "description": "dwFlags=CRYPT_STRING_ANY"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "encode data using XOR": {"meta": {"name": "encode data using XOR", "namespace": "data-manipulation/encoding/xor", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Encoding-Standard Algorithm"], "objective": "Defense Evasion", "behavior": "Obfuscated Files or Information", "method": "Encoding-Standard Algorithm", "id": "E1027.m02"}, {"parts": ["Data", "Encode Data", "XOR"], "objective": "Data", "behavior": "Encode Data", "method": "XOR", "id": "C0026.002"}], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403D7E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n", "matches": [[{"type": "absolute", "value": 6442455951}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455951}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455964}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442456327}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456327}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456340}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442456606}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456606}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456645}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442479196}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442479196}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442479206}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 6442457087}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457150}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458564}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458660}, {"type": "absolute", "value": 6442458581}, {"type": "absolute", "value": 6442458743}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484262}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484267}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484505}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484510}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484735}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484740}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485113}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485118}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485343}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485348}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485778}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485904}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485906}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485947}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485949}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 6442457630}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457703}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 6442457929}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457968}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458044}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458212}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 6442458304}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458371}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442488397}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488426}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442489649}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489678}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 6442461020}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442461059}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "PEB access": {"meta": {"name": "PEB access", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block", "id": "B0001.019"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x420D20"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n", "matches": [[{"type": "absolute", "value": 6442463944}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463944}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/92748920e88c4393bed62c8a8991b23d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/6ee4f69365124c8f9e63d2e1667bf49d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463944}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/052a2fb05e4e49829acecc636679fe79"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442463956}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/92748920e88c4393bed62c8a8991b23d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/6ee4f69365124c8f9e63d2e1667bf49d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/052a2fb05e4e49829acecc636679fe79"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "access PEB ldr_data": {"meta": {"name": "access PEB ldr_data", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": ["https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm", "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"], "examples": ["3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n", "matches": [[{"type": "absolute", "value": 6442463956}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and", "description": "x32"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/92748920e88c4393bed62c8a8991b23d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/6ee4f69365124c8f9e63d2e1667bf49d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/052a2fb05e4e49829acecc636679fe79"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442463956}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 12, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 28, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and", "description": "x64"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "PEB access"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/92748920e88c4393bed62c8a8991b23d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/6ee4f69365124c8f9e63d2e1667bf49d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463971}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/052a2fb05e4e49829acecc636679fe79"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442463956}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "PEB.LDR_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463982}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or", "description": "resolve a module list"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 16, "description": "PEB.LDR_DATA.InLoadOrderModuleList"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463961}, {"type": "absolute", "value": 6442463986}], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 32, "description": "PEB.LDR_DATA.InMemoryOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 48, "description": "PEB.LDR_DATA.InInitializationOrderModuleList"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get HTTP content length": {"meta": {"name": "get HTTP content length", "namespace": "communication/http", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication"], "objective": "Communication", "behavior": "HTTP Communication", "method": "", "id": "C0002"}], "references": [], "examples": ["0596c4ea5aa8def47f22c85d75aaca95:0x1079C70"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get HTTP content length\n    namespace: communication/http\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    mbc:\n      - Communication::HTTP Communication [C0002]\n    examples:\n      - 0596c4ea5aa8def47f22c85d75aaca95:0x1079C70\n  features:\n    - and:\n      - api: wininet.HttpQueryInfo\n      - number: 0x20000005 = HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_CONTENT_LENGTH\n", "matches": [[{"type": "absolute", "value": 6442483655}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpQueryInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483697}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 536870917, "description": "HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_CONTENT_LENGTH"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483681}], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 6442455656}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442455951}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442456136}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456327}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442456556}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456606}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442456776}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442456776}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458776}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458850}, {"type": "absolute", "value": 6442458803}, {"type": "absolute", "value": 6442458827}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458940}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442459112}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459248}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442459780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460109}, {"type": "absolute", "value": 6442459958}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461176}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442461176}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472631}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462008}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442462008}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472631}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442463956}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442463956}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464500}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464500}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464984}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464984}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465144}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442465144}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467236}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467257}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467276}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467286}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467300}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467300}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467372}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467466}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467580}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467682}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467820}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467916}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442468056}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467682}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442468092}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467916}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442468360}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467682}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442468368}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442467916}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442470284}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442470284}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442471376}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442471376}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442472480}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472496}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442472508}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472508}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472631}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442472964}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472964}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473004}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473004}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473032}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473032}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473073}, {"type": "absolute", "value": 6442473054}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473116}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473152}, {"type": "absolute", "value": 6442473184}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473292}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473292}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473450}, {"type": "absolute", "value": 6442473339}, {"type": "absolute", "value": 6442473414}, {"type": "absolute", "value": 6442473382}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473608}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473608}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473772}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473904}, {"type": "absolute", "value": 6442473873}, {"type": "absolute", "value": 6442473805}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442473976}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442473976}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442474072}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442474072}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442474148}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442474148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442476112}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442476112}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442476696}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442476715}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442477000}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442477042}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442477164}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442477164}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442477384}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442477384}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442477636}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442477636}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442477780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442477780}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442478144}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442478144}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442478144}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442479156}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442479156}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442479196}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442479616}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442479616}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484684}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484684}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484840}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442485636}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485636}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442487976}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442487976}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442488256}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488256}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442488544}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488914}, {"type": "absolute", "value": 6442488627}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442490544}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442490544}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442491296}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442491296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete file": {"meta": {"name": "delete file", "namespace": "host-interaction/file-system/delete", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Delete File"], "objective": "File System", "behavior": "Delete File", "method": "", "id": "C0047"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x100015F0", "31600AD0D1A7EA615690DF111AE36C73:0x401A15", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n", "matches": [[{"type": "absolute", "value": 6442457068}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457160}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484568}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442485406}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query environment variable": {"meta": {"name": "query environment variable", "namespace": "host-interaction/environment-variable", "authors": ["michael.hunhoff@mandiant.com", "@_re_fox"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x401880", "0761142efbda6c4b1e801223de723578:0x65483490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n", "matches": [[{"type": "absolute", "value": 6442457280}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457405}, {"type": "absolute", "value": 6442457319}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create directory": {"meta": {"name": "create directory", "namespace": "host-interaction/file-system/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Create Directory"], "objective": "File System", "behavior": "Create Directory", "method": "", "id": "C0046"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x10008f62", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create directory\n    namespace: host-interaction/file-system/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Create Directory [C0046]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x10008f62\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.CreateDirectory\n      - api: kernel32.CreateDirectoryEx\n      - api: kernel32.CreateDirectoryTransacted\n      - api: NtCreateDirectoryObject\n      - api: ZwCreateDirectoryObject\n      - api: SHCreateDirectory\n      - api: SHCreateDirectoryEx\n      - api: _mkdir\n      - api: _wmkdir\n      - api: System.IO.Directory::CreateDirectory\n      - api: System.IO.DirectoryInfo::Create\n      - api: System.IO.DirectoryInfo::CreateSubdirectory\n", "matches": [[{"type": "absolute", "value": 6442457508}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457551}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 6442457508}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457682}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457703}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457673}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457808}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write and execute a file": {"meta": {"name": "write and execute a file", "namespace": "communication/c2/file-transfer", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Execution", "Install Additional Program"], "objective": "Execution", "behavior": "Install Additional Program", "method": "", "id": "B0023"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403A40", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {"malware_category": "launcher"}}, "source": "rule:\n  meta:\n    name: write and execute a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: launcher\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403A40\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n  features:\n    - and:\n      - match: host-interaction/file-system/write\n      - match: host-interaction/process/create\n", "matches": [[{"type": "absolute", "value": 6442457508}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/write"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457682}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457703}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457673}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457808}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442457508}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457968}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442458212}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442457929}, {"type": "absolute", "value": 6442458044}], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 6442459568}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459734}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459669}, {"type": "absolute", "value": 6442459686}, {"type": "absolute", "value": 6442459703}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460296}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460331}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 6442459780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459906}, {"type": "absolute", "value": 6442460060}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459981}, {"type": "absolute", "value": 6442460143}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459817}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442459814}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442459780}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get system information on Windows": {"meta": {"name": "get system information on Windows", "namespace": "host-interaction/os/info", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n", "matches": [[{"type": "absolute", "value": 6442460296}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460400}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check OS version": {"meta": {"name": "check OS version", "namespace": "host-interaction/os/version", "authors": ["michael.hunhoff@mandiant.com", "johnk3r"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check OS version\n    namespace: host-interaction/os/version\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - and:\n      - match: get OS version\n      - or:\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 5 = Windows 2000\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows XP\n                - number: 2 = Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 6 = Windows Vista / Windows Server 2008\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows Server 2008 R2 / Windows 7\n                - number: 2 = Windows Server 2012 / Windows 8\n                - number: 3 = Windows Server 2012 R2 / Windows 8.1\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 10 = Windows Server 2016 / Windows Server 2019 / Windows 10\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - number: 0\n", "matches": [[{"type": "absolute", "value": 6442460296}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "get OS version"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460331}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442460296}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460459}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 5, "description": "Windows 2000"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460459}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442460459}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460484}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "Windows XP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460484}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460589}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "Windows XP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460589}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442460484}, {"type": "absolute", "value": 6442460589}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check OS version/7f959d5873694e57a398384b051c3d43"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460484}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "Windows Server 2008 R2 / Windows 7"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460484}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows Server 2012 / Windows 8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 3, "description": "Windows Server 2012 R2 / Windows 8.1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460589}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "Windows Server 2008 R2 / Windows 7"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460589}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows Server 2012 / Windows 8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 3, "description": "Windows Server 2012 R2 / Windows 8.1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442460484}, {"type": "absolute", "value": 6442460589}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check OS version/72626041d71d4fb681dd5502bfac5cdc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check OS version/66b795160c8d4653b87088797e617be1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference HTTP User-Agent string": {"meta": {"name": "reference HTTP User-Agent string", "namespace": "communication/http", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": ["https://www.useragents.me/", "https://www.whatismybrowser.com/guides/the-latest-user-agent/"], "examples": ["0796F1C1EA0A142FC1EB7109A44C86CB:0x4043F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: reference HTTP User-Agent string\n    namespace: communication/http\n    authors:\n      - \"@mr-tz\"\n    scope: function\n    references:\n      - https://www.useragents.me/\n      - https://www.whatismybrowser.com/guides/the-latest-user-agent/\n    examples:\n      - 0796F1C1EA0A142FC1EB7109A44C86CB:0x4043F0\n  features:\n    - or:\n      - substring: \"Mozilla/5.0\"\n      - substring: \"like Gecko\"\n      - api: urlmon.ObtainUserAgentString\n      - property/read: System.Net.HttpWebRequest::UserAgent\n", "matches": [[{"type": "absolute", "value": 6442460712}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "urlmon.ObtainUserAgentString"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460826}, {"type": "absolute", "value": 6442460748}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Net.HttpWebRequest::UserAgent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "substring", "substring": "Mozilla/5.0"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "substring", "substring": "like Gecko"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk information": {"meta": {"name": "get disk information", "namespace": "host-interaction/hardware/storage", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "972B219F18379907A045431303F4DA7D:0x41064E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n", "matches": [[{"type": "absolute", "value": 6442460904}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442460945}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 6442461020}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442461059}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442461020}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442461099}, {"type": "absolute", "value": 6442461150}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "resolve function by parsing PE exports": {"meta": {"name": "resolve function by parsing PE exports", "namespace": "load-code/pe", "authors": ["sara-rn"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["73CE04892E5F39EC82B00C02FC04C70F:0x406BA1"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n", "matches": [[{"type": "absolute", "value": 6442464500}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464500}], "captures": {}}, {"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "movzx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464672}, {"type": "absolute", "value": 6442464574}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "strcmp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 60, "description": "IMAGE_DOS_HEADER.PE.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464542}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "offset", "offset": 120, "description": "offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 136, "description": "offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464546}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"count": 3, "type": "some"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 20, "description": "IMAGE_EXPORT_DIRECTORY.NumberOfFunctions"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 36, "description": "IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464585}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 32, "description": "IMAGE_EXPORT_DIRECTORY.AddressOfNames"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464582}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 24, "description": "IMAGE_EXPORT_DIRECTORY.NumberOfNames"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464635}, {"type": "absolute", "value": 6442464597}, {"type": "absolute", "value": 6442464510}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 28, "description": "IMAGE_EXPORT_DIRECTORY.AddressOfFunctions"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442464682}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "parse PE header": {"meta": {"name": "parse PE header", "namespace": "load-code/pe", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n", "matches": [[{"type": "absolute", "value": 6442465144}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442465180}, {"type": "absolute", "value": 6442465189}, {"type": "absolute", "value": 6442465175}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442465189}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 80}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 69}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442465170}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 77}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 90}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442465185}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "parse PE header/803920268bb14072ba720d1d8b0e6e49"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "encrypt data using RC4 PRGA": {"meta": {"name": "encrypt data using RC4 PRGA", "namespace": "data-manipulation/encryption/rc4", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [{"parts": ["Cryptography", "Encrypt Data", "RC4"], "objective": "Cryptography", "behavior": "Encrypt Data", "method": "RC4", "id": "C0027.009"}, {"parts": ["Cryptography", "Generate Pseudo-random Sequence", "RC4 PRGA"], "objective": "Cryptography", "behavior": "Generate Pseudo-random Sequence", "method": "RC4 PRGA", "id": "C0021.004"}], "references": [], "examples": ["34404A3FB9804977C6AB86CB991FB130:0x403DB0", "34404A3FB9804977C6AB86CB991FB130:0x403E50", "9324D1A8AE37A36AE560C37448C9705A:0x4049F0", "73CE04892E5F39EC82B00C02FC04C70F:0x4064C6"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n", "matches": [[{"type": "absolute", "value": 6442472508}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472508}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472631}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442472508}], "captures": {}}, {"success": true, "node": {"statement": {"min": 1, "max": 1, "child": {"type": "characteristic", "characteristic": "nzxor"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 6442472898}], "captures": {}}, {"success": true, "node": {"statement": {"min": 0, "max": 4, "child": {"type": "characteristic", "characteristic": "calls from"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 6442467236}, {"type": "absolute", "value": 6442457016}, {"type": "absolute", "value": 6442468092}, {"type": "absolute", "value": 6442468056}], "captures": {}}, {"success": true, "node": {"statement": {"min": 4, "max": 50, "child": {"type": "basic block"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 6442472707}, {"type": "absolute", "value": 6442472740}, {"type": "absolute", "value": 6442472645}, {"type": "absolute", "value": 6442472804}, {"type": "absolute", "value": 6442472650}, {"type": "absolute", "value": 6442472842}, {"type": "absolute", "value": 6442472875}, {"type": "absolute", "value": 6442472717}, {"type": "absolute", "value": 6442472784}, {"type": "absolute", "value": 6442472756}, {"type": "absolute", "value": 6442472885}, {"type": "absolute", "value": 6442472918}, {"type": "absolute", "value": 6442472631}, {"type": "absolute", "value": 6442472760}, {"type": "absolute", "value": 6442472794}, {"type": "absolute", "value": 6442472508}, {"type": "absolute", "value": 6442472829}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "calculate modulo 256 via x86 assembly"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "and"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483903}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442472820}], "captures": {}}, {"success": true, "node": {"statement": {"min": 4, "max": 9223372036854775808, "child": {"type": "mnemonic", "mnemonic": "movzx"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 6442472672}, {"type": "absolute", "value": 6442472864}, {"type": "absolute", "value": 6442472804}, {"type": "absolute", "value": 6442472808}, {"type": "absolute", "value": 6442472650}, {"type": "absolute", "value": 6442472842}, {"type": "absolute", "value": 6442472812}, {"type": "absolute", "value": 6442472846}, {"type": "absolute", "value": 6442472720}, {"type": "absolute", "value": 6442472784}, {"type": "absolute", "value": 6442472659}, {"type": "absolute", "value": 6442472693}, {"type": "absolute", "value": 6442472631}, {"type": "absolute", "value": 6442472663}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 255}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442472556}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 256}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send HTTP request": {"meta": {"name": "send HTTP request", "namespace": "communication/http/client", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Send Request"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Send Request", "id": "C0002.003"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60", "6A352C3E55E8AE5ED39DC1BE7FB964B1:0x100026E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send HTTP request\n    namespace: communication/http/client\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Send Request [C0002.003]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x100026E0\n  features:\n    - or:\n      - api: System.Net.WebRequest::GetResponse\n      - api: System.Net.WebRequest::GetResponseAsync\n      - and:\n        - or:\n          - api: wininet.HttpOpenRequest\n          - api: wininet.InternetConnect\n        - or:\n          - api: wininet.HttpSendRequest\n          - api: wininet.HttpSendRequestEx\n      - and:\n        - api: winhttp.WinHttpSendRequest\n        - api: winhttp.WinHttpWriteData\n        - optional:\n          - or:\n            - api: winhttp.WinHttpOpenRequest\n            - api: winhttp.WinHttpConnect\n      - and:\n        - match: send data on socket\n        - string: /HTTP/i\n", "matches": [[{"type": "absolute", "value": 6442482224}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482642}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482538}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483486}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483581}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create HTTP request": {"meta": {"name": "create HTTP request", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Create Request"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Create Request", "id": "C0002.012"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n", "matches": [[{"type": "absolute", "value": 6442482224}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483096}, {"type": "absolute", "value": 6442483105}, {"type": "absolute", "value": 6442483114}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482493}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483920}, {"type": "absolute", "value": 6442483931}, {"type": "absolute", "value": 6442483909}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483334}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect to HTTP server": {"meta": {"name": "connect to HTTP server", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Connect to Server"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Connect to Server", "id": "C0002.009"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: connect to HTTP server\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Connect to Server [C0002.009]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetConnect\n", "matches": [[{"type": "absolute", "value": 6442482224}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482538}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483096}, {"type": "absolute", "value": 6442483105}, {"type": "absolute", "value": 6442483114}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482493}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442482224}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483920}, {"type": "absolute", "value": 6442483931}, {"type": "absolute", "value": 6442483909}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483334}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send data": {"meta": {"name": "send data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Send Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Send Data", "id": "B0030.001"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for sending data to a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n", "matches": [[{"type": "absolute", "value": 6442482224}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482642}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482538}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442482224}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482642}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482538}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442482735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442482224}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483486}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483581}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483486}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483581}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read data from Internet": {"meta": {"name": "read data from Internet", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Get Response"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Get Response", "id": "C0002.017"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40D590"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read data from Internet\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Get Response [C0002.017]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40D590\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: connect to HTTP server\n          - match: connect to URL\n      - or:\n        - api: wininet.InternetReadFile\n        - api: wininet.InternetReadFileEx\n        - api: System.Net.WebClient::DownloadString\n        - api: System.Net.WebClient::DownloadStringAsync\n        - api: System.Net.WebClient::DownloadStringTaskAsync\n        - api: System.Net.WebClient::DownloadData\n        - api: System.Net.WebClient::DownloadDataAsync\n        - api: System.Net.WebClient::DownloadDataTaskAsync\n", "matches": [[{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483920}, {"type": "absolute", "value": 6442483931}, {"type": "absolute", "value": 6442483909}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483334}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data": {"meta": {"name": "receive data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Receive Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Receive Data", "id": "B0030.002"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for receiving data from a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n", "matches": [[{"type": "absolute", "value": 6442483172}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483381}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483920}, {"type": "absolute", "value": 6442483931}, {"type": "absolute", "value": 6442483909}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483334}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442483825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442483172}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 6442483992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484103}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442484840}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442484946}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create mutex": {"meta": {"name": "create mutex", "namespace": "host-interaction/mutex", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Create Mutex"], "objective": "Process", "behavior": "Create Mutex", "method": "", "id": "C0042"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n", "matches": [[{"type": "absolute", "value": 6442488256}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488317}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442489220}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489630}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check mutex and exit": {"meta": {"name": "check mutex and exit", "namespace": "host-interaction/mutex", "authors": ["@_re_fox", "moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Check Mutex"], "objective": "Process", "behavior": "Check Mutex", "method": "", "id": "C0043"}, {"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["1d8fd13c890060464019c0f07b928b1a:0x402eb0", "Practical Malware Analysis Lab 11-03.dll_:0x10001410"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check mutex and exit\n    namespace: host-interaction/mutex\n    authors:\n      - \"@_re_fox\"\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Process::Check Mutex [C0043]\n      - Process::Terminate Process [C0018]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402eb0\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001410\n  features:\n    - and:\n      - match: create mutex\n      - or:\n        - api: ExitProcess\n        - api: exit\n        - api: _Exit\n        - api: _exit\n        - or:\n          - api: WaitForSingleObject\n          - and:\n            - api: GetLastError\n            - or:\n              - number: 2 = ERROR_FILE_NOT_FOUND\n              - number: 0xB7 = ERROR_ALREADY_EXISTS\n              - number: 5 = ERROR_ACCESS_DENIED\n", "matches": [[{"type": "absolute", "value": 6442488256}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create mutex"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488317}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442488256}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488442}, {"type": "absolute", "value": 6442488380}, {"type": "absolute", "value": 6442488333}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "ERROR_FILE_NOT_FOUND"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 183, "description": "ERROR_ALREADY_EXISTS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442488386}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 5, "description": "ERROR_ACCESS_DENIED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442489220}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create mutex"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489630}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442489220}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetLastError"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489328}, {"type": "absolute", "value": 6442489411}, {"type": "absolute", "value": 6442489636}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "ERROR_FILE_NOT_FOUND"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489550}, {"type": "absolute", "value": 6442489358}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 183, "description": "ERROR_ALREADY_EXISTS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489642}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 5, "description": "ERROR_ACCESS_DENIED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442651648}], "captures": {}}]]}, "implement COM DLL": {"meta": {"name": "implement COM DLL", "namespace": "executable/pe", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": ["https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject"], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: implement COM DLL\n    namespace: executable/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject\n  features:\n    - and:\n      - export: DllGetClassObject\n      - optional:\n        - export: DllRegisterServer\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "export", "export": "DllGetClassObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442489220}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "export", "export": "DllRegisterServer"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 6442457012}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}}}
