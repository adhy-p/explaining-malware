{"meta": {"timestamp": "2023-04-04T18:04:04.205806", "version": "5.0.0", "argv": ["-j", "../inputs//4a3f19b7aefbd8c83d865c2d1e962cddc863ac6520eddb58417a14191231ea2e"], "sample": {"md5": "a00d3299764090ac0bec25b7fedc6751", "sha1": "c196a0cb2e1d399548ddc0fa870856619702dda3", "sha256": "0e1a4fb86678114ca38855a67ce03246e586eecff8618bc761baf70b68b28a8c", "path": "../inputs/4a3f19b7aefbd8c83d865c2d1e962cddc863ac6520eddb58417a14191231ea2e"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/Desktop/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4198400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198471}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198489}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198499}}]}, {"address": {"type": "absolute", "value": 4198508}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198508}}, {"address": {"type": "absolute", "value": 4198963}}, {"address": {"type": "absolute", "value": 4198988}}, {"address": {"type": "absolute", "value": 4199371}}, {"address": {"type": "absolute", "value": 4199471}}]}, {"address": {"type": "absolute", "value": 4199506}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199506}}]}, {"address": {"type": "absolute", "value": 4199539}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199539}}]}, {"address": {"type": "absolute", "value": 4199570}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199570}}, {"address": {"type": "absolute", "value": 4199697}}]}, {"address": {"type": "absolute", "value": 4199913}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199913}}]}, {"address": {"type": "absolute", "value": 4199954}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199954}}]}, {"address": {"type": "absolute", "value": 4200162}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200162}}, {"address": {"type": "absolute", "value": 4200268}}, {"address": {"type": "absolute", "value": 4200439}}, {"address": {"type": "absolute", "value": 4200607}}, {"address": {"type": "absolute", "value": 4200681}}]}, {"address": {"type": "absolute", "value": 4200703}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200703}}]}, {"address": {"type": "absolute", "value": 4200765}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200765}}, {"address": {"type": "absolute", "value": 4200929}}, {"address": {"type": "absolute", "value": 4200940}}]}, {"address": {"type": "absolute", "value": 4200992}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201198}}, {"address": {"type": "absolute", "value": 4201377}}, {"address": {"type": "absolute", "value": 4201408}}]}, {"address": {"type": "absolute", "value": 4201449}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201449}}]}, {"address": {"type": "absolute", "value": 4201524}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201524}}]}, {"address": {"type": "absolute", "value": 4201599}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201599}}, {"address": {"type": "absolute", "value": 4201955}}, {"address": {"type": "absolute", "value": 4202000}}]}, {"address": {"type": "absolute", "value": 4202054}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202054}}]}, {"address": {"type": "absolute", "value": 4202138}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202187}}]}, {"address": {"type": "absolute", "value": 4202215}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202215}}, {"address": {"type": "absolute", "value": 4202276}}, {"address": {"type": "absolute", "value": 4202320}}, {"address": {"type": "absolute", "value": 4202337}}]}, {"address": {"type": "absolute", "value": 4202375}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202375}}, {"address": {"type": "absolute", "value": 4202482}}]}, {"address": {"type": "absolute", "value": 4202512}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202532}}]}, {"address": {"type": "absolute", "value": 4202598}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202598}}, {"address": {"type": "absolute", "value": 4202636}}, {"address": {"type": "absolute", "value": 4202710}}, {"address": {"type": "absolute", "value": 4202740}}]}, {"address": {"type": "absolute", "value": 4202873}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202873}}, {"address": {"type": "absolute", "value": 4202905}}, {"address": {"type": "absolute", "value": 4202973}}, {"address": {"type": "absolute", "value": 4203021}}, {"address": {"type": "absolute", "value": 4203042}}, {"address": {"type": "absolute", "value": 4203086}}, {"address": {"type": "absolute", "value": 4203122}}]}, {"address": {"type": "absolute", "value": 4203253}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203253}}, {"address": {"type": "absolute", "value": 4203289}}, {"address": {"type": "absolute", "value": 4203328}}]}, {"address": {"type": "absolute", "value": 4203468}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203468}}, {"address": {"type": "absolute", "value": 4203504}}, {"address": {"type": "absolute", "value": 4203553}}, {"address": {"type": "absolute", "value": 4203566}}, {"address": {"type": "absolute", "value": 4203618}}, {"address": {"type": "absolute", "value": 4203654}}]}, {"address": {"type": "absolute", "value": 4203794}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203981}}, {"address": {"type": "absolute", "value": 4204062}}, {"address": {"type": "absolute", "value": 4204137}}]}, {"address": {"type": "absolute", "value": 4204147}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204147}}, {"address": {"type": "absolute", "value": 4204217}}, {"address": {"type": "absolute", "value": 4204280}}, {"address": {"type": "absolute", "value": 4204341}}]}, {"address": {"type": "absolute", "value": 4204404}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204476}}, {"address": {"type": "absolute", "value": 4204530}}]}, {"address": {"type": "absolute", "value": 4204582}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204609}}]}, {"address": {"type": "absolute", "value": 4204623}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204738}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204769}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204769}}, {"address": {"type": "absolute", "value": 4205006}}]}, {"address": {"type": "absolute", "value": 4205056}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205056}}, {"address": {"type": "absolute", "value": 4205400}}]}, {"address": {"type": "absolute", "value": 4205629}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205629}}, {"address": {"type": "absolute", "value": 4205673}}]}, {"address": {"type": "absolute", "value": 4205686}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205865}}, {"address": {"type": "absolute", "value": 4205905}}, {"address": {"type": "absolute", "value": 4205939}}]}, {"address": {"type": "absolute", "value": 4206005}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206057}}]}, {"address": {"type": "absolute", "value": 4206102}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206128}}, {"address": {"type": "absolute", "value": 4206183}}, {"address": {"type": "absolute", "value": 4206187}}]}, {"address": {"type": "absolute", "value": 4206210}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206210}}, {"address": {"type": "absolute", "value": 4206325}}, {"address": {"type": "absolute", "value": 4206405}}]}, {"address": {"type": "absolute", "value": 4206510}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206510}}, {"address": {"type": "absolute", "value": 4206611}}]}, {"address": {"type": "absolute", "value": 4206964}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207104}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207200}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207221}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4207221}}, {"address": {"type": "absolute", "value": 4207261}}, {"address": {"type": "absolute", "value": 4207312}}, {"address": {"type": "absolute", "value": 4207336}}]}, {"address": {"type": "absolute", "value": 4207538}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4207570}}, {"address": {"type": "absolute", "value": 4207640}}, {"address": {"type": "absolute", "value": 4207693}}, {"address": {"type": "absolute", "value": 4207707}}]}, {"address": {"type": "absolute", "value": 4207726}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4207830}}, {"address": {"type": "absolute", "value": 4207893}}, {"address": {"type": "absolute", "value": 4208074}}, {"address": {"type": "absolute", "value": 4208177}}, {"address": {"type": "absolute", "value": 4208255}}]}, {"address": {"type": "absolute", "value": 4208494}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208494}}]}, {"address": {"type": "absolute", "value": 4208548}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208548}}]}, {"address": {"type": "absolute", "value": 4208579}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208579}}]}, {"address": {"type": "absolute", "value": 4208634}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208634}}]}, {"address": {"type": "absolute", "value": 4208665}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208665}}]}, {"address": {"type": "absolute", "value": 4208695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208695}}, {"address": {"type": "absolute", "value": 4208749}}]}, {"address": {"type": "absolute", "value": 4208882}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208882}}]}, {"address": {"type": "absolute", "value": 4208937}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208937}}, {"address": {"type": "absolute", "value": 4209047}}]}, {"address": {"type": "absolute", "value": 4209080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209080}}]}, {"address": {"type": "absolute", "value": 4209112}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209112}}]}, {"address": {"type": "absolute", "value": 4209171}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209171}}, {"address": {"type": "absolute", "value": 4209251}}, {"address": {"type": "absolute", "value": 4209327}}, {"address": {"type": "absolute", "value": 4209374}}, {"address": {"type": "absolute", "value": 4209435}}, {"address": {"type": "absolute", "value": 4209493}}]}, {"address": {"type": "absolute", "value": 4209574}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209620}}]}, {"address": {"type": "absolute", "value": 4209650}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209650}}]}, {"address": {"type": "absolute", "value": 4209758}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209835}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209853}}, {"address": {"type": "absolute", "value": 4209946}}, {"address": {"type": "absolute", "value": 4209978}}]}, {"address": {"type": "absolute", "value": 4210010}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210047}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4210047}}, {"address": {"type": "absolute", "value": 4210072}}, {"address": {"type": "absolute", "value": 4210219}}, {"address": {"type": "absolute", "value": 4210267}}, {"address": {"type": "absolute", "value": 4210318}}, {"address": {"type": "absolute", "value": 4210437}}, {"address": {"type": "absolute", "value": 4210460}}, {"address": {"type": "absolute", "value": 4210515}}, {"address": {"type": "absolute", "value": 4210542}}]}, {"address": {"type": "absolute", "value": 4210626}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4210626}}]}, {"address": {"type": "absolute", "value": 4210750}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4210750}}, {"address": {"type": "absolute", "value": 4210775}}, {"address": {"type": "absolute", "value": 4210905}}, {"address": {"type": "absolute", "value": 4210953}}, {"address": {"type": "absolute", "value": 4211049}}, {"address": {"type": "absolute", "value": 4211127}}, {"address": {"type": "absolute", "value": 4211171}}, {"address": {"type": "absolute", "value": 4211196}}]}, {"address": {"type": "absolute", "value": 4211282}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211282}}]}, {"address": {"type": "absolute", "value": 4211354}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211386}}, {"address": {"type": "absolute", "value": 4211413}}, {"address": {"type": "absolute", "value": 4211501}}, {"address": {"type": "absolute", "value": 4211557}}, {"address": {"type": "absolute", "value": 4211601}}, {"address": {"type": "absolute", "value": 4211708}}]}, {"address": {"type": "absolute", "value": 4211742}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211761}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211761}}]}, {"address": {"type": "absolute", "value": 4211830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211830}}]}, {"address": {"type": "absolute", "value": 4211928}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211928}}, {"address": {"type": "absolute", "value": 4211953}}]}, {"address": {"type": "absolute", "value": 4212022}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212022}}]}, {"address": {"type": "absolute", "value": 4212066}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212136}}, {"address": {"type": "absolute", "value": 4212147}}, {"address": {"type": "absolute", "value": 4212239}}]}, {"address": {"type": "absolute", "value": 4212309}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212309}}, {"address": {"type": "absolute", "value": 4212335}}, {"address": {"type": "absolute", "value": 4212377}}, {"address": {"type": "absolute", "value": 4212408}}, {"address": {"type": "absolute", "value": 4212472}}, {"address": {"type": "absolute", "value": 4212501}}, {"address": {"type": "absolute", "value": 4212538}}, {"address": {"type": "absolute", "value": 4212596}}]}, {"address": {"type": "absolute", "value": 4212690}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212690}}, {"address": {"type": "absolute", "value": 4212761}}, {"address": {"type": "absolute", "value": 4212799}}]}, {"address": {"type": "absolute", "value": 4212873}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212997}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4213324}}, {"address": {"type": "absolute", "value": 4213389}}, {"address": {"type": "absolute", "value": 4213410}}, {"address": {"type": "absolute", "value": 4213445}}, {"address": {"type": "absolute", "value": 4213496}}, {"address": {"type": "absolute", "value": 4213516}}, {"address": {"type": "absolute", "value": 4213578}}]}, {"address": {"type": "absolute", "value": 4213632}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4213645}}]}, {"address": {"type": "absolute", "value": 4213672}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4213672}}, {"address": {"type": "absolute", "value": 4213707}}, {"address": {"type": "absolute", "value": 4213864}}, {"address": {"type": "absolute", "value": 4214089}}, {"address": {"type": "absolute", "value": 4214147}}, {"address": {"type": "absolute", "value": 4214170}}, {"address": {"type": "absolute", "value": 4214225}}]}, {"address": {"type": "absolute", "value": 4214238}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4214306}}, {"address": {"type": "absolute", "value": 4214324}}, {"address": {"type": "absolute", "value": 4214342}}, {"address": {"type": "absolute", "value": 4214452}}, {"address": {"type": "absolute", "value": 4214478}}, {"address": {"type": "absolute", "value": 4214606}}, {"address": {"type": "absolute", "value": 4214629}}, {"address": {"type": "absolute", "value": 4214662}}, {"address": {"type": "absolute", "value": 4214695}}]}, {"address": {"type": "absolute", "value": 4214737}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4214956}}, {"address": {"type": "absolute", "value": 4215007}}]}, {"address": {"type": "absolute", "value": 4215043}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215066}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4215125}}, {"address": {"type": "absolute", "value": 4215221}}]}, {"address": {"type": "absolute", "value": 4215276}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4215276}}, {"address": {"type": "absolute", "value": 4215310}}]}, {"address": {"type": "absolute", "value": 4215332}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4215332}}, {"address": {"type": "absolute", "value": 4215578}}, {"address": {"type": "absolute", "value": 4215749}}, {"address": {"type": "absolute", "value": 4215819}}, {"address": {"type": "absolute", "value": 4215936}}]}, {"address": {"type": "absolute", "value": 4216092}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216092}}]}, {"address": {"type": "absolute", "value": 4216212}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216212}}]}, {"address": {"type": "absolute", "value": 4216250}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216277}}, {"address": {"type": "absolute", "value": 4216339}}]}, {"address": {"type": "absolute", "value": 4216381}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216381}}]}, {"address": {"type": "absolute", "value": 4216437}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216437}}]}, {"address": {"type": "absolute", "value": 4216515}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216515}}]}, {"address": {"type": "absolute", "value": 4216571}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216571}}]}, {"address": {"type": "absolute", "value": 4216627}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216627}}]}, {"address": {"type": "absolute", "value": 4216741}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216741}}]}, {"address": {"type": "absolute", "value": 4216881}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216881}}]}, {"address": {"type": "absolute", "value": 4216949}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4216949}}]}, {"address": {"type": "absolute", "value": 4217017}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4217017}}]}, {"address": {"type": "absolute", "value": 4217096}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4217096}}, {"address": {"type": "absolute", "value": 4217134}}]}, {"address": {"type": "absolute", "value": 4217188}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217194}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217200}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217206}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217212}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217232}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217238}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217244}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217250}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217256}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217262}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217280}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217328}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217334}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217684}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217690}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217696}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217714}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217717}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217724}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217744}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217750}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217756}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 909, "functions": [{"address": {"type": "absolute", "value": 4198400}, "count": 30}, {"address": {"type": "absolute", "value": 4198471}, "count": 17}, {"address": {"type": "absolute", "value": 4198489}, "count": 21}, {"address": {"type": "absolute", "value": 4198508}, "count": 97}, {"address": {"type": "absolute", "value": 4199506}, "count": 35}, {"address": {"type": "absolute", "value": 4199539}, "count": 24}, {"address": {"type": "absolute", "value": 4199570}, "count": 86}, {"address": {"type": "absolute", "value": 4199913}, "count": 23}, {"address": {"type": "absolute", "value": 4199954}, "count": 65}, {"address": {"type": "absolute", "value": 4200162}, "count": 101}, {"address": {"type": "absolute", "value": 4200703}, "count": 34}, {"address": {"type": "absolute", "value": 4200765}, "count": 66}, {"address": {"type": "absolute", "value": 4200992}, "count": 80}, {"address": {"type": "absolute", "value": 4201449}, "count": 27}, {"address": {"type": "absolute", "value": 4201524}, "count": 27}, {"address": {"type": "absolute", "value": 4201599}, "count": 83}, {"address": {"type": "absolute", "value": 4202054}, "count": 27}, {"address": {"type": "absolute", "value": 4202138}, "count": 38}, {"address": {"type": "absolute", "value": 4202215}, "count": 74}, {"address": {"type": "absolute", "value": 4202375}, "count": 38}, {"address": {"type": "absolute", "value": 4202512}, "count": 30}, {"address": {"type": "absolute", "value": 4202598}, "count": 65}, {"address": {"type": "absolute", "value": 4202873}, "count": 78}, {"address": {"type": "absolute", "value": 4203253}, "count": 60}, {"address": {"type": "absolute", "value": 4203468}, "count": 77}, {"address": {"type": "absolute", "value": 4203794}, "count": 60}, {"address": {"type": "absolute", "value": 4204147}, "count": 52}, {"address": {"type": "absolute", "value": 4204404}, "count": 72}, {"address": {"type": "absolute", "value": 4204582}, "count": 35}, {"address": {"type": "absolute", "value": 4204623}, "count": 45}, {"address": {"type": "absolute", "value": 4204738}, "count": 24}, {"address": {"type": "absolute", "value": 4204769}, "count": 64}, {"address": {"type": "absolute", "value": 4205056}, "count": 61}, {"address": {"type": "absolute", "value": 4205629}, "count": 29}, {"address": {"type": "absolute", "value": 4205686}, "count": 54}, {"address": {"type": "absolute", "value": 4206005}, "count": 47}, {"address": {"type": "absolute", "value": 4206102}, "count": 49}, {"address": {"type": "absolute", "value": 4206210}, "count": 76}, {"address": {"type": "absolute", "value": 4206510}, "count": 82}, {"address": {"type": "absolute", "value": 4206964}, "count": 38}, {"address": {"type": "absolute", "value": 4207104}, "count": 38}, {"address": {"type": "absolute", "value": 4207200}, "count": 16}, {"address": {"type": "absolute", "value": 4207221}, "count": 53}, {"address": {"type": "absolute", "value": 4207538}, "count": 49}, {"address": {"type": "absolute", "value": 4207726}, "count": 115}, {"address": {"type": "absolute", "value": 4208494}, "count": 28}, {"address": {"type": "absolute", "value": 4208548}, "count": 31}, {"address": {"type": "absolute", "value": 4208579}, "count": 32}, {"address": {"type": "absolute", "value": 4208634}, "count": 31}, {"address": {"type": "absolute", "value": 4208665}, "count": 29}, {"address": {"type": "absolute", "value": 4208695}, "count": 54}, {"address": {"type": "absolute", "value": 4208882}, "count": 29}, {"address": {"type": "absolute", "value": 4208937}, "count": 62}, {"address": {"type": "absolute", "value": 4209080}, "count": 35}, {"address": {"type": "absolute", "value": 4209112}, "count": 39}, {"address": {"type": "absolute", "value": 4209171}, "count": 84}, {"address": {"type": "absolute", "value": 4209574}, "count": 46}, {"address": {"type": "absolute", "value": 4209650}, "count": 45}, {"address": {"type": "absolute", "value": 4209758}, "count": 41}, {"address": {"type": "absolute", "value": 4209835}, "count": 72}, {"address": {"type": "absolute", "value": 4210010}, "count": 17}, {"address": {"type": "absolute", "value": 4210047}, "count": 100}, {"address": {"type": "absolute", "value": 4210626}, "count": 48}, {"address": {"type": "absolute", "value": 4210750}, "count": 84}, {"address": {"type": "absolute", "value": 4211282}, "count": 29}, {"address": {"type": "absolute", "value": 4211354}, "count": 89}, {"address": {"type": "absolute", "value": 4211742}, "count": 18}, {"address": {"type": "absolute", "value": 4211761}, "count": 33}, {"address": {"type": "absolute", "value": 4211830}, "count": 39}, {"address": {"type": "absolute", "value": 4211928}, "count": 47}, {"address": {"type": "absolute", "value": 4212022}, "count": 22}, {"address": {"type": "absolute", "value": 4212066}, "count": 97}, {"address": {"type": "absolute", "value": 4212309}, "count": 84}, {"address": {"type": "absolute", "value": 4212690}, "count": 71}, {"address": {"type": "absolute", "value": 4212873}, "count": 41}, {"address": {"type": "absolute", "value": 4212997}, "count": 117}, {"address": {"type": "absolute", "value": 4213632}, "count": 28}, {"address": {"type": "absolute", "value": 4213672}, "count": 117}, {"address": {"type": "absolute", "value": 4214238}, "count": 121}, {"address": {"type": "absolute", "value": 4214737}, "count": 75}, {"address": {"type": "absolute", "value": 4215043}, "count": 16}, {"address": {"type": "absolute", "value": 4215066}, "count": 69}, {"address": {"type": "absolute", "value": 4215276}, "count": 31}, {"address": {"type": "absolute", "value": 4215332}, "count": 113}, {"address": {"type": "absolute", "value": 4216092}, "count": 50}, {"address": {"type": "absolute", "value": 4216212}, "count": 28}, {"address": {"type": "absolute", "value": 4216250}, "count": 46}, {"address": {"type": "absolute", "value": 4216381}, "count": 33}, {"address": {"type": "absolute", "value": 4216437}, "count": 39}, {"address": {"type": "absolute", "value": 4216515}, "count": 33}, {"address": {"type": "absolute", "value": 4216571}, "count": 33}, {"address": {"type": "absolute", "value": 4216627}, "count": 41}, {"address": {"type": "absolute", "value": 4216741}, "count": 46}, {"address": {"type": "absolute", "value": 4216881}, "count": 31}, {"address": {"type": "absolute", "value": 4216949}, "count": 31}, {"address": {"type": "absolute", "value": 4217017}, "count": 31}, {"address": {"type": "absolute", "value": 4217096}, "count": 32}, {"address": {"type": "absolute", "value": 4217188}, "count": 7}, {"address": {"type": "absolute", "value": 4217194}, "count": 7}, {"address": {"type": "absolute", "value": 4217200}, "count": 7}, {"address": {"type": "absolute", "value": 4217206}, "count": 7}, {"address": {"type": "absolute", "value": 4217212}, "count": 7}, {"address": {"type": "absolute", "value": 4217232}, "count": 7}, {"address": {"type": "absolute", "value": 4217238}, "count": 7}, {"address": {"type": "absolute", "value": 4217244}, "count": 7}, {"address": {"type": "absolute", "value": 4217250}, "count": 7}, {"address": {"type": "absolute", "value": 4217256}, "count": 7}, {"address": {"type": "absolute", "value": 4217262}, "count": 7}, {"address": {"type": "absolute", "value": 4217328}, "count": 7}, {"address": {"type": "absolute", "value": 4217684}, "count": 7}, {"address": {"type": "absolute", "value": 4217690}, "count": 7}, {"address": {"type": "absolute", "value": 4217714}, "count": 6}, {"address": {"type": "absolute", "value": 4217717}, "count": 6}, {"address": {"type": "absolute", "value": 4217724}, "count": 7}, {"address": {"type": "absolute", "value": 4217744}, "count": 7}, {"address": {"type": "absolute", "value": 4217750}, "count": 7}, {"address": {"type": "absolute", "value": 4217756}, "count": 7}]}, "library_functions": [{"address": {"type": "absolute", "value": 4217280}, "name": "__alloca_probe"}, {"address": {"type": "absolute", "value": 4217334}, "name": "_WinMainCRTStartup"}, {"address": {"type": "absolute", "value": 4217696}, "name": "__setdefaultprecision"}]}}, "rules": {"create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 4199471}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199490}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205006}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205019}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215310}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215324}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file attributes": {"meta": {"name": "get file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Get File Attributes"], "objective": "File System", "behavior": "Get File Attributes", "method": "", "id": "C0049"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x180019824", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 4199506}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199521}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208937}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210626}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210706}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212799}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212850}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "set file attributes": {"meta": {"name": "set file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "File and Directory Permissions Modification"], "tactic": "Defense Evasion", "technique": "File and Directory Permissions Modification", "subtechnique": "", "id": "T1222"}], "mbc": [{"parts": ["File System", "Set File Attributes"], "objective": "File System", "behavior": "Set File Attributes", "method": "", "id": "C0050"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x100015f0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 4199506}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199531}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200268}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200401}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200607}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200620}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208749}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208817}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209047}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209054}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210542}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210551}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210626}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210722}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211708}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211722}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212472}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212474}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212799}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212862}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::SetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 4199570}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199621}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199954}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200765}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200803}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216627}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216656}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216741}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216766}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216881}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216901}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216949}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216969}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4217017}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4217037}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4217096}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4217120}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4217134}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4217151}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check mutex": {"meta": {"name": "check mutex", "namespace": "host-interaction/mutex", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Check Mutex"], "objective": "Process", "behavior": "Check Mutex", "method": "", "id": "C0043"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Check Mutex [C0043]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - or:\n        - api: kernel32.OpenMutex\n        - match: create mutex\n        - api: System.Threading.Mutex::OpenExisting\n        - api: System.Threading.Mutex::TryOpenExisting\n      - optional:\n        - or:\n          - api: kernel32.GetLastError\n          - number: 2 = ERROR_FILE_NOT_FOUND\n          - number: 0xB7 = ERROR_ALREADY_EXISTS\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200187}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create mutex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::OpenExisting"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::TryOpenExisting"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLastError"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "ERROR_FILE_NOT_FOUND"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 183, "description": "ERROR_ALREADY_EXISTS"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 4200268}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200302}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200291}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202320}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202322}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203981}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203997}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204062}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204063}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204137}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204138}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204476}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204478}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204530}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204532}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205629}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205637}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205673}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205678}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205905}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205907}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205939}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205941}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206057}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206059}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206187}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206189}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210267}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210278}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210437}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210448}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210515}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210526}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211761}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211787}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215276}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215294}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215540}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215749}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215749}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 4202740}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202796}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203122}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203178}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203328}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203384}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203654}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203710}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209112}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209132}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211413}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211434}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211557}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211565}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211928}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211939}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212147}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212168}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212501}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212502}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212538}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212549}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212690}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212751}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212761}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212779}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "encode data using XOR": {"meta": {"name": "encode data using XOR", "namespace": "data-manipulation/encoding/xor", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Encoding-Standard Algorithm"], "objective": "Defense Evasion", "behavior": "Obfuscated Files or Information", "method": "Encoding-Standard Algorithm", "id": "E1027.m02"}, {"parts": ["Data", "Encode Data", "XOR"], "objective": "Data", "behavior": "Encode Data", "method": "XOR", "id": "C0026.002"}], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403D7E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n", "matches": [[{"type": "absolute", "value": 4204609}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204609}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204612}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214306}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214306}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214306}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214324}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214324}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214324}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214342}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214342}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214342}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open process": {"meta": {"name": "open process", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Process"], "objective": "Process", "behavior": "Open Process", "method": "", "id": "C0065"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n", "matches": [[{"type": "absolute", "value": 4207221}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207248}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207261}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207270}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207336}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207345}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207893}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207923}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208579}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208613}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 4215221}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215265}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4198471}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198471}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198489}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198489}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198508}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198963}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199570}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199570}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199767}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202138}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202138}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202215}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202873}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202873}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203468}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203468}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203794}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203794}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204404}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204404}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204582}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204609}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205629}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205629}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205686}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205686}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205939}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206102}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206102}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206210}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206210}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206510}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207726}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208695}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209171}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209171}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209574}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209574}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209650}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209650}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209758}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209758}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209835}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209835}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210047}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211354}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211354}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212066}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212066}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212997}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212997}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214238}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214306}, {"type": "absolute", "value": 4214324}, {"type": "absolute", "value": 4214342}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214993}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216627}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216627}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216741}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216741}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create directory": {"meta": {"name": "create directory", "namespace": "host-interaction/file-system/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Create Directory"], "objective": "File System", "behavior": "Create Directory", "method": "", "id": "C0046"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x10008f62", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create directory\n    namespace: host-interaction/file-system/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Create Directory [C0046]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x10008f62\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.CreateDirectory\n      - api: kernel32.CreateDirectoryEx\n      - api: kernel32.CreateDirectoryTransacted\n      - api: NtCreateDirectoryObject\n      - api: ZwCreateDirectoryObject\n      - api: SHCreateDirectory\n      - api: SHCreateDirectoryEx\n      - api: _mkdir\n      - api: _wmkdir\n      - api: System.IO.Directory::CreateDirectory\n      - api: System.IO.DirectoryInfo::Create\n      - api: System.IO.DirectoryInfo::CreateSubdirectory\n", "matches": [[{"type": "absolute", "value": 4199506}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199514}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200510}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209080}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209088}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210626}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210693}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211009}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateDirectoryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_mkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wmkdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::CreateDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::CreateSubdirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "initialize Winsock library": {"meta": {"name": "initialize Winsock library", "namespace": "communication/socket", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Initialize Winsock Library"], "objective": "Communication", "behavior": "Socket Communication", "method": "Initialize Winsock Library", "id": "C0001.009"}], "references": [], "examples": ["6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n", "matches": [[{"type": "absolute", "value": 4199539}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.WSAStartup"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199552}], "captures": {}}], "locations": [], "captures": {}}]]}, "set registry value": {"meta": {"name": "set registry value", "namespace": "host-interaction/registry/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Set Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Set Registry Key", "id": "C0036.001"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E", "98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n", "matches": [[{"type": "absolute", "value": 4199570}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/add/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/reg(|.exe)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hklm/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_LOCAL_MACHINE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hkcu/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_CURRENT_USER/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199621}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199570}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199888}, {"type": "absolute", "value": 4199814}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlWriteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegWriteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199954}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/add/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/reg(|.exe)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hklm/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_LOCAL_MACHINE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hkcu/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_CURRENT_USER/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199954}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200125}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlWriteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegWriteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4217017}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/add/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/reg(|.exe)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hklm/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_LOCAL_MACHINE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hkcu/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_CURRENT_USER/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4217037}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4217017}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4217069}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlWriteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegWriteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 4199570}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199621}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199570}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199648}, {"type": "absolute", "value": 4199841}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200765}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200803}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200765}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200874}, {"type": "absolute", "value": 4200842}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216741}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216766}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4216741}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216832}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 4199954}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199976}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200320}, {"type": "absolute", "value": 4200477}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202598}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202752}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202873}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203134}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203253}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203340}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203468}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203666}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203794}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203825}, {"type": "absolute", "value": 4203907}, {"type": "absolute", "value": 4203869}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206624}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207538}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207630}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210626}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210659}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211830}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211844}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212022}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212033}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212309}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212420}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212690}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212714}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete registry value": {"meta": {"name": "delete registry value", "namespace": "host-interaction/registry/delete", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Modify Registry"], "tactic": "Defense Evasion", "technique": "Modify Registry", "subtechnique": "", "id": "T1112"}], "mbc": [{"parts": ["Operating System", "Registry", "Delete Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Delete Registry Value", "id": "C0036.007"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4041A0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete registry value\n    namespace: host-interaction/registry/delete\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Value [C0036.007]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4041A0\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteValue\n        - api: advapi32.RegDeleteKeyValue\n        - api: ZwDeleteValueKey\n        - api: NtDeleteValueKey\n        - api: RtlDeleteRegistryValue\n        - api: SHDeleteValue\n        - api: SHRegDeleteUSValue\n        - api: Microsoft.Win32.RegistryKey::DeleteValue\n", "matches": [[{"type": "absolute", "value": 4199954}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199954}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200139}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlDeleteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHDeleteValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegDeleteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::DeleteValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216949}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216969}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4216949}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216990}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlDeleteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHDeleteValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegDeleteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::DeleteValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create mutex": {"meta": {"name": "create mutex", "namespace": "host-interaction/mutex", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Create Mutex"], "objective": "Process", "behavior": "Create Mutex", "method": "", "id": "C0042"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200200}, {"type": "absolute", "value": 4200432}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "copy file": {"meta": {"name": "copy file", "namespace": "host-interaction/file-system/copy", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Copy File"], "objective": "File System", "behavior": "Copy File", "method": "", "id": "C0045"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.exe_:0x401440"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CopyFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200641}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CopyFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CopyFile2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CopyFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::CopyTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Copy"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "copy file/45fe99621d2a4642875bce7df0ba92ab"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CopyFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211241}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CopyFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CopyFile2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CopyFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::CopyTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Copy"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "copy file/45fe99621d2a4642875bce7df0ba92ab"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200675}, {"type": "absolute", "value": 4200262}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205629}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205667}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215043}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215059}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete file": {"meta": {"name": "delete file", "namespace": "host-interaction/file-system/delete", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Delete File"], "objective": "File System", "behavior": "Delete File", "method": "", "id": "C0047"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x100015F0", "31600AD0D1A7EA615690DF111AE36C73:0x401A15", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200414}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203794}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203897}, {"type": "absolute", "value": 4203859}, {"type": "absolute", "value": 4203935}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208841}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210047}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210564}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211354}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211731}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211830}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211922}, {"type": "absolute", "value": 4211870}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/280acfd9a5fd449f883d1f0e4a7150e6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check mutex and exit": {"meta": {"name": "check mutex and exit", "namespace": "host-interaction/mutex", "authors": ["@_re_fox", "moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Check Mutex"], "objective": "Process", "behavior": "Check Mutex", "method": "", "id": "C0043"}, {"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["1d8fd13c890060464019c0f07b928b1a:0x402eb0", "Practical Malware Analysis Lab 11-03.dll_:0x10001410"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check mutex and exit\n    namespace: host-interaction/mutex\n    authors:\n      - \"@_re_fox\"\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Process::Check Mutex [C0043]\n      - Process::Terminate Process [C0018]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402eb0\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001410\n  features:\n    - and:\n      - match: create mutex\n      - or:\n        - api: ExitProcess\n        - api: exit\n        - api: _Exit\n        - api: _exit\n        - or:\n          - api: WaitForSingleObject\n          - and:\n            - api: GetLastError\n            - or:\n              - number: 2 = ERROR_FILE_NOT_FOUND\n              - number: 0xB7 = ERROR_ALREADY_EXISTS\n              - number: 5 = ERROR_ACCESS_DENIED\n", "matches": [[{"type": "absolute", "value": 4200162}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create mutex"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutex"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200200}, {"type": "absolute", "value": 4200432}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateMutexEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Mutex::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200162}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ExitProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200675}, {"type": "absolute", "value": 4200262}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200291}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "GetLastError"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "ERROR_FILE_NOT_FOUND"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 183, "description": "ERROR_ALREADY_EXISTS"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 5, "description": "ERROR_ACCESS_DENIED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 4200703}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200748}, {"type": "absolute", "value": 4200735}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get proxy": {"meta": {"name": "get proxy", "namespace": "host-interaction/network/proxy", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Network Configuration Discovery"], "tactic": "Discovery", "technique": "System Network Configuration Discovery", "subtechnique": "", "id": "T1016"}], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get proxy\n    namespace: host-interaction/network/proxy\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n  features:\n    - and:\n      - match: create or open registry key\n      - string: \"ProxyServer\"\n", "matches": [[{"type": "absolute", "value": 4200765}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200803}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200765}], "captures": {}}, {"success": true, "node": {"feature": {"type": "string", "string": "ProxyServer"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200859}], "captures": {}}], "locations": [], "captures": {}}]]}, "get socket status": {"meta": {"name": "get socket status", "namespace": "communication/socket", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Network Configuration Discovery"], "tactic": "Discovery", "technique": "System Network Configuration Discovery", "subtechnique": "", "id": "T1016"}], "mbc": [{"parts": ["Communication", "Socket Communication", "Get Socket Status"], "objective": "Communication", "behavior": "Socket Communication", "method": "Get Socket Status", "id": "C0001.012"}], "references": [], "examples": ["6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - and:\n      - api: ws2_32.select\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.select"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201305}, {"type": "absolute", "value": 4201188}, {"type": "absolute", "value": 4201367}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204769}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.select"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204957}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214238}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.select"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214596}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.select"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214913}, {"type": "absolute", "value": 4214837}], "captures": {}}], "locations": [], "captures": {}}]]}, "set socket configuration": {"meta": {"name": "set socket configuration", "namespace": "communication/socket", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Set Socket Config"], "objective": "Communication", "behavior": "Socket Communication", "method": "Set Socket Config", "id": "C0001.001"}], "references": [], "examples": ["6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set socket configuration\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Set Socket Config [C0001.001]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.setsockopt\n      - api: ws2_32.ioctlsocket\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.setsockopt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.ioctlsocket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201076}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203794}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.setsockopt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.ioctlsocket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204085}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204769}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.setsockopt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.ioctlsocket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204822}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214238}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.setsockopt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.ioctlsocket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214539}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.setsockopt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.ioctlsocket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214778}, {"type": "absolute", "value": 4214870}], "captures": {}}], "locations": [], "captures": {}}]]}, "send data on socket": {"meta": {"name": "send data on socket", "namespace": "communication/socket/send", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Send Data"], "objective": "Communication", "behavior": "Socket Communication", "method": "Send Data", "id": "C0001.007"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.send\n      - api: ws2_32.sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: send\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data on socket": {"meta": {"name": "receive data on socket", "namespace": "communication/socket/receive", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Receive Data"], "objective": "Communication", "behavior": "Socket Communication", "method": "Receive Data", "id": "C0001.006"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recv\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201393}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201393}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204404}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204448}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204448}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206033}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206033}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206102}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214937}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214937}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216212}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216229}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216229}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send data": {"meta": {"name": "send data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Send Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Send Data", "id": "B0030.001"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for sending data to a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201276}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202215}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4202215}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202296}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4202215}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4214737}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214812}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4214737}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215566}], "captures": {"!!Connect Through HTTP Tunnel!!\n": [{"type": "absolute", "value": 4215566}]}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215566}], "captures": {"!!Connect Through HTTP Tunnel!!\n": [{"type": "absolute", "value": 4215566}]}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data": {"meta": {"name": "receive data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Receive Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Receive Data", "id": "B0030.002"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for receiving data from a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n", "matches": [[{"type": "absolute", "value": 4200992}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201393}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201393}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200992}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204404}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204448}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204448}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204404}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206005}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206033}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206033}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4206005}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206102}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4206102}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214737}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214937}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214937}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4214737}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4216212}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216229}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216229}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4216212}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 4201599}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201632}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201803}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201620}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202215}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202235}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202256}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202223}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205056}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205084}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205154}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205072}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206510}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206578}, {"type": "absolute", "value": 4206589}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206578}, {"type": "absolute", "value": 4206805}, {"type": "absolute", "value": 4206824}, {"type": "absolute", "value": 4206841}, {"type": "absolute", "value": 4206589}, {"type": "absolute", "value": 4206943}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206547}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207726}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207804}, {"type": "absolute", "value": 4207815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208004}, {"type": "absolute", "value": 4207804}, {"type": "absolute", "value": 4207981}, {"type": "absolute", "value": 4207815}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207777}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208494}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208512}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208540}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208500}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208579}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208597}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208626}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208585}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4213672}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213850}, {"type": "absolute", "value": 4213821}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213730}, {"type": "absolute", "value": 4214150}, {"type": "absolute", "value": 4213800}, {"type": "absolute", "value": 4214228}, {"type": "absolute", "value": 4214101}, {"type": "absolute", "value": 4213942}, {"type": "absolute", "value": 4214201}, {"type": "absolute", "value": 4213850}, {"type": "absolute", "value": 4213821}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213780}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215066}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215095}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215168}, {"type": "absolute", "value": 4215155}, {"type": "absolute", "value": 4215219}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215365}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215540}, {"type": "absolute", "value": 4215749}, {"type": "absolute", "value": 4216073}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215353}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 4202598}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202790}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202796}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202784}, {"type": "absolute", "value": 4202786}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202821}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202873}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203172}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203178}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203168}, {"type": "absolute", "value": 4203042}, {"type": "absolute", "value": 4203166}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203201}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203253}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203378}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203384}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203372}, {"type": "absolute", "value": 4203374}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203407}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203468}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203704}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203710}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203698}, {"type": "absolute", "value": 4203700}, {"type": "absolute", "value": 4203566}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203733}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211928}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211995}, {"type": "absolute", "value": 4211980}, {"type": "absolute", "value": 4212006}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212309}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212618}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "resolve DNS": {"meta": {"name": "resolve DNS", "namespace": "communication/dns", "authors": ["william.ballenthin@mandiant.com", "johnk3r", "joakim@intezer.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "DNS Communication", "Resolve"], "objective": "Communication", "behavior": "DNS Communication", "method": "Resolve", "id": "C0011.001"}], "references": [], "examples": ["17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: ws2_32.gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: getaddrinfo\n      - api: GetAddrInfo\n      - api: GetAddrInfoEx\n      - api: gethostbyname\n      - api: getaddrinfo\n      - api: getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n", "matches": [[{"type": "absolute", "value": 4204623}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204693}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_A"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_W"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_UTF8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQueryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfoEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204693}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getnameinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Dns::GetHostAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204738}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204742}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_A"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_W"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_UTF8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQueryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfoEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204742}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getnameinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Dns::GetHostAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4213672}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213691}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_A"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_W"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_UTF8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQueryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfoEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213691}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getnameinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Dns::GetHostAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4214238}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214361}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_A"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_W"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_UTF8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQueryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfoEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214361}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getnameinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Dns::GetHostAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get hostname": {"meta": {"name": "get hostname", "namespace": "host-interaction/os/hostname", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "7351f8a40c5450557b24622417fc478d:0x405438"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n", "matches": [[{"type": "absolute", "value": 4204623}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204648}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerNameEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetComputerObjectName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204676}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204676}], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk information": {"meta": {"name": "get disk information", "namespace": "host-interaction/hardware/storage", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "972B219F18379907A045431303F4DA7D:0x41064E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n", "matches": [[{"type": "absolute", "value": 4206210}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206354}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206388}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206290}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 4206510}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206745}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206902}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206704}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206702}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4206611}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207726}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207865}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208425}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207834}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207832}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4207830}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "modify access privileges": {"meta": {"name": "modify access privileges", "namespace": "host-interaction/process/modify", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Privilege Escalation", "Access Token Manipulation"], "tactic": "Privilege Escalation", "technique": "Access Token Manipulation", "subtechnique": "", "id": "T1134"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403BE0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: modify access privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403BE0\n  features:\n    - and:\n      - api: advapi32.AdjustTokenPrivileges\n      - optional:\n        - or:\n          - api: advapi32.LookupPrivilegeValue\n", "matches": [[{"type": "absolute", "value": 4207104}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AdjustTokenPrivileges"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207166}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.LookupPrivilegeValue"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207133}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4207200}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AdjustTokenPrivileges"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4207214}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.LookupPrivilegeValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get session user name": {"meta": {"name": "get session user name", "namespace": "host-interaction/session", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Owner/User Discovery"], "tactic": "Discovery", "technique": "System Owner/User Discovery", "subtechnique": "", "id": "T1033"}, {"parts": ["Discovery", "Account Discovery"], "tactic": "Discovery", "technique": "Account Discovery", "subtechnique": "", "id": "T1087"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 14-01.exe_:0x401285"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get session user name\n    namespace: host-interaction/session\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n      - Discovery::Account Discovery [T1087]\n    examples:\n      - Practical Malware Analysis Lab 14-01.exe_:0x401285\n  features:\n    - or:\n      - api: advapi32.GetUserName\n      - api: secur32.GetUserNameEx\n      - basic block:\n        - and:\n          # - match: get session information (see #463)\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - api: System.Security.Principal.WindowsIdentity::GetCurrent\n      - property/read: System.Environment::UserName\n", "matches": [[{"type": "absolute", "value": 4207726}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.GetUserName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208162}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "secur32.GetUserNameEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "get session user name/b26bd83459354709bcb4f26c417a3247"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Security.Principal.WindowsIdentity::GetCurrent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::UserName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "move file": {"meta": {"name": "move file", "namespace": "host-interaction/file-system/move", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Move File"], "objective": "File System", "behavior": "Move File", "method": "", "id": "C0063"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n", "matches": [[{"type": "absolute", "value": 4208882}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.MoveFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.MoveFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "MoveFileWithProgress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "MoveFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "rename"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208908}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wrename"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::MoveTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Move"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "move file/a251b177a54f4e67ab7feb3d66037c00"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate files on windows": {"meta": {"name": "enumerate files on windows", "namespace": "host-interaction/file-system/files/list", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": ["https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315"], "examples": ["Practical Malware Analysis Lab 01-01.exe_:0x4011E0", "Practical Malware Analysis Lab 20-02.exe_:0x401000", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x14000203C"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate files on windows\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x4011E0\n      - Practical Malware Analysis Lab 20-02.exe_:0x401000\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x14000203C\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.FindFirstFile\n          - api: kernel32.FindFirstFileEx\n          - api: kernel32.FindFirstFileTransacted\n          - api: kernel32.FindFirstFileName\n          - api: kernel32.FindFirstFileNameTransacted\n        - or:\n          - api: kernel32.FindNextFile\n          - api: kernel32.FindNextFileName\n        - optional:\n          - api: kernel32.FindClose\n          - match: contain loop\n      - and:\n        - basic block:\n          - and:\n            - number: 1 = DIRECTORY_QUERY\n            - api: ntdll.NtOpenDirectoryObject\n        - api: ntdll.NtQueryDirectoryObject\n        - optional:\n          - api: RtlAllocateHeap\n          - match: contain loop\n          - characteristic: indirect call\n      - or:\n        - api: System.IO.DirectoryInfo::GetFiles\n        - api: System.IO.DirectoryInfo::EnumerateFiles\n        - api: System.IO.Directory::GetFiles\n        - api: System.IO.Directory::EnumerateFiles\n        - api: System.IO.Directory::EnumerateFileSystemEntries\n        - api: System.IO.DirectoryInfo::GetDirectories\n        - api: System.IO.DirectoryInfo::EnumerateDirectories\n        - api: System.IO.Directory::GetDirectories\n        - api: System.IO.Directory::EnumerateDirectories\n", "matches": [[{"type": "absolute", "value": 4209650}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate files on windows/9fc0c0f43ea04b198e4af569f8afd65e"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueryDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlAllocateHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209650}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4209650}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFileSystemEntries"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209673}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileNameTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209721}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindClose"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209746}, {"type": "absolute", "value": 4209734}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209650}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4209650}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210047}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate files on windows/9fc0c0f43ea04b198e4af569f8afd65e"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueryDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlAllocateHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210448}, {"type": "absolute", "value": 4210226}, {"type": "absolute", "value": 4210325}, {"type": "absolute", "value": 4210278}, {"type": "absolute", "value": 4210093}, {"type": "absolute", "value": 4210526}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFileSystemEntries"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210112}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileNameTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210151}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindClose"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210578}, {"type": "absolute", "value": 4210589}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210750}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate files on windows/9fc0c0f43ea04b198e4af569f8afd65e"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueryDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlAllocateHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210995}, {"type": "absolute", "value": 4211220}, {"type": "absolute", "value": 4211189}, {"type": "absolute", "value": 4211097}, {"type": "absolute", "value": 4211162}, {"type": "absolute", "value": 4210971}, {"type": "absolute", "value": 4210796}, {"type": "absolute", "value": 4210923}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFileSystemEntries"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileNameTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210848}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindClose"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211268}, {"type": "absolute", "value": 4211255}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete directory": {"meta": {"name": "delete directory", "namespace": "host-interaction/file-system/delete", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Delete Directory"], "objective": "File System", "behavior": "Delete Directory", "method": "", "id": "C0048"}], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x10009236", "AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete directory\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete Directory [C0048]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10009236\n      - AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0\n  features:\n    - or:\n      - api: RemoveDirectory\n      - api: RemoveDirectoryTransacted\n      - api: _rmdir\n      - api: _wrmdir\n      - api: System.IO.DirectoryInfo::Delete\n      - api: System.IO.Directory::Delete\n", "matches": [[{"type": "absolute", "value": 4210047}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "RemoveDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210604}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RemoveDirectoryTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_rmdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wrmdir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate files recursively": {"meta": {"name": "enumerate files recursively", "namespace": "host-interaction/file-system/files/list", "authors": ["@_re_fox", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["5f66b82558ca92e54e77f216ef4c066c:0x40640E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate files recursively\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - \"@_re_fox\"\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 5f66b82558ca92e54e77f216ef4c066c:0x40640E\n  features:\n    - and:\n      - or:\n        - match: enumerate files on windows\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4210047}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "enumerate files on windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate files on windows/9fc0c0f43ea04b198e4af569f8afd65e"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueryDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlAllocateHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210448}, {"type": "absolute", "value": 4210226}, {"type": "absolute", "value": 4210325}, {"type": "absolute", "value": 4210278}, {"type": "absolute", "value": 4210093}, {"type": "absolute", "value": 4210526}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFileSystemEntries"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210112}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileNameTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210151}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindClose"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210578}, {"type": "absolute", "value": 4210589}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210047}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210750}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "enumerate files on windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "enumerate files on windows/9fc0c0f43ea04b198e4af569f8afd65e"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtQueryDirectoryObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlAllocateHeap"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210995}, {"type": "absolute", "value": 4211220}, {"type": "absolute", "value": 4211189}, {"type": "absolute", "value": 4211097}, {"type": "absolute", "value": 4211162}, {"type": "absolute", "value": 4210971}, {"type": "absolute", "value": 4210796}, {"type": "absolute", "value": 4210923}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFiles"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateFileSystemEntries"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.DirectoryInfo::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::EnumerateDirectories"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210815}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindFirstFileNameTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210848}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindNextFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindClose"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211268}, {"type": "absolute", "value": 4211255}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210750}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file size": {"meta": {"name": "get file size", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["mimikatz.exe_:0x40630D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n", "matches": [[{"type": "absolute", "value": 4211354}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSize"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211503}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSizeEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileInfo::Length"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212066}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSize"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212183}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSizeEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileInfo::Length"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read file on Windows": {"meta": {"name": "read file on Windows", "namespace": "host-interaction/file-system/read", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Read File"], "objective": "File System", "behavior": "Read File", "method": "", "id": "C0051"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n", "matches": [[{"type": "absolute", "value": 4211354}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211426}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211434}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211614}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "timestomp file": {"meta": {"name": "timestomp file", "namespace": "anti-analysis/anti-forensic/timestomp", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Indicator Removal", "Timestomp"], "tactic": "Defense Evasion", "technique": "Indicator Removal", "subtechnique": "Timestomp", "id": "T1070.006"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 03-04.exe_:0x4014e0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: timestomp file\n    namespace: anti-analysis/anti-forensic/timestomp\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Indicator Removal::Timestomp [T1070.006]\n    examples:\n      - Practical Malware Analysis Lab 03-04.exe_:0x4014e0\n  features:\n    - and:\n      - or:\n        - api: kernel32.GetSystemTime\n        - api: kernel32.FileTimeToLocalFileTime\n        - api: kernel32.GetSystemTimeAsFileTime\n        - api: kernel32.SystemTimeToFileTime\n        - api: kernel32.GetFileTime\n      - api: kernel32.SetFileTime\n", "matches": [[{"type": "absolute", "value": 4212690}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetFileTime"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212827}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FileTimeToLocalFileTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemTimeAsFileTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SystemTimeToFileTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileTime"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212808}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate network shares": {"meta": {"name": "enumerate network shares", "namespace": "host-interaction/network", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Network Share Discovery"], "tactic": "Discovery", "technique": "Network Share Discovery", "subtechnique": "", "id": "T1135"}], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate network shares\n    namespace: host-interaction/network\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Network Share Discovery [T1135]\n  features:\n    - and:\n      - or:\n        - api: netapi32.NetShareEnum\n        - api: mpr.WNetEnumResource\n      - match: contain loop\n", "matches": [[{"type": "absolute", "value": 4212997}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "contain loop"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212997}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4212997}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "netapi32.NetShareEnum"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "mpr.WNetEnumResource"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213349}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create two anonymous pipes": {"meta": {"name": "create two anonymous pipes", "namespace": "communication/named-pipe/create", "authors": ["matthew.williams@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Create Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Create Pipe", "id": "C0003.001"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4011C0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create two anonymous pipes\n    namespace: communication/named-pipe/create\n    authors:\n      - matthew.williams@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Create Pipe [C0003.001]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\n  features:\n    - and:\n      - count(api(CreatePipe)): 2\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 2, "max": 2, "child": {"type": "api", "api": "CreatePipe"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}], "locations": [], "captures": {}}]]}, "create pipe": {"meta": {"name": "create pipe", "namespace": "communication/named-pipe/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Create Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Create Pipe", "id": "C0003.001"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003a13"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create pipe\n    namespace: communication/named-pipe/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Create Pipe [C0003.001]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003a13\n  features:\n    - or:\n      - api: kernel32.CreatePipe\n      - api: kernel32.CreateNamedPipe\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read pipe": {"meta": {"name": "read pipe", "namespace": "communication/named-pipe/read", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Read Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Read Pipe", "id": "C0003.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4014C0"], "description": "PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read pipe\n    namespace: communication/named-pipe/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    description: PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Read Pipe [C0003.003]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4014C0\n  features:\n    - or:\n      - and:\n        - api: kernel32.PeekNamedPipe\n        - api: kernel32.ReadFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.PeekNamedPipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215772}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send HTTP request": {"meta": {"name": "send HTTP request", "namespace": "communication/http/client", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Send Request"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Send Request", "id": "C0002.003"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60", "6A352C3E55E8AE5ED39DC1BE7FB964B1:0x100026E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send HTTP request\n    namespace: communication/http/client\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Send Request [C0002.003]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x100026E0\n  features:\n    - or:\n      - api: System.Net.WebRequest::GetResponse\n      - api: System.Net.WebRequest::GetResponseAsync\n      - and:\n        - or:\n          - api: wininet.HttpOpenRequest\n          - api: wininet.InternetConnect\n        - or:\n          - api: wininet.HttpSendRequest\n          - api: wininet.HttpSendRequestEx\n      - and:\n        - api: winhttp.WinHttpSendRequest\n        - api: winhttp.WinHttpWriteData\n        - optional:\n          - or:\n            - api: winhttp.WinHttpOpenRequest\n            - api: winhttp.WinHttpConnect\n      - and:\n        - match: send data on socket\n        - string: /HTTP/i\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215566}], "captures": {"!!Connect Through HTTP Tunnel!!\n": [{"type": "absolute", "value": 4215566}]}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create a process with modified I/O handles and window": {"meta": {"name": "create a process with modified I/O handles and window", "namespace": "host-interaction/process/create", "authors": ["matthew.williams@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa"], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4011C0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create a process with modified I/O handles and window\n    namespace: host-interaction/process/create\n    authors:\n      - matthew.williams@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Process [C0017]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\n  features:\n    - or:\n      - and:\n        - or:\n          - description: API functions that accept a pointer to a STARTUPINFO structure\n          - api: kernel32.CreateProcess\n          - api: kernel32.CreateProcessInternal\n          - api: advapi32.CreateProcessAsUser\n          - api: advapi32.CreateProcessWithLogon\n          - api: advapi32.CreateProcessWithToken\n        - number: 0x101 = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW\n          # STARTF_USESTDHANDLES indicates the hStdInput, hStdOutput, and hStdError members contain additional information\n          # STARTF_USESHOWWINDOW indicates the wShowWindow member contains additional information\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x44 = StartupInfo.cb (size)\n          - and:\n            - arch: amd64\n            - number: 0x68 = StartupInfo.cb (size)\n          # STARTUPINFOEX size values not currently supported by this rule.\n        - optional:\n          - api: kernel32.GetStartupInfo\n      - and:\n        - api: System.Diagnostics.Process::Start\n        - or:\n          - property/write: System.Diagnostics.ProcessStartInfo::UseShellExecute\n          - property/write: System.Diagnostics.ProcessStartInfo::Verb\n          - property/write: System.Diagnostics.ProcessStartInfo::WindowStyle\n          - property/write: System.Diagnostics.ProcessStartInfo::WorkingDirectory\n          - property/write: System.Diagnostics.ProcessStartInfo::FileName\n          - property/write: System.Diagnostics.ProcessStartInfo::Arguments\n          - property/write: System.Diagnostics.ProcessStartInfo::CreateNoWindow\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardOutput\n          - property/write: System.Diagnostics.ProcessStartInfo::RedirectStandardInput\n          - property/read: System.Diagnostics.Process::StandardOutput\n          - property/read: System.Diagnostics.Process::StandardInput\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Verb"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Arguments"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "API functions that accept a pointer to a STARTUPINFO structure"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 257, "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215479}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215441}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 104, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStartupInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read and send data from client to server": {"meta": {"name": "read and send data from client to server", "namespace": "communication/c2/file-transfer", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read and send data from client to server\n    namespace: communication/c2/file-transfer\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n  features:\n    - and:\n      - match: host-interaction/file-system/read\n      - match: send data\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/read"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215566}], "captures": {"!!Connect Through HTTP Tunnel!!\n": [{"type": "absolute", "value": 4215566}]}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponse"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::GetResponseAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/HTTP/i"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215566}], "captures": {"!!Connect Through HTTP Tunnel!!\n": [{"type": "absolute", "value": 4215566}]}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.HttpSendRequestEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpSendRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpWriteData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpOpenRequest"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "winhttp.WinHttpConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215741}, {"type": "absolute", "value": 4215926}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}]]}, "receive and write data from server to client": {"meta": {"name": "receive and write data from server to client", "namespace": "communication/c2/file-transfer", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive and write data from server to client\n    namespace: communication/c2/file-transfer\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n  features:\n    - and:\n      - match: receive data\n      - match: host-interaction/file-system/write\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/write"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}]]}, "write pipe": {"meta": {"name": "write pipe", "namespace": "communication/named-pipe/write", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Write Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Write Pipe", "id": "C0003.004"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write pipe\n    namespace: communication/named-pipe/write\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Write Pipe [C0003.004]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n  features:\n    - or:\n      - and:\n        - or:\n          - match: create pipe\n          - match: connect pipe\n        - api: kernel32.WriteFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect pipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "download and write a file": {"meta": {"name": "download and write a file", "namespace": "communication/c2/file-transfer", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Command and Control", "Ingress Tool Transfer"], "tactic": "Command and Control", "technique": "Ingress Tool Transfer", "subtechnique": "", "id": "T1105"}], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Server to Client File Transfer"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Server to Client File Transfer", "id": "B0030.003"}], "references": [], "examples": ["5D7C34B6854D48D3DA4F96B71550A221:0x401346"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {"malware_category": "downloader"}}, "source": "rule:\n  meta:\n    name: download and write a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: downloader\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Command and Control::Ingress Tool Transfer [T1105]\n    mbc:\n      - Command and Control::C2 Communication::Server to Client File Transfer [B0030.003]\n    examples:\n      - 5D7C34B6854D48D3DA4F96B71550A221:0x401346\n  features:\n    - and:\n      - match: receive data\n      - match: host-interaction/file-system/write\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216021}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/write"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}]]}, "write and execute a file": {"meta": {"name": "write and execute a file", "namespace": "communication/c2/file-transfer", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Execution", "Install Additional Program"], "objective": "Execution", "behavior": "Install Additional Program", "method": "", "id": "B0023"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403A40", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {"malware_category": "launcher"}}, "source": "rule:\n  meta:\n    name: write and execute a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: launcher\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403A40\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n  features:\n    - and:\n      - match: host-interaction/file-system/write\n      - match: host-interaction/process/create\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/write"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Verb"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Arguments"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "API functions that accept a pointer to a STARTUPINFO structure"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 257, "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215479}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215441}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 104, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStartupInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}]]}, "execute shell command and capture output": {"meta": {"name": "execute shell command and capture output", "namespace": "communication/c2/shell", "authors": ["matthew.williams@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Command and Scripting Interpreter", "Windows Command Shell"], "tactic": "Execution", "technique": "Command and Scripting Interpreter", "subtechnique": "Windows Command Shell", "id": "T1059.003"}], "mbc": [], "references": ["https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa"], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4011C0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: execute shell command and capture output\n    namespace: communication/c2/shell\n    authors:\n      - matthew.williams@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4011C0\n  features:\n    - and:\n      - match: create a process with modified I/O handles and window\n      - match: create pipe\n      - or:\n        - match: get COMSPEC environment variable\n        - string: \"\\\\cmd.exe\"\n        - string: \"cmd.exe\"\n        - string: \"cmd.exe /c \"\n        - string: \"C:\\\\Windows\\\\system32\\\\cmd.exe\"\n      - optional:\n        - api: kernel32.GetSystemDirectory\n        - api: kernel32.SetCurrentDirectory\n        - match: create thread\n        - match: read pipe\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create a process with modified I/O handles and window"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Verb"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Arguments"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "API functions that accept a pointer to a STARTUPINFO structure"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 257, "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215479}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215441}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 104, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStartupInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "create pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create thread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "read pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.PeekNamedPipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215772}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "get COMSPEC environment variable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "\\cmd.exe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "string", "string": "cmd.exe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215474}], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "cmd.exe /c "}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "string", "string": "C:\\Windows\\system32\\cmd.exe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create reverse shell": {"meta": {"name": "create reverse shell", "namespace": "communication/c2/shell", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Command and Scripting Interpreter", "Windows Command Shell"], "tactic": "Execution", "technique": "Command and Scripting Interpreter", "subtechnique": "Windows Command Shell", "id": "T1059.003"}], "mbc": [{"parts": ["Impact", "Remote Access", "Reverse Shell"], "objective": "Impact", "behavior": "Remote Access", "method": "Reverse Shell", "id": "B0022.001"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create reverse shell\n    namespace: communication/c2/shell\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003]\n    mbc:\n      - Impact::Remote Access::Reverse Shell [B0022.001]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n  features:\n    - or:\n      - and:\n        - match: create pipe\n        - api: kernel32.PeekNamedPipe\n        - api: kernel32.CreateProcess\n        - api: kernel32.ReadFile\n        - api: kernel32.WriteFile\n      - and:\n        - match: host-interaction/process/create\n        - match: read pipe\n        - match: write pipe\n      - and:\n        - match: create pipe\n        - match: host-interaction/process/create\n        - basic block:\n          - and:\n            - count(api(SetHandleInformation)): 2 or more\n            - number: 1 = HANDLE_FLAG_INHERIT\n", "matches": [[{"type": "absolute", "value": 4215332}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Verb"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Arguments"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "API functions that accept a pointer to a STARTUPINFO structure"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 257, "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215479}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215441}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 104, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStartupInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "read pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.PeekNamedPipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215772}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "write pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect pipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::UseShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Verb"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WindowStyle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::WorkingDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::FileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::Arguments"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::CreateNoWindow"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "write", "property": "System.Diagnostics.ProcessStartInfo::RedirectStandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Diagnostics.Process::StandardInput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or", "description": "API functions that accept a pointer to a STARTUPINFO structure"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 257, "description": "STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215479}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 68, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215441}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 104, "description": "StartupInfo.cb (size)"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStartupInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create reverse shell/a785ad9500ec4ccb87a7e350e67b616f"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create pipe"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215424}, {"type": "absolute", "value": 4215439}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4215332}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.PeekNamedPipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215772}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215523}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4215805}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216050}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry key": {"meta": {"name": "query or enumerate registry key", "namespace": "host-interaction/registry", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Key", "id": "C0036.005"}], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x404930", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Key [C0036.005]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404930\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegEnumKey\n        - api: advapi32.RegEnumKeyEx\n        - api: advapi32.RegQueryInfoKeyA\n        - api: ZwQueryKey\n        - api: ZwEnumerateKey\n        - api: NtQueryKey\n        - api: NtEnumerateKey\n        - api: RtlCheckRegistryKey\n        - api: SHEnumKeyEx\n        - api: SHQueryInfoKey\n        - api: SHRegEnumUSKey\n        - api: SHRegQueryInfoUSKey\n        - api: Microsoft.Win32.RegistryKey::GetSubKeyNames\n        - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenSubKey\n", "matches": [[{"type": "absolute", "value": 4216627}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216656}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4216627}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216699}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryInfoKeyA"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCheckRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryInfoKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryInfoUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetSubKeyNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete registry key": {"meta": {"name": "delete registry key", "namespace": "host-interaction/registry/delete", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "johnk3r"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Modify Registry"], "tactic": "Defense Evasion", "technique": "Modify Registry", "subtechnique": "", "id": "T1112"}], "mbc": [{"parts": ["Operating System", "Registry", "Delete Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Delete Registry Key", "id": "C0036.002"}], "references": [], "examples": ["4f11bdb380dafa2518053c6d20147a05:0x402A36", "493167E85E45363D09495D0841C30648:0x404D60"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete registry key\n    namespace: host-interaction/registry/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scope: function\n    att&ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Key [C0036.002]\n    examples:\n      - 4f11bdb380dafa2518053c6d20147a05:0x402A36\n      - 493167E85E45363D09495D0841C30648:0x404D60\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteKey\n        - api: advapi32.RegDeleteTree\n        - api: advapi32.RegDeleteKeyEx\n        - api: advapi32.RegDeleteKeyTransacted\n        - api: ZwDeleteKey\n        - api: NtDeleteKey\n        - api: SHDeleteKey\n        - api: SHDeleteEmptyKey\n        - api: SHRegDeleteEmptyUSKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKeyTree\n", "matches": [[{"type": "absolute", "value": 4216881}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216901}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4216881}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteTree"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegDeleteKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "SHDeleteKey"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4216922}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHDeleteEmptyKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegDeleteEmptyUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::DeleteSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::DeleteSubKeyTree"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4231168}], "captures": {}}]]}}}
