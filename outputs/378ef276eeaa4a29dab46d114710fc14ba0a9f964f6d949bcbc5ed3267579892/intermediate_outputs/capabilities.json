{"meta": {"timestamp": "2023-04-09T22:23:27.265128", "version": "5.0.0", "argv": ["-j", "../inputs//378ef276eeaa4a29dab46d114710fc14ba0a9f964f6d949bcbc5ed3267579892"], "sample": {"md5": "9617f3948b1886ebc95689c02d2cf264", "sha1": "87f45e82edd63ef05c41d18aeddeac00c49f1aee", "sha256": "378ef276eeaa4a29dab46d114710fc14ba0a9f964f6d949bcbc5ed3267579892", "path": "../inputs/378ef276eeaa4a29dab46d114710fc14ba0a9f964f6d949bcbc5ed3267579892"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/NUS/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4198400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198437}}]}, {"address": {"type": "absolute", "value": 4198592}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198592}}, {"address": {"type": "absolute", "value": 4198621}}, {"address": {"type": "absolute", "value": 4198640}}, {"address": {"type": "absolute", "value": 4198680}}, {"address": {"type": "absolute", "value": 4198770}}, {"address": {"type": "absolute", "value": 4198818}}, {"address": {"type": "absolute", "value": 4198843}}, {"address": {"type": "absolute", "value": 4198921}}]}, {"address": {"type": "absolute", "value": 4199024}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199024}}, {"address": {"type": "absolute", "value": 4199112}}, {"address": {"type": "absolute", "value": 4199127}}, {"address": {"type": "absolute", "value": 4199152}}, {"address": {"type": "absolute", "value": 4199253}}, {"address": {"type": "absolute", "value": 4199273}}, {"address": {"type": "absolute", "value": 4199303}}, {"address": {"type": "absolute", "value": 4199347}}]}, {"address": {"type": "absolute", "value": 4199456}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199456}}, {"address": {"type": "absolute", "value": 4199674}}, {"address": {"type": "absolute", "value": 4199812}}, {"address": {"type": "absolute", "value": 4199964}}, {"address": {"type": "absolute", "value": 4200069}}, {"address": {"type": "absolute", "value": 4200183}}]}, {"address": {"type": "absolute", "value": 4200304}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200336}}, {"address": {"type": "absolute", "value": 4200371}}, {"address": {"type": "absolute", "value": 4200461}}, {"address": {"type": "absolute", "value": 4200499}}]}, {"address": {"type": "absolute", "value": 4200576}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200576}}, {"address": {"type": "absolute", "value": 4200642}}]}, {"address": {"type": "absolute", "value": 4200976}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200976}}]}, {"address": {"type": "absolute", "value": 4201200}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201200}}]}, {"address": {"type": "absolute", "value": 4201504}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201504}}, {"address": {"type": "absolute", "value": 4201732}}]}, {"address": {"type": "absolute", "value": 4201808}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201808}}, {"address": {"type": "absolute", "value": 4202023}}, {"address": {"type": "absolute", "value": 4202136}}, {"address": {"type": "absolute", "value": 4202212}}, {"address": {"type": "absolute", "value": 4202514}}]}, {"address": {"type": "absolute", "value": 4202688}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202688}}]}, {"address": {"type": "absolute", "value": 4202992}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203058}}, {"address": {"type": "absolute", "value": 4203198}}, {"address": {"type": "absolute", "value": 4203416}}]}, {"address": {"type": "absolute", "value": 4203442}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204040}}]}, {"address": {"type": "absolute", "value": 4203457}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4203489}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4203624}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4203968}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4203988}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204030}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204040}}]}, {"address": {"type": "absolute", "value": 4204302}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204360}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204407}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204507}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204907}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205059}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205062}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205071}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205195}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205684}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206037}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206094}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206124}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206267}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206420}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206751}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206828}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206937}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206949}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206958}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206967}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207019}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207080}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207236}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207242}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207251}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207260}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207381}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207407}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207686}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207689}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207698}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207701}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4207710}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208089}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208184}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208332}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208819}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208889}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208904}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209201}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209238}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209283}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209299}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209365}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209392}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209436}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209502}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209516}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209559}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209583}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209592}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209601}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209652}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209688}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209839}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210138}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210159}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4210159}}]}, {"address": {"type": "absolute", "value": 4210181}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210203}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210218}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210233}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210263}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210301}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210732}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210789}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211119}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211214}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211434}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211844}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212031}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212182}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212763}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212791}}]}, {"address": {"type": "absolute", "value": 4212801}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212829}}]}, {"address": {"type": "absolute", "value": 4212839}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212880}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212949}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4212976}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213375}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213511}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213530}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213552}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213674}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213905}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213969}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214153}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214338}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214347}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214398}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214467}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214543}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214621}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215508}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215613}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215867}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215882}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215984}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216208}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216356}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216436}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216500}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216752}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216788}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216828}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216912}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217088}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217232}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217296}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217328}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217332}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217353}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217370}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217455}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217468}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217821}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217827}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217887}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217902}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217917}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218099}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218148}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218202}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218208}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218231}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218272}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218336}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218416}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218555}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218574}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218604}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4218604}}]}, {"address": {"type": "absolute", "value": 4218968}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219085}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219317}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219416}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219479}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219562}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219744}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219842}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219865}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219915}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220124}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220140}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220270}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220702}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220753}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220804}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220816}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220848}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220917}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221083}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221093}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221124}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221136}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221460}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 1792, "functions": [{"address": {"type": "absolute", "value": 4198400}, "count": 53}, {"address": {"type": "absolute", "value": 4198592}, "count": 84}, {"address": {"type": "absolute", "value": 4199024}, "count": 73}, {"address": {"type": "absolute", "value": 4199456}, "count": 50}, {"address": {"type": "absolute", "value": 4200304}, "count": 58}, {"address": {"type": "absolute", "value": 4200576}, "count": 54}, {"address": {"type": "absolute", "value": 4200976}, "count": 65}, {"address": {"type": "absolute", "value": 4201200}, "count": 42}, {"address": {"type": "absolute", "value": 4201504}, "count": 56}, {"address": {"type": "absolute", "value": 4201808}, "count": 79}, {"address": {"type": "absolute", "value": 4202688}, "count": 39}, {"address": {"type": "absolute", "value": 4202992}, "count": 79}, {"address": {"type": "absolute", "value": 4203442}, "count": 47}, {"address": {"type": "absolute", "value": 4203968}, "count": 14}, {"address": {"type": "absolute", "value": 4203988}, "count": 23}, {"address": {"type": "absolute", "value": 4204302}, "count": 32}, {"address": {"type": "absolute", "value": 4205059}, "count": 14}, {"address": {"type": "absolute", "value": 4206937}, "count": 15}, {"address": {"type": "absolute", "value": 4206949}, "count": 13}, {"address": {"type": "absolute", "value": 4206958}, "count": 11}, {"address": {"type": "absolute", "value": 4207236}, "count": 16}, {"address": {"type": "absolute", "value": 4207251}, "count": 14}, {"address": {"type": "absolute", "value": 4207686}, "count": 14}, {"address": {"type": "absolute", "value": 4207698}, "count": 14}, {"address": {"type": "absolute", "value": 4207701}, "count": 14}, {"address": {"type": "absolute", "value": 4209502}, "count": 12}, {"address": {"type": "absolute", "value": 4210138}, "count": 22}, {"address": {"type": "absolute", "value": 4210159}, "count": 17}, {"address": {"type": "absolute", "value": 4212763}, "count": 26}, {"address": {"type": "absolute", "value": 4212801}, "count": 25}, {"address": {"type": "absolute", "value": 4212949}, "count": 12}, {"address": {"type": "absolute", "value": 4213511}, "count": 10}, {"address": {"type": "absolute", "value": 4213530}, "count": 9}, {"address": {"type": "absolute", "value": 4214338}, "count": 14}, {"address": {"type": "absolute", "value": 4217328}, "count": 7}, {"address": {"type": "absolute", "value": 4217332}, "count": 9}, {"address": {"type": "absolute", "value": 4217353}, "count": 13}, {"address": {"type": "absolute", "value": 4217370}, "count": 9}, {"address": {"type": "absolute", "value": 4217455}, "count": 11}, {"address": {"type": "absolute", "value": 4217821}, "count": 21}, {"address": {"type": "absolute", "value": 4217827}, "count": 21}, {"address": {"type": "absolute", "value": 4218202}, "count": 10}, {"address": {"type": "absolute", "value": 4218555}, "count": 14}, {"address": {"type": "absolute", "value": 4218574}, "count": 13}, {"address": {"type": "absolute", "value": 4218604}, "count": 56}, {"address": {"type": "absolute", "value": 4220124}, "count": 14}, {"address": {"type": "absolute", "value": 4220804}, "count": 9}, {"address": {"type": "absolute", "value": 4221460}, "count": 7}]}, "library_functions": [{"address": {"type": "absolute", "value": 4203457}, "name": "__freea"}, {"address": {"type": "absolute", "value": 4203489}, "name": "??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z"}, {"address": {"type": "absolute", "value": 4203624}, "name": "_fast_error_exit"}, {"address": {"type": "absolute", "value": 4204030}, "name": "_mainCRTStartup"}, {"address": {"type": "absolute", "value": 4204040}, "name": "___report_gsfailure"}, {"address": {"type": "absolute", "value": 4204360}, "name": "?CPtoLCID@@YAHH@Z"}, {"address": {"type": "absolute", "value": 4204407}, "name": "?setSBCS@@YAXPAUthreadmbcinfostruct@@@Z"}, {"address": {"type": "absolute", "value": 4204507}, "name": "?setSBUpLow@@YAXPAUthreadmbcinfostruct@@@Z"}, {"address": {"type": "absolute", "value": 4204907}, "name": "___updatetmbcinfo"}, {"address": {"type": "absolute", "value": 4205062}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4205071}, "name": "?getSystemCP@@YAHH@Z"}, {"address": {"type": "absolute", "value": 4205195}, "name": "__setmbcp_nolock"}, {"address": {"type": "absolute", "value": 4205684}, "name": "__setmbcp"}, {"address": {"type": "absolute", "value": 4206037}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4206094}, "name": "___initmbctable"}, {"address": {"type": "absolute", "value": 4206124}, "name": "___addlocaleref"}, {"address": {"type": "absolute", "value": 4206267}, "name": "___removelocaleref"}, {"address": {"type": "absolute", "value": 4206420}, "name": "___freetlocinfo"}, {"address": {"type": "absolute", "value": 4206751}, "name": "__updatetlocinfoEx_nolock"}, {"address": {"type": "absolute", "value": 4206828}, "name": "___updatetlocinfo"}, {"address": {"type": "absolute", "value": 4206967}, "name": "___set_flsgetvalue"}, {"address": {"type": "absolute", "value": 4207019}, "name": "__mtterm"}, {"address": {"type": "absolute", "value": 4207080}, "name": "__initptd"}, {"address": {"type": "absolute", "value": 4207242}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4207260}, "name": "__getptd_noexit"}, {"address": {"type": "absolute", "value": 4207381}, "name": "__getptd"}, {"address": {"type": "absolute", "value": 4207407}, "name": "__freefls@4"}, {"address": {"type": "absolute", "value": 4207689}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4207710}, "name": "__mtinit"}, {"address": {"type": "absolute", "value": 4208089}, "name": "_strcpy_s"}, {"address": {"type": "absolute", "value": 4208184}, "name": "_malloc"}, {"address": {"type": "absolute", "value": 4208332}, "name": "?__crtLCMapStringA_stat@@YAHPAUlocaleinfo_struct@@KKPBDHPADHHH@Z"}, {"address": {"type": "absolute", "value": 4208819}, "name": "___crtLCMapStringA"}, {"address": {"type": "absolute", "value": 4208889}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4208904}, "name": "__call_reportfault"}, {"address": {"type": "absolute", "value": 4209201}, "name": "__invoke_watson"}, {"address": {"type": "absolute", "value": 4209238}, "name": "__invalid_parameter"}, {"address": {"type": "absolute", "value": 4209283}, "name": "__invalid_parameter_noinfo"}, {"address": {"type": "absolute", "value": 4209299}, "name": "__get_errno_from_oserr"}, {"address": {"type": "absolute", "value": 4209365}, "name": "__errno"}, {"address": {"type": "absolute", "value": 4209392}, "name": "__alloca_probe_16"}, {"address": {"type": "absolute", "value": 4209436}, "name": "?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z"}, {"address": {"type": "absolute", "value": 4209516}, "name": "___crtCorExitProcess"}, {"address": {"type": "absolute", "value": 4209559}, "name": "___crtExitProcess"}, {"address": {"type": "absolute", "value": 4209583}, "name": "__lockexit"}, {"address": {"type": "absolute", "value": 4209592}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4209601}, "name": "__init_pointers"}, {"address": {"type": "absolute", "value": 4209652}, "name": "__initterm_e"}, {"address": {"type": "absolute", "value": 4209688}, "name": "__cinit"}, {"address": {"type": "absolute", "value": 4209839}, "name": "_doexit"}, {"address": {"type": "absolute", "value": 4210181}, "name": "__exit"}, {"address": {"type": "absolute", "value": 4210203}, "name": "__cexit"}, {"address": {"type": "absolute", "value": 4210218}, "name": "__c_exit"}, {"address": {"type": "absolute", "value": 4210233}, "name": "__amsg_exit"}, {"address": {"type": "absolute", "value": 4210263}, "name": "__GET_RTERRMSG"}, {"address": {"type": "absolute", "value": 4210301}, "name": "__NMSG_WRITE"}, {"address": {"type": "absolute", "value": 4210732}, "name": "__FF_MSGBANNER"}, {"address": {"type": "absolute", "value": 4210789}, "name": "__XcptFilter"}, {"address": {"type": "absolute", "value": 4211119}, "name": "__wincmdln"}, {"address": {"type": "absolute", "value": 4211214}, "name": "__setenvp"}, {"address": {"type": "absolute", "value": 4211434}, "name": "_parse_cmdline"}, {"address": {"type": "absolute", "value": 4211844}, "name": "__setargv"}, {"address": {"type": "absolute", "value": 4212031}, "name": "___crtGetEnvironmentStringsA"}, {"address": {"type": "absolute", "value": 4212182}, "name": "__ioinit"}, {"address": {"type": "absolute", "value": 4212839}, "name": "__heap_init"}, {"address": {"type": "absolute", "value": 4212880}, "name": "__SEH_prolog4"}, {"address": {"type": "absolute", "value": 4212976}, "name": "__except_handler4"}, {"address": {"type": "absolute", "value": 4213375}, "name": "___security_init_cookie"}, {"address": {"type": "absolute", "value": 4213552}, "name": "_memset"}, {"address": {"type": "absolute", "value": 4213674}, "name": "?__crtGetStringTypeA_stat@@YAHPAUlocaleinfo_struct@@KPBDHPAGHHH@Z"}, {"address": {"type": "absolute", "value": 4213905}, "name": "___crtGetStringTypeA"}, {"address": {"type": "absolute", "value": 4213969}, "name": "__mtinitlocks"}, {"address": {"type": "absolute", "value": 4214130}, "name": "__unlock"}, {"address": {"type": "absolute", "value": 4214153}, "name": "__mtinitlocknum"}, {"address": {"type": "absolute", "value": 4214347}, "name": "__lock"}, {"address": {"type": "absolute", "value": 4214398}, "name": "?"}, {"address": {"type": "absolute", "value": 4214467}, "name": "?"}, {"address": {"type": "absolute", "value": 4214543}, "name": "?"}, {"address": {"type": "absolute", "value": 4214621}, "name": "___free_lc_time"}, {"address": {"type": "absolute", "value": 4215508}, "name": "___free_lconv_num"}, {"address": {"type": "absolute", "value": 4215613}, "name": "___free_lconv_mon"}, {"address": {"type": "absolute", "value": 4215867}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4215882}, "name": "__callnewh"}, {"address": {"type": "absolute", "value": 4215984}, "name": "_strcspn"}, {"address": {"type": "absolute", "value": 4216208}, "name": "?"}, {"address": {"type": "absolute", "value": 4216356}, "name": "?"}, {"address": {"type": "absolute", "value": 4216400}, "name": "?"}, {"address": {"type": "absolute", "value": 4216436}, "name": "?"}, {"address": {"type": "absolute", "value": 4216500}, "name": "?"}, {"address": {"type": "absolute", "value": 4216752}, "name": "?"}, {"address": {"type": "absolute", "value": 4216788}, "name": "?"}, {"address": {"type": "absolute", "value": 4216828}, "name": "?"}, {"address": {"type": "absolute", "value": 4216912}, "name": "?"}, {"address": {"type": "absolute", "value": 4217088}, "name": "_strlen"}, {"address": {"type": "absolute", "value": 4217232}, "name": "_strpbrk"}, {"address": {"type": "absolute", "value": 4217296}, "name": "?terminate@@YAXXZ"}, {"address": {"type": "absolute", "value": 4217400}, "name": "_siglookup"}, {"address": {"type": "absolute", "value": 4217468}, "name": "_raise"}, {"address": {"type": "absolute", "value": 4217887}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4217902}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4217917}, "name": "__onexit_nolock"}, {"address": {"type": "absolute", "value": 4218099}, "name": "___onexitinit"}, {"address": {"type": "absolute", "value": 4218148}, "name": "__onexit"}, {"address": {"type": "absolute", "value": 4218208}, "name": "_atexit"}, {"address": {"type": "absolute", "value": 4218231}, "name": "__initp_misc_cfltcvt_tab"}, {"address": {"type": "absolute", "value": 4218272}, "name": "__ValidateImageBase"}, {"address": {"type": "absolute", "value": 4218336}, "name": "__FindPESection"}, {"address": {"type": "absolute", "value": 4218416}, "name": "__IsNonwritableInCurrentImage"}, {"address": {"type": "absolute", "value": 4218968}, "name": "_wcscat_s"}, {"address": {"type": "absolute", "value": 4219085}, "name": "_wcsncpy_s"}, {"address": {"type": "absolute", "value": 4219290}, "name": "_wcslen"}, {"address": {"type": "absolute", "value": 4219317}, "name": "_wcscpy_s"}, {"address": {"type": "absolute", "value": 4219416}, "name": "__set_error_mode"}, {"address": {"type": "absolute", "value": 4219479}, "name": "?x_ismbbtype_l@@YAHPAUlocaleinfo_struct@@IHH@Z"}, {"address": {"type": "absolute", "value": 4219562}, "name": "__ismbblead"}, {"address": {"type": "absolute", "value": 4219600}, "name": "__local_unwind4"}, {"address": {"type": "absolute", "value": 4219744}, "name": "__unwind_handler4"}, {"address": {"type": "absolute", "value": 4219842}, "name": "@_EH4_CallFilterFunc@8"}, {"address": {"type": "absolute", "value": 4219865}, "name": "@_EH4_TransferToHandler@8"}, {"address": {"type": "absolute", "value": 4219890}, "name": "@_EH4_GlobalUnwind2@8"}, {"address": {"type": "absolute", "value": 4219915}, "name": "@_EH4_LocalUnwind@16"}, {"address": {"type": "absolute", "value": 4220140}, "name": "__calloc_impl"}, {"address": {"type": "absolute", "value": 4220270}, "name": "_realloc"}, {"address": {"type": "absolute", "value": 4220702}, "name": "_abort"}, {"address": {"type": "absolute", "value": 4220753}, "name": "?"}, {"address": {"type": "absolute", "value": 4220816}, "name": "__global_unwind2"}, {"address": {"type": "absolute", "value": 4220848}, "name": "__unwind_handler"}, {"address": {"type": "absolute", "value": 4220917}, "name": "__local_unwind2"}, {"address": {"type": "absolute", "value": 4221083}, "name": "_at_done"}, {"address": {"type": "absolute", "value": 4221093}, "name": "__NLG_Notify"}, {"address": {"type": "absolute", "value": 4221124}, "name": "__NLG_Call"}, {"address": {"type": "absolute", "value": 4221136}, "name": "___ascii_strnicmp"}]}}, "rules": {"encode data using XOR": {"meta": {"name": "encode data using XOR", "namespace": "data-manipulation/encoding/xor", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Encoding-Standard Algorithm"], "objective": "Defense Evasion", "behavior": "Obfuscated Files or Information", "method": "Encoding-Standard Algorithm", "id": "E1027.m02"}, {"parts": ["Data", "Encode Data", "XOR"], "objective": "Data", "behavior": "Encode Data", "method": "XOR", "id": "C0026.002"}], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403D7E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n", "matches": [[{"type": "absolute", "value": 4199152}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199152}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199203}, {"type": "absolute", "value": 4199189}, {"type": "absolute", "value": 4199231}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 4200976}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201012}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 4200976}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201109}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference absolute stream path on Windows": {"meta": {"name": "reference absolute stream path on Windows", "namespace": "host-interaction/file-system", "authors": ["blas.kojusner@mandiant.com", "william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [], "references": ["https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"], "examples": ["51828683DC26BFABD3994494099AE97D:0x11A9"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n", "matches": [[{"type": "absolute", "value": 4200976}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201104}], "captures": {"C:\\Users\\All Users\\msd": [{"type": "absolute", "value": 4201104}]}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 4203058}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203156}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203198}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203341}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203416}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203416}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4198400}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198480}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198592}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198640}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199024}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199024}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199152}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200304}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200304}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212763}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212763}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212801}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212801}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 4198400}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198451}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198457}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198592}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198887}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198893}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199456}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199561}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199594}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201200}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201297}, {"type": "absolute", "value": 4201315}, {"type": "absolute", "value": 4201374}, {"type": "absolute", "value": 4201445}, {"type": "absolute", "value": 4201334}, {"type": "absolute", "value": 4201278}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201376}, {"type": "absolute", "value": 4201315}, {"type": "absolute", "value": 4201445}, {"type": "absolute", "value": 4201447}, {"type": "absolute", "value": 4201278}, {"type": "absolute", "value": 4201297}, {"type": "absolute", "value": 4201334}, {"type": "absolute", "value": 4201336}, {"type": "absolute", "value": 4201374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201504}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201692}, {"type": "absolute", "value": 4201724}, {"type": "absolute", "value": 4201614}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201698}, {"type": "absolute", "value": 4201730}, {"type": "absolute", "value": 4201620}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201808}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201889}, {"type": "absolute", "value": 4202178}, {"type": "absolute", "value": 4202340}, {"type": "absolute", "value": 4202300}, {"type": "absolute", "value": 4202152}, {"type": "absolute", "value": 4202249}, {"type": "absolute", "value": 4201870}, {"type": "absolute", "value": 4202321}, {"type": "absolute", "value": 4201907}, {"type": "absolute", "value": 4202012}, {"type": "absolute", "value": 4202076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202178}, {"type": "absolute", "value": 4202180}, {"type": "absolute", "value": 4202439}, {"type": "absolute", "value": 4202249}, {"type": "absolute", "value": 4202251}, {"type": "absolute", "value": 4201870}, {"type": "absolute", "value": 4202321}, {"type": "absolute", "value": 4202012}, {"type": "absolute", "value": 4202076}, {"type": "absolute", "value": 4202078}, {"type": "absolute", "value": 4202014}, {"type": "absolute", "value": 4201889}, {"type": "absolute", "value": 4202340}, {"type": "absolute", "value": 4202152}, {"type": "absolute", "value": 4202154}, {"type": "absolute", "value": 4202606}, {"type": "absolute", "value": 4201907}, {"type": "absolute", "value": 4202490}, {"type": "absolute", "value": 4202300}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202314}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202688}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202817}, {"type": "absolute", "value": 4202979}, {"type": "absolute", "value": 4202758}, {"type": "absolute", "value": 4202854}, {"type": "absolute", "value": 4202923}, {"type": "absolute", "value": 4202796}, {"type": "absolute", "value": 4202960}, {"type": "absolute", "value": 4202898}, {"type": "absolute", "value": 4202740}, {"type": "absolute", "value": 4202836}, {"type": "absolute", "value": 4202873}, {"type": "absolute", "value": 4202942}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202817}, {"type": "absolute", "value": 4202885}, {"type": "absolute", "value": 4202758}, {"type": "absolute", "value": 4202760}, {"type": "absolute", "value": 4202960}, {"type": "absolute", "value": 4202898}, {"type": "absolute", "value": 4202836}, {"type": "absolute", "value": 4202910}, {"type": "absolute", "value": 4202721}, {"type": "absolute", "value": 4202979}, {"type": "absolute", "value": 4202854}, {"type": "absolute", "value": 4202923}, {"type": "absolute", "value": 4202796}, {"type": "absolute", "value": 4202798}, {"type": "absolute", "value": 4202740}, {"type": "absolute", "value": 4202873}, {"type": "absolute", "value": 4202942}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202721}, {"type": "absolute", "value": 4202885}, {"type": "absolute", "value": 4202910}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4218604}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218721}, {"type": "absolute", "value": 4218753}, {"type": "absolute", "value": 4218691}, {"type": "absolute", "value": 4218737}, {"type": "absolute", "value": 4218773}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218753}, {"type": "absolute", "value": 4218691}, {"type": "absolute", "value": 4218756}, {"type": "absolute", "value": 4218820}, {"type": "absolute", "value": 4218883}, {"type": "absolute", "value": 4218947}, {"type": "absolute", "value": 4218889}, {"type": "absolute", "value": 4218832}, {"type": "absolute", "value": 4218708}, {"type": "absolute", "value": 4218773}, {"type": "absolute", "value": 4218776}, {"type": "absolute", "value": 4218909}, {"type": "absolute", "value": 4218721}, {"type": "absolute", "value": 4218851}, {"type": "absolute", "value": 4218724}, {"type": "absolute", "value": 4218918}, {"type": "absolute", "value": 4218737}, {"type": "absolute", "value": 4218929}, {"type": "absolute", "value": 4218740}, {"type": "absolute", "value": 4218810}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218663}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 4200976}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201099}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201109}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201097}, {"type": "absolute", "value": 4201093}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201140}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 4200976}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201012}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200976}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201043}, {"type": "absolute", "value": 4201084}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link many functions at runtime": {"meta": {"name": "link many functions at runtime", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["b7b5e1253710d8927cbe07d52d2d2e10:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n", "matches": [[{"type": "absolute", "value": 4201200}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "link function at runtime on Windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201297}, {"type": "absolute", "value": 4201315}, {"type": "absolute", "value": 4201374}, {"type": "absolute", "value": 4201445}, {"type": "absolute", "value": 4201334}, {"type": "absolute", "value": 4201278}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201376}, {"type": "absolute", "value": 4201315}, {"type": "absolute", "value": 4201445}, {"type": "absolute", "value": 4201447}, {"type": "absolute", "value": 4201278}, {"type": "absolute", "value": 4201297}, {"type": "absolute", "value": 4201334}, {"type": "absolute", "value": 4201336}, {"type": "absolute", "value": 4201374}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201200}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4201297}, {"type": "absolute", "value": 4201315}, {"type": "absolute", "value": 4201374}, {"type": "absolute", "value": 4201445}, {"type": "absolute", "value": 4201334}, {"type": "absolute", "value": 4201278}], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "link function at runtime on Linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlvsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201808}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "link function at runtime on Windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201889}, {"type": "absolute", "value": 4202178}, {"type": "absolute", "value": 4202340}, {"type": "absolute", "value": 4202300}, {"type": "absolute", "value": 4202152}, {"type": "absolute", "value": 4202249}, {"type": "absolute", "value": 4201870}, {"type": "absolute", "value": 4202321}, {"type": "absolute", "value": 4201907}, {"type": "absolute", "value": 4202012}, {"type": "absolute", "value": 4202076}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202178}, {"type": "absolute", "value": 4202180}, {"type": "absolute", "value": 4202439}, {"type": "absolute", "value": 4202249}, {"type": "absolute", "value": 4202251}, {"type": "absolute", "value": 4201870}, {"type": "absolute", "value": 4202321}, {"type": "absolute", "value": 4202012}, {"type": "absolute", "value": 4202076}, {"type": "absolute", "value": 4202078}, {"type": "absolute", "value": 4202014}, {"type": "absolute", "value": 4201889}, {"type": "absolute", "value": 4202340}, {"type": "absolute", "value": 4202152}, {"type": "absolute", "value": 4202154}, {"type": "absolute", "value": 4202606}, {"type": "absolute", "value": 4201907}, {"type": "absolute", "value": 4202490}, {"type": "absolute", "value": 4202300}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202314}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201808}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4201889}, {"type": "absolute", "value": 4202178}, {"type": "absolute", "value": 4202340}, {"type": "absolute", "value": 4202300}, {"type": "absolute", "value": 4202152}, {"type": "absolute", "value": 4202249}, {"type": "absolute", "value": 4201870}, {"type": "absolute", "value": 4202321}, {"type": "absolute", "value": 4201907}, {"type": "absolute", "value": 4202012}, {"type": "absolute", "value": 4202076}], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "link function at runtime on Linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlvsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202688}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "link function at runtime on Windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202817}, {"type": "absolute", "value": 4202979}, {"type": "absolute", "value": 4202758}, {"type": "absolute", "value": 4202854}, {"type": "absolute", "value": 4202923}, {"type": "absolute", "value": 4202796}, {"type": "absolute", "value": 4202960}, {"type": "absolute", "value": 4202898}, {"type": "absolute", "value": 4202740}, {"type": "absolute", "value": 4202836}, {"type": "absolute", "value": 4202873}, {"type": "absolute", "value": 4202942}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202817}, {"type": "absolute", "value": 4202885}, {"type": "absolute", "value": 4202758}, {"type": "absolute", "value": 4202760}, {"type": "absolute", "value": 4202960}, {"type": "absolute", "value": 4202898}, {"type": "absolute", "value": 4202836}, {"type": "absolute", "value": 4202910}, {"type": "absolute", "value": 4202721}, {"type": "absolute", "value": 4202979}, {"type": "absolute", "value": 4202854}, {"type": "absolute", "value": 4202923}, {"type": "absolute", "value": 4202796}, {"type": "absolute", "value": 4202798}, {"type": "absolute", "value": 4202740}, {"type": "absolute", "value": 4202873}, {"type": "absolute", "value": 4202942}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202721}, {"type": "absolute", "value": 4202885}, {"type": "absolute", "value": 4202910}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4202688}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4202817}, {"type": "absolute", "value": 4202979}, {"type": "absolute", "value": 4202758}, {"type": "absolute", "value": 4202854}, {"type": "absolute", "value": 4202923}, {"type": "absolute", "value": 4202796}, {"type": "absolute", "value": 4202960}, {"type": "absolute", "value": 4202898}, {"type": "absolute", "value": 4202740}, {"type": "absolute", "value": 4202836}, {"type": "absolute", "value": 4202873}, {"type": "absolute", "value": 4202942}], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "link function at runtime on Linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlvsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4218604}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "link function at runtime on Windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218721}, {"type": "absolute", "value": 4218753}, {"type": "absolute", "value": 4218691}, {"type": "absolute", "value": 4218737}, {"type": "absolute", "value": 4218773}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218753}, {"type": "absolute", "value": 4218691}, {"type": "absolute", "value": 4218756}, {"type": "absolute", "value": 4218820}, {"type": "absolute", "value": 4218883}, {"type": "absolute", "value": 4218947}, {"type": "absolute", "value": 4218889}, {"type": "absolute", "value": 4218832}, {"type": "absolute", "value": 4218708}, {"type": "absolute", "value": 4218773}, {"type": "absolute", "value": 4218776}, {"type": "absolute", "value": 4218909}, {"type": "absolute", "value": 4218721}, {"type": "absolute", "value": 4218851}, {"type": "absolute", "value": 4218724}, {"type": "absolute", "value": 4218918}, {"type": "absolute", "value": 4218737}, {"type": "absolute", "value": 4218929}, {"type": "absolute", "value": 4218740}, {"type": "absolute", "value": 4218810}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4218663}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4218604}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4218721}, {"type": "absolute", "value": 4218753}, {"type": "absolute", "value": 4218691}, {"type": "absolute", "value": 4218737}, {"type": "absolute", "value": 4218773}], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "link function at runtime on Linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlvsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 4203442}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204294}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate thread local storage": {"meta": {"name": "allocate thread local storage", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Allocate Thread Local Storage"], "objective": "Process", "behavior": "Allocate Thread Local Storage", "method": "", "id": "C0040"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n", "matches": [[{"type": "absolute", "value": 4206958}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TlsAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206958}], "captures": {}}], "locations": [], "captures": {}}]]}}}
