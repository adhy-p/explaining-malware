{"meta": {"timestamp": "2023-04-04T14:57:40.588948", "version": "5.0.0", "argv": ["-j", "../inputs//ecaa720616f3a2ebaa138c50e2ee086f1a6380b5bd87603c5af4c9f1666c70a1"], "sample": {"md5": "9eeae870f22350694eb2e7a4852dbb7d", "sha1": "85ab7b97621037f52b8ec4bb583982a69c0ac965", "sha256": "ecaa720616f3a2ebaa138c50e2ee086f1a6380b5bd87603c5af4c9f1666c70a1", "path": "../inputs/ecaa720616f3a2ebaa138c50e2ee086f1a6380b5bd87603c5af4c9f1666c70a1"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/Desktop/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4198400}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198400}}, {"address": {"type": "absolute", "value": 4198458}}, {"address": {"type": "absolute", "value": 4198493}}, {"address": {"type": "absolute", "value": 4198530}}]}, {"address": {"type": "absolute", "value": 4198552}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198552}}, {"address": {"type": "absolute", "value": 4198630}}, {"address": {"type": "absolute", "value": 4198669}}]}, {"address": {"type": "absolute", "value": 4198687}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198687}}, {"address": {"type": "absolute", "value": 4198910}}]}, {"address": {"type": "absolute", "value": 4199030}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199030}}, {"address": {"type": "absolute", "value": 4199142}}, {"address": {"type": "absolute", "value": 4199200}}, {"address": {"type": "absolute", "value": 4199302}}]}, {"address": {"type": "absolute", "value": 4199318}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199318}}, {"address": {"type": "absolute", "value": 4199419}}, {"address": {"type": "absolute", "value": 4199461}}, {"address": {"type": "absolute", "value": 4199478}}, {"address": {"type": "absolute", "value": 4199511}}, {"address": {"type": "absolute", "value": 4199645}}]}, {"address": {"type": "absolute", "value": 4199763}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199793}}]}, {"address": {"type": "absolute", "value": 4199824}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199824}}, {"address": {"type": "absolute", "value": 4200014}}, {"address": {"type": "absolute", "value": 4200140}}, {"address": {"type": "absolute", "value": 4200157}}, {"address": {"type": "absolute", "value": 4200194}}, {"address": {"type": "absolute", "value": 4200547}}]}, {"address": {"type": "absolute", "value": 4200695}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200695}}, {"address": {"type": "absolute", "value": 4200973}}, {"address": {"type": "absolute", "value": 4201029}}, {"address": {"type": "absolute", "value": 4201143}}, {"address": {"type": "absolute", "value": 4201307}}, {"address": {"type": "absolute", "value": 4201421}}, {"address": {"type": "absolute", "value": 4201460}}, {"address": {"type": "absolute", "value": 4201620}}, {"address": {"type": "absolute", "value": 4201676}}, {"address": {"type": "absolute", "value": 4201733}}, {"address": {"type": "absolute", "value": 4201789}}, {"address": {"type": "absolute", "value": 4201827}}]}, {"address": {"type": "absolute", "value": 4201871}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201871}}, {"address": {"type": "absolute", "value": 4201963}}, {"address": {"type": "absolute", "value": 4202268}}]}, {"address": {"type": "absolute", "value": 4202291}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202291}}]}, {"address": {"type": "absolute", "value": 4202432}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202485}}, {"address": {"type": "absolute", "value": 4202542}}]}, {"address": {"type": "absolute", "value": 4202605}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202656}}, {"address": {"type": "absolute", "value": 4202678}}, {"address": {"type": "absolute", "value": 4202725}}, {"address": {"type": "absolute", "value": 4202815}}, {"address": {"type": "absolute", "value": 4202858}}]}, {"address": {"type": "absolute", "value": 4202900}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202900}}, {"address": {"type": "absolute", "value": 4203048}}, {"address": {"type": "absolute", "value": 4203121}}]}, {"address": {"type": "absolute", "value": 4203233}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203316}}, {"address": {"type": "absolute", "value": 4203457}}, {"address": {"type": "absolute", "value": 4203532}}]}, {"address": {"type": "absolute", "value": 4203581}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203581}}, {"address": {"type": "absolute", "value": 4203749}}, {"address": {"type": "absolute", "value": 4203813}}, {"address": {"type": "absolute", "value": 4203939}}, {"address": {"type": "absolute", "value": 4204301}}, {"address": {"type": "absolute", "value": 4204413}}, {"address": {"type": "absolute", "value": 4204462}}, {"address": {"type": "absolute", "value": 4204506}}]}, {"address": {"type": "absolute", "value": 4204533}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204533}}, {"address": {"type": "absolute", "value": 4204686}}, {"address": {"type": "absolute", "value": 4204702}}, {"address": {"type": "absolute", "value": 4204846}}, {"address": {"type": "absolute", "value": 4205012}}]}, {"address": {"type": "absolute", "value": 4205107}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205107}}, {"address": {"type": "absolute", "value": 4205147}}, {"address": {"type": "absolute", "value": 4205202}}]}, {"address": {"type": "absolute", "value": 4205246}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205246}}, {"address": {"type": "absolute", "value": 4205408}}]}, {"address": {"type": "absolute", "value": 4205449}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205567}}, {"address": {"type": "absolute", "value": 4205591}}]}, {"address": {"type": "absolute", "value": 4205780}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205911}}, {"address": {"type": "absolute", "value": 4206016}}]}, {"address": {"type": "absolute", "value": 4206084}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206084}}, {"address": {"type": "absolute", "value": 4206280}}]}, {"address": {"type": "absolute", "value": 4206315}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206403}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206465}}, {"address": {"type": "absolute", "value": 4206509}}]}, {"address": {"type": "absolute", "value": 4206564}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206612}}]}, {"address": {"type": "absolute", "value": 4206628}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206704}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4206790}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4206790}}, {"address": {"type": "absolute", "value": 4206917}}, {"address": {"type": "absolute", "value": 4206941}}, {"address": {"type": "absolute", "value": 4206976}}, {"address": {"type": "absolute", "value": 4207260}}, {"address": {"type": "absolute", "value": 4207807}}, {"address": {"type": "absolute", "value": 4207968}}, {"address": {"type": "absolute", "value": 4208157}}, {"address": {"type": "absolute", "value": 4208329}}, {"address": {"type": "absolute", "value": 4208400}}, {"address": {"type": "absolute", "value": 4208579}}, {"address": {"type": "absolute", "value": 4208692}}, {"address": {"type": "absolute", "value": 4208724}}]}, {"address": {"type": "absolute", "value": 4208783}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4208845}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4208845}}, {"address": {"type": "absolute", "value": 4208936}}, {"address": {"type": "absolute", "value": 4209040}}, {"address": {"type": "absolute", "value": 4209132}}]}, {"address": {"type": "absolute", "value": 4209197}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209197}}, {"address": {"type": "absolute", "value": 4209312}}, {"address": {"type": "absolute", "value": 4209414}}, {"address": {"type": "absolute", "value": 4209478}}, {"address": {"type": "absolute", "value": 4209596}}]}, {"address": {"type": "absolute", "value": 4209680}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209743}}]}, {"address": {"type": "absolute", "value": 4209834}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4209922}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4209990}}]}, {"address": {"type": "absolute", "value": 4210127}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4210175}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4210175}}, {"address": {"type": "absolute", "value": 4210211}}, {"address": {"type": "absolute", "value": 4210302}}, {"address": {"type": "absolute", "value": 4210327}}, {"address": {"type": "absolute", "value": 4210685}}, {"address": {"type": "absolute", "value": 4210831}}, {"address": {"type": "absolute", "value": 4210897}}, {"address": {"type": "absolute", "value": 4211000}}, {"address": {"type": "absolute", "value": 4211049}}, {"address": {"type": "absolute", "value": 4211086}}, {"address": {"type": "absolute", "value": 4211162}}]}, {"address": {"type": "absolute", "value": 4211179}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211179}}, {"address": {"type": "absolute", "value": 4211262}}]}, {"address": {"type": "absolute", "value": 4211517}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211594}}, {"address": {"type": "absolute", "value": 4211631}}]}, {"address": {"type": "absolute", "value": 4211704}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4211771}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211771}}]}, {"address": {"type": "absolute", "value": 4211856}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211868}}, {"address": {"type": "absolute", "value": 4211933}}, {"address": {"type": "absolute", "value": 4211940}}]}, {"address": {"type": "absolute", "value": 4211968}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4211980}}]}, {"address": {"type": "absolute", "value": 4212064}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212064}}]}, {"address": {"type": "absolute", "value": 4212144}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212144}}, {"address": {"type": "absolute", "value": 4212516}}, {"address": {"type": "absolute", "value": 4212526}}, {"address": {"type": "absolute", "value": 4212546}}]}, {"address": {"type": "absolute", "value": 4212560}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212608}}]}, {"address": {"type": "absolute", "value": 4212672}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212672}}, {"address": {"type": "absolute", "value": 4212793}}]}, {"address": {"type": "absolute", "value": 4212816}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212816}}]}, {"address": {"type": "absolute", "value": 4212848}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212848}}, {"address": {"type": "absolute", "value": 4212860}}]}, {"address": {"type": "absolute", "value": 4212912}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4212951}}, {"address": {"type": "absolute", "value": 4212983}}]}, {"address": {"type": "absolute", "value": 4213008}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213138}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213144}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213424}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213560}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213744}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213792}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4213954}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4214096}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4214096}}]}, {"address": {"type": "absolute", "value": 4215100}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215106}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215112}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215118}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215124}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215136}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215142}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215148}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215154}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215160}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215166}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215172}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215178}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4224040}}]}, {"address": {"type": "absolute", "value": 4215193}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215328}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215385}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215598}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215680}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215805}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4215997}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216083}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216139}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216209}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216218}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216432}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216566}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216588}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216608}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4216900}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217093}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217279}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217289}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4217289}}]}, {"address": {"type": "absolute", "value": 4217312}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217834}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217974}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4217984}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218013}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218031}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218080}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218125}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218403}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218447}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218765}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218771}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4218986}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219105}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219218}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219221}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219229}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219642}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219742}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219752}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4219890}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220013}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220023}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220104}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220346}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220440}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220566}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220592}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4220698}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4220698}}]}, {"address": {"type": "absolute", "value": 4220732}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221072}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221092}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221130}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221134}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221155}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221165}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4221191}}, {"address": {"type": "absolute", "value": 4221220}}]}, {"address": {"type": "absolute", "value": 4221321}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4221321}}]}, {"address": {"type": "absolute", "value": 4221340}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221362}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221410}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221451}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221494}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221518}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221527}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221536}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221565}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221601}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4221734}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222010}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222013}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222034}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4222034}}]}, {"address": {"type": "absolute", "value": 4222056}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222078}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222093}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222108}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222186}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222290}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222362}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222519}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222524}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222571}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222580}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4222589}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223144}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223170}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223465}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223488}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223809}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4223832}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4224011}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4224040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4224040}}]}, {"address": {"type": "absolute", "value": 4224302}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4224349}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4224449}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4224852}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225004}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225007}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225016}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225140}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225625}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4225978}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226035}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226065}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226394}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226537}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226690}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226752}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226858}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226870}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226984}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4226993}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227107}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227116}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227168}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227229}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227436}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227442}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227451}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227460}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227581}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227607}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227886}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227889}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227898}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227901}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4227910}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228307}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228584}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228599}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228895}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228933}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4228999}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229018}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229037}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229072}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229428}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229479}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229517}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4229594}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232562}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232610}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232772}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232795}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232981}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4232990}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4233041}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4233089}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4233879}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4234055}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4234319}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4235056}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4235800}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4235869}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4235904}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4236300}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4236727}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4236784}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4236799}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237054}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237613}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237656}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237662}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237839}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237871}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237936}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4237986}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4238046}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4238093}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4238806}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239106}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239109}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239120}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239264}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239362}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239385}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239410}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239431}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239436}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239459}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4239758}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241232}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241475}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241485}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241535}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241664}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241786}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4241818}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4242751}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4242820}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4242876}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4242895}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243104}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243256}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243300}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243336}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243652}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243688}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243728}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243812}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4243973}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244129}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244324}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244334}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244383}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244956}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244960}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4244979}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245096}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4245157}}, {"address": {"type": "absolute", "value": 4245241}}]}, {"address": {"type": "absolute", "value": 4245306}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245328}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245440}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245552}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245691}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245778}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245810}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245832}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245851}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4245893}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4249922}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4249988}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4250002}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4250003}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4250355}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4250450}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4250672}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251082}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251269}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251580}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4251608}}]}, {"address": {"type": "absolute", "value": 4251618}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4251646}}]}, {"address": {"type": "absolute", "value": 4251656}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251787}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251806}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4251962}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252014}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252200}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252249}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252303}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252309}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252332}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252368}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252432}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252512}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252651}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252671}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252701}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252733}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252737}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252758}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252775}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252805}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252860}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4252873}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253239}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253245}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253305}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253320}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253335}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253350}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253383}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253406}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4253446}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4255289}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4255350}}, {"address": {"type": "absolute", "value": 4255434}}]}, {"address": {"type": "absolute", "value": 4255499}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4255509}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4255724}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256112}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256248}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256256}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256698}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256764}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256833}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256909}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4256987}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257069}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257474}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257543}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257685}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257808}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4257878}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258059}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258176}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258240}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258373}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258644}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258654}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258727}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4258827}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259191}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259232}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259392}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259544}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259588}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259624}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259688}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259940}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4259976}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260016}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260100}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260261}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4260261}}]}, {"address": {"type": "absolute", "value": 4260622}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260704}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260756}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260906}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4260915}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4262738}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4262769}}, {"address": {"type": "absolute", "value": 4262831}}]}, {"address": {"type": "absolute", "value": 4262891}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4262896}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4262942}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4262942}}]}, {"address": {"type": "absolute", "value": 4262974}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263336}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263364}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263396}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263465}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263631}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263641}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263672}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263675}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263804}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4263938}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264057}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264203}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264208}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264217}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264256}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264461}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264467}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264657}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264666}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264753}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264896}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264925}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264953}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4264976}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265074}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265087}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265160}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265644}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265779}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4265967}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266006}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266087}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266133}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266219}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266267}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266348}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266635}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266914}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4266940}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267023}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267047}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267193}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267201}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267210}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267219}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267498}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267696}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267739}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267986}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4267991}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4268025}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4268148}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4268586}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4268774}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4268789}}]}, {"address": {"type": "absolute", "value": 4268831}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4268831}}]}, {"address": {"type": "absolute", "value": 4268862}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4268908}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 4614, "functions": [{"address": {"type": "absolute", "value": 4198400}, "count": 64}, {"address": {"type": "absolute", "value": 4198552}, "count": 54}, {"address": {"type": "absolute", "value": 4198687}, "count": 81}, {"address": {"type": "absolute", "value": 4199030}, "count": 104}, {"address": {"type": "absolute", "value": 4199318}, "count": 91}, {"address": {"type": "absolute", "value": 4199763}, "count": 52}, {"address": {"type": "absolute", "value": 4199824}, "count": 168}, {"address": {"type": "absolute", "value": 4200695}, "count": 181}, {"address": {"type": "absolute", "value": 4201871}, "count": 93}, {"address": {"type": "absolute", "value": 4202291}, "count": 45}, {"address": {"type": "absolute", "value": 4202432}, "count": 41}, {"address": {"type": "absolute", "value": 4202605}, "count": 71}, {"address": {"type": "absolute", "value": 4202900}, "count": 59}, {"address": {"type": "absolute", "value": 4203233}, "count": 85}, {"address": {"type": "absolute", "value": 4203581}, "count": 124}, {"address": {"type": "absolute", "value": 4204533}, "count": 123}, {"address": {"type": "absolute", "value": 4205107}, "count": 51}, {"address": {"type": "absolute", "value": 4205246}, "count": 43}, {"address": {"type": "absolute", "value": 4205449}, "count": 76}, {"address": {"type": "absolute", "value": 4205780}, "count": 52}, {"address": {"type": "absolute", "value": 4206084}, "count": 42}, {"address": {"type": "absolute", "value": 4206315}, "count": 13}, {"address": {"type": "absolute", "value": 4206403}, "count": 62}, {"address": {"type": "absolute", "value": 4206564}, "count": 32}, {"address": {"type": "absolute", "value": 4206628}, "count": 28}, {"address": {"type": "absolute", "value": 4206704}, "count": 36}, {"address": {"type": "absolute", "value": 4206790}, "count": 287}, {"address": {"type": "absolute", "value": 4208783}, "count": 28}, {"address": {"type": "absolute", "value": 4208845}, "count": 73}, {"address": {"type": "absolute", "value": 4209197}, "count": 91}, {"address": {"type": "absolute", "value": 4209680}, "count": 63}, {"address": {"type": "absolute", "value": 4209834}, "count": 44}, {"address": {"type": "absolute", "value": 4209922}, "count": 87}, {"address": {"type": "absolute", "value": 4210127}, "count": 32}, {"address": {"type": "absolute", "value": 4210175}, "count": 140}, {"address": {"type": "absolute", "value": 4211179}, "count": 61}, {"address": {"type": "absolute", "value": 4211517}, "count": 65}, {"address": {"type": "absolute", "value": 4211704}, "count": 41}, {"address": {"type": "absolute", "value": 4211771}, "count": 24}, {"address": {"type": "absolute", "value": 4211856}, "count": 42}, {"address": {"type": "absolute", "value": 4211968}, "count": 32}, {"address": {"type": "absolute", "value": 4212064}, "count": 15}, {"address": {"type": "absolute", "value": 4212144}, "count": 85}, {"address": {"type": "absolute", "value": 4212560}, "count": 44}, {"address": {"type": "absolute", "value": 4212672}, "count": 61}, {"address": {"type": "absolute", "value": 4212816}, "count": 25}, {"address": {"type": "absolute", "value": 4212848}, "count": 43}, {"address": {"type": "absolute", "value": 4212912}, "count": 36}, {"address": {"type": "absolute", "value": 4213144}, "count": 13}, {"address": {"type": "absolute", "value": 4213424}, "count": 23}, {"address": {"type": "absolute", "value": 4213560}, "count": 12}, {"address": {"type": "absolute", "value": 4213744}, "count": 30}, {"address": {"type": "absolute", "value": 4213792}, "count": 27}, {"address": {"type": "absolute", "value": 4213954}, "count": 27}, {"address": {"type": "absolute", "value": 4214096}, "count": 12}, {"address": {"type": "absolute", "value": 4215100}, "count": 7}, {"address": {"type": "absolute", "value": 4215106}, "count": 7}, {"address": {"type": "absolute", "value": 4215112}, "count": 7}, {"address": {"type": "absolute", "value": 4215118}, "count": 7}, {"address": {"type": "absolute", "value": 4215124}, "count": 7}, {"address": {"type": "absolute", "value": 4215130}, "count": 7}, {"address": {"type": "absolute", "value": 4215136}, "count": 7}, {"address": {"type": "absolute", "value": 4215142}, "count": 7}, {"address": {"type": "absolute", "value": 4215148}, "count": 7}, {"address": {"type": "absolute", "value": 4215154}, "count": 7}, {"address": {"type": "absolute", "value": 4215160}, "count": 7}, {"address": {"type": "absolute", "value": 4215166}, "count": 7}, {"address": {"type": "absolute", "value": 4215172}, "count": 7}, {"address": {"type": "absolute", "value": 4215178}, "count": 47}, {"address": {"type": "absolute", "value": 4216083}, "count": 14}, {"address": {"type": "absolute", "value": 4216209}, "count": 14}, {"address": {"type": "absolute", "value": 4217279}, "count": 12}, {"address": {"type": "absolute", "value": 4217289}, "count": 17}, {"address": {"type": "absolute", "value": 4217974}, "count": 12}, {"address": {"type": "absolute", "value": 4218765}, "count": 14}, {"address": {"type": "absolute", "value": 4218771}, "count": 14}, {"address": {"type": "absolute", "value": 4219218}, "count": 12}, {"address": {"type": "absolute", "value": 4219221}, "count": 12}, {"address": {"type": "absolute", "value": 4219742}, "count": 12}, {"address": {"type": "absolute", "value": 4220013}, "count": 12}, {"address": {"type": "absolute", "value": 4220698}, "count": 19}, {"address": {"type": "absolute", "value": 4221072}, "count": 14}, {"address": {"type": "absolute", "value": 4221092}, "count": 24}, {"address": {"type": "absolute", "value": 4221130}, "count": 7}, {"address": {"type": "absolute", "value": 4221134}, "count": 12}, {"address": {"type": "absolute", "value": 4221165}, "count": 49}, {"address": {"type": "absolute", "value": 4221321}, "count": 20}, {"address": {"type": "absolute", "value": 4222010}, "count": 23}, {"address": {"type": "absolute", "value": 4222013}, "count": 22}, {"address": {"type": "absolute", "value": 4222034}, "count": 17}, {"address": {"type": "absolute", "value": 4222519}, "count": 15}, {"address": {"type": "absolute", "value": 4222524}, "count": 15}, {"address": {"type": "absolute", "value": 4222571}, "count": 14}, {"address": {"type": "absolute", "value": 4222580}, "count": 14}, {"address": {"type": "absolute", "value": 4225004}, "count": 14}, {"address": {"type": "absolute", "value": 4226858}, "count": 15}, {"address": {"type": "absolute", "value": 4227107}, "count": 11}, {"address": {"type": "absolute", "value": 4227436}, "count": 16}, {"address": {"type": "absolute", "value": 4227451}, "count": 14}, {"address": {"type": "absolute", "value": 4227886}, "count": 14}, {"address": {"type": "absolute", "value": 4227898}, "count": 14}, {"address": {"type": "absolute", "value": 4227901}, "count": 14}, {"address": {"type": "absolute", "value": 4232981}, "count": 14}, {"address": {"type": "absolute", "value": 4235869}, "count": 12}, {"address": {"type": "absolute", "value": 4237656}, "count": 8}, {"address": {"type": "absolute", "value": 4239106}, "count": 14}, {"address": {"type": "absolute", "value": 4239109}, "count": 14}, {"address": {"type": "absolute", "value": 4239410}, "count": 16}, {"address": {"type": "absolute", "value": 4241475}, "count": 12}, {"address": {"type": "absolute", "value": 4244324}, "count": 12}, {"address": {"type": "absolute", "value": 4244956}, "count": 7}, {"address": {"type": "absolute", "value": 4244960}, "count": 13}, {"address": {"type": "absolute", "value": 4245096}, "count": 68}, {"address": {"type": "absolute", "value": 4245306}, "count": 12}, {"address": {"type": "absolute", "value": 4249988}, "count": 12}, {"address": {"type": "absolute", "value": 4250002}, "count": 6}, {"address": {"type": "absolute", "value": 4251580}, "count": 26}, {"address": {"type": "absolute", "value": 4251618}, "count": 25}, {"address": {"type": "absolute", "value": 4251787}, "count": 10}, {"address": {"type": "absolute", "value": 4252303}, "count": 10}, {"address": {"type": "absolute", "value": 4252651}, "count": 13}, {"address": {"type": "absolute", "value": 4252671}, "count": 13}, {"address": {"type": "absolute", "value": 4252733}, "count": 7}, {"address": {"type": "absolute", "value": 4252737}, "count": 9}, {"address": {"type": "absolute", "value": 4252758}, "count": 14}, {"address": {"type": "absolute", "value": 4252775}, "count": 9}, {"address": {"type": "absolute", "value": 4252860}, "count": 12}, {"address": {"type": "absolute", "value": 4253239}, "count": 21}, {"address": {"type": "absolute", "value": 4253245}, "count": 21}, {"address": {"type": "absolute", "value": 4253383}, "count": 13}, {"address": {"type": "absolute", "value": 4253406}, "count": 22}, {"address": {"type": "absolute", "value": 4255289}, "count": 68}, {"address": {"type": "absolute", "value": 4255499}, "count": 12}, {"address": {"type": "absolute", "value": 4255724}, "count": 12}, {"address": {"type": "absolute", "value": 4256248}, "count": 9}, {"address": {"type": "absolute", "value": 4258644}, "count": 12}, {"address": {"type": "absolute", "value": 4260261}, "count": 60}, {"address": {"type": "absolute", "value": 4260906}, "count": 14}, {"address": {"type": "absolute", "value": 4262738}, "count": 46}, {"address": {"type": "absolute", "value": 4262891}, "count": 33}, {"address": {"type": "absolute", "value": 4262896}, "count": 33}, {"address": {"type": "absolute", "value": 4262942}, "count": 15}, {"address": {"type": "absolute", "value": 4264203}, "count": 15}, {"address": {"type": "absolute", "value": 4264208}, "count": 14}, {"address": {"type": "absolute", "value": 4264461}, "count": 14}, {"address": {"type": "absolute", "value": 4264467}, "count": 14}, {"address": {"type": "absolute", "value": 4264657}, "count": 14}, {"address": {"type": "absolute", "value": 4264925}, "count": 16}, {"address": {"type": "absolute", "value": 4264953}, "count": 13}, {"address": {"type": "absolute", "value": 4265074}, "count": 10}, {"address": {"type": "absolute", "value": 4267193}, "count": 15}, {"address": {"type": "absolute", "value": 4267201}, "count": 14}, {"address": {"type": "absolute", "value": 4267986}, "count": 15}, {"address": {"type": "absolute", "value": 4267991}, "count": 14}, {"address": {"type": "absolute", "value": 4268774}, "count": 26}, {"address": {"type": "absolute", "value": 4268831}, "count": 21}, {"address": {"type": "absolute", "value": 4268908}, "count": 7}]}, "library_functions": [{"address": {"type": "absolute", "value": 4213008}, "name": "?DumpThisThread@__vcasan@@YAKPAPAUEXCEPTION_SANITIZER_ERROR@1@PBG@Z"}, {"address": {"type": "absolute", "value": 4213138}, "name": "?"}, {"address": {"type": "absolute", "value": 4215193}, "name": "??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z"}, {"address": {"type": "absolute", "value": 4215328}, "name": "___ascii_stricmp"}, {"address": {"type": "absolute", "value": 4215385}, "name": "__stricmp_l"}, {"address": {"type": "absolute", "value": 4215598}, "name": "__stricmp"}, {"address": {"type": "absolute", "value": 4215680}, "name": "_sprintf"}, {"address": {"type": "absolute", "value": 4215805}, "name": "_strncmp"}, {"address": {"type": "absolute", "value": 4215997}, "name": "_free"}, {"address": {"type": "absolute", "value": 4216139}, "name": "_V6_HeapAlloc"}, {"address": {"type": "absolute", "value": 4216218}, "name": "_malloc"}, {"address": {"type": "absolute", "value": 4216432}, "name": "_strstr"}, {"address": {"type": "absolute", "value": 4216566}, "name": "_atol"}, {"address": {"type": "absolute", "value": 4216588}, "name": "_atoi"}, {"address": {"type": "absolute", "value": 4216608}, "name": "_strncpy"}, {"address": {"type": "absolute", "value": 4216900}, "name": "_strtok"}, {"address": {"type": "absolute", "value": 4217093}, "name": "__fsopen"}, {"address": {"type": "absolute", "value": 4217312}, "name": "__fread_nolock_s"}, {"address": {"type": "absolute", "value": 4217834}, "name": "_fread_s"}, {"address": {"type": "absolute", "value": 4217984}, "name": "_fread"}, {"address": {"type": "absolute", "value": 4218013}, "name": "_srand"}, {"address": {"type": "absolute", "value": 4218031}, "name": "_rand"}, {"address": {"type": "absolute", "value": 4218080}, "name": "_strrchr"}, {"address": {"type": "absolute", "value": 4218125}, "name": "__toupper_l"}, {"address": {"type": "absolute", "value": 4218403}, "name": "_toupper"}, {"address": {"type": "absolute", "value": 4218447}, "name": "_realloc"}, {"address": {"type": "absolute", "value": 4218986}, "name": "__fclose_nolock"}, {"address": {"type": "absolute", "value": 4219105}, "name": "_fclose"}, {"address": {"type": "absolute", "value": 4219229}, "name": "__ftell_nolock"}, {"address": {"type": "absolute", "value": 4219642}, "name": "_ftell"}, {"address": {"type": "absolute", "value": 4219752}, "name": "__fseek_nolock"}, {"address": {"type": "absolute", "value": 4219890}, "name": "_fseek"}, {"address": {"type": "absolute", "value": 4220023}, "name": "__time64"}, {"address": {"type": "absolute", "value": 4220104}, "name": "__strnicmp_l"}, {"address": {"type": "absolute", "value": 4220346}, "name": "__strnicmp"}, {"address": {"type": "absolute", "value": 4220440}, "name": "__vsprintf_l"}, {"address": {"type": "absolute", "value": 4220566}, "name": "_vsprintf"}, {"address": {"type": "absolute", "value": 4220592}, "name": "_vscan_fn"}, {"address": {"type": "absolute", "value": 4220732}, "name": "_fast_error_exit"}, {"address": {"type": "absolute", "value": 4221155}, "name": "_mainCRTStartup"}, {"address": {"type": "absolute", "value": 4221340}, "name": "__get_printf_count_output"}, {"address": {"type": "absolute", "value": 4221362}, "name": "__crt_waiting_on_module_handle"}, {"address": {"type": "absolute", "value": 4221410}, "name": "__amsg_exit"}, {"address": {"type": "absolute", "value": 4221451}, "name": "___crtCorExitProcess"}, {"address": {"type": "absolute", "value": 4221494}, "name": "___crtExitProcess"}, {"address": {"type": "absolute", "value": 4221518}, "name": "__lockexit"}, {"address": {"type": "absolute", "value": 4221527}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4221536}, "name": "__initterm"}, {"address": {"type": "absolute", "value": 4221565}, "name": "__initterm_e"}, {"address": {"type": "absolute", "value": 4221601}, "name": "__cinit"}, {"address": {"type": "absolute", "value": 4221734}, "name": "_doexit"}, {"address": {"type": "absolute", "value": 4222056}, "name": "__exit"}, {"address": {"type": "absolute", "value": 4222078}, "name": "__cexit"}, {"address": {"type": "absolute", "value": 4222093}, "name": "__c_exit"}, {"address": {"type": "absolute", "value": 4222108}, "name": "__init_pointers"}, {"address": {"type": "absolute", "value": 4222186}, "name": "__flush"}, {"address": {"type": "absolute", "value": 4222290}, "name": "__fflush_nolock"}, {"address": {"type": "absolute", "value": 4222362}, "name": "_flsall"}, {"address": {"type": "absolute", "value": 4222589}, "name": "__mbsnbicmp_l"}, {"address": {"type": "absolute", "value": 4223144}, "name": "__mbsnbicmp"}, {"address": {"type": "absolute", "value": 4223170}, "name": "__mbscmp_l"}, {"address": {"type": "absolute", "value": 4223465}, "name": "__mbscmp"}, {"address": {"type": "absolute", "value": 4223488}, "name": "__mbsstr_l"}, {"address": {"type": "absolute", "value": 4223809}, "name": "__mbsstr"}, {"address": {"type": "absolute", "value": 4223832}, "name": "__vsnprintf_l"}, {"address": {"type": "absolute", "value": 4224011}, "name": "__vsnprintf"}, {"address": {"type": "absolute", "value": 4224040}, "name": "___report_gsfailure"}, {"address": {"type": "absolute", "value": 4224302}, "name": "?CPtoLCID@@YAHH@Z"}, {"address": {"type": "absolute", "value": 4224349}, "name": "?setSBCS@@YAXPAUthreadmbcinfostruct@@@Z"}, {"address": {"type": "absolute", "value": 4224449}, "name": "?setSBUpLow@@YAXPAUthreadmbcinfostruct@@@Z"}, {"address": {"type": "absolute", "value": 4224852}, "name": "___updatetmbcinfo"}, {"address": {"type": "absolute", "value": 4225007}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4225016}, "name": "?getSystemCP@@YAHH@Z"}, {"address": {"type": "absolute", "value": 4225140}, "name": "__setmbcp_nolock"}, {"address": {"type": "absolute", "value": 4225625}, "name": "__setmbcp"}, {"address": {"type": "absolute", "value": 4225978}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4226035}, "name": "___initmbctable"}, {"address": {"type": "absolute", "value": 4226065}, "name": "___freetlocinfo"}, {"address": {"type": "absolute", "value": 4226394}, "name": "___addlocaleref"}, {"address": {"type": "absolute", "value": 4226537}, "name": "___removelocaleref"}, {"address": {"type": "absolute", "value": 4226690}, "name": "__updatetlocinfoEx_nolock"}, {"address": {"type": "absolute", "value": 4226752}, "name": "___updatetlocinfo"}, {"address": {"type": "absolute", "value": 4226870}, "name": "__encode_pointer"}, {"address": {"type": "absolute", "value": 4226984}, "name": "__encoded_null"}, {"address": {"type": "absolute", "value": 4226993}, "name": "__decode_pointer"}, {"address": {"type": "absolute", "value": 4227116}, "name": "___set_flsgetvalue"}, {"address": {"type": "absolute", "value": 4227168}, "name": "__mtterm"}, {"address": {"type": "absolute", "value": 4227229}, "name": "__initptd"}, {"address": {"type": "absolute", "value": 4227442}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4227460}, "name": "__getptd_noexit"}, {"address": {"type": "absolute", "value": 4227581}, "name": "__getptd"}, {"address": {"type": "absolute", "value": 4227607}, "name": "__freefls@4"}, {"address": {"type": "absolute", "value": 4227889}, "name": "__unlockexit"}, {"address": {"type": "absolute", "value": 4227910}, "name": "__mtinit"}, {"address": {"type": "absolute", "value": 4228307}, "name": "__tolower_l"}, {"address": {"type": "absolute", "value": 4228584}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4228599}, "name": "__invoke_watson"}, {"address": {"type": "absolute", "value": 4228895}, "name": "__invalid_parameter"}, {"address": {"type": "absolute", "value": 4228933}, "name": "__get_errno_from_oserr"}, {"address": {"type": "absolute", "value": 4228999}, "name": "__errno"}, {"address": {"type": "absolute", "value": 4229018}, "name": "___doserrno"}, {"address": {"type": "absolute", "value": 4229037}, "name": "__dosmaperr"}, {"address": {"type": "absolute", "value": 4229072}, "name": "__flsbuf"}, {"address": {"type": "absolute", "value": 4229428}, "name": "_write_char"}, {"address": {"type": "absolute", "value": 4229479}, "name": "_write_multi_char"}, {"address": {"type": "absolute", "value": 4229517}, "name": "_write_string"}, {"address": {"type": "absolute", "value": 4229594}, "name": "__output_l"}, {"address": {"type": "absolute", "value": 4232562}, "name": "__heap_init"}, {"address": {"type": "absolute", "value": 4232610}, "name": "__mtinitlocks"}, {"address": {"type": "absolute", "value": 4232772}, "name": "__unlock"}, {"address": {"type": "absolute", "value": 4232795}, "name": "__mtinitlocknum"}, {"address": {"type": "absolute", "value": 4232990}, "name": "__lock"}, {"address": {"type": "absolute", "value": 4233041}, "name": "___sbh_find_block"}, {"address": {"type": "absolute", "value": 4233089}, "name": "___sbh_free_block"}, {"address": {"type": "absolute", "value": 4233879}, "name": "___sbh_alloc_new_region"}, {"address": {"type": "absolute", "value": 4234055}, "name": "___sbh_alloc_new_group"}, {"address": {"type": "absolute", "value": 4234319}, "name": "___sbh_resize_block"}, {"address": {"type": "absolute", "value": 4235056}, "name": "___sbh_alloc_block"}, {"address": {"type": "absolute", "value": 4235800}, "name": "__SEH_prolog4"}, {"address": {"type": "absolute", "value": 4235904}, "name": "__except_handler4"}, {"address": {"type": "absolute", "value": 4236300}, "name": "__NMSG_WRITE"}, {"address": {"type": "absolute", "value": 4236727}, "name": "__FF_MSGBANNER"}, {"address": {"type": "absolute", "value": 4236784}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4236799}, "name": "__callnewh"}, {"address": {"type": "absolute", "value": 4237054}, "name": "?strtoxl@@YAKPAUlocaleinfo_struct@@PBDPAPBDHH@Z"}, {"address": {"type": "absolute", "value": 4237613}, "name": "_strtol"}, {"address": {"type": "absolute", "value": 4237662}, "name": "___initstdio"}, {"address": {"type": "absolute", "value": 4237839}, "name": "___endstdio"}, {"address": {"type": "absolute", "value": 4237871}, "name": "__lock_file"}, {"address": {"type": "absolute", "value": 4237936}, "name": "__lock_file2"}, {"address": {"type": "absolute", "value": 4237986}, "name": "__unlock_file"}, {"address": {"type": "absolute", "value": 4238046}, "name": "__unlock_file2"}, {"address": {"type": "absolute", "value": 4238093}, "name": "__openfile"}, {"address": {"type": "absolute", "value": 4238806}, "name": "__getstream"}, {"address": {"type": "absolute", "value": 4239120}, "name": "__local_unwind4"}, {"address": {"type": "absolute", "value": 4239264}, "name": "__unwind_handler4"}, {"address": {"type": "absolute", "value": 4239362}, "name": "@_EH4_CallFilterFunc@8"}, {"address": {"type": "absolute", "value": 4239385}, "name": "@_EH4_TransferToHandler@8"}, {"address": {"type": "absolute", "value": 4239431}, "name": "ReturnPoint"}, {"address": {"type": "absolute", "value": 4239436}, "name": "@_EH4_LocalUnwind@16"}, {"address": {"type": "absolute", "value": 4239459}, "name": "__filbuf"}, {"address": {"type": "absolute", "value": 4239758}, "name": "__read_nolock"}, {"address": {"type": "absolute", "value": 4241232}, "name": "__read"}, {"address": {"type": "absolute", "value": 4241485}, "name": "__fileno"}, {"address": {"type": "absolute", "value": 4241535}, "name": "_memcpy_s"}, {"address": {"type": "absolute", "value": 4241664}, "name": "_memset"}, {"address": {"type": "absolute", "value": 4241786}, "name": "__freea"}, {"address": {"type": "absolute", "value": 4241818}, "name": "?__crtLCMapStringA_stat@@YAHPAUlocaleinfo_struct@@KKPBDHPADHHH@Z"}, {"address": {"type": "absolute", "value": 4242751}, "name": "___crtLCMapStringA"}, {"address": {"type": "absolute", "value": 4242820}, "name": "__isleadbyte_l"}, {"address": {"type": "absolute", "value": 4242876}, "name": "_isleadbyte"}, {"address": {"type": "absolute", "value": 4242895}, "name": "__isctype_l"}, {"address": {"type": "absolute", "value": 4243104}, "name": "?"}, {"address": {"type": "absolute", "value": 4243256}, "name": "?"}, {"address": {"type": "absolute", "value": 4243300}, "name": "?"}, {"address": {"type": "absolute", "value": 4243336}, "name": "?"}, {"address": {"type": "absolute", "value": 4243400}, "name": "?"}, {"address": {"type": "absolute", "value": 4243652}, "name": "?"}, {"address": {"type": "absolute", "value": 4243688}, "name": "?"}, {"address": {"type": "absolute", "value": 4243728}, "name": "?"}, {"address": {"type": "absolute", "value": 4243812}, "name": "?"}, {"address": {"type": "absolute", "value": 4243973}, "name": "__close_nolock"}, {"address": {"type": "absolute", "value": 4244129}, "name": "__close"}, {"address": {"type": "absolute", "value": 4244334}, "name": "__freebuf"}, {"address": {"type": "absolute", "value": 4244383}, "name": "__ioinit"}, {"address": {"type": "absolute", "value": 4244979}, "name": "__lseek_nolock"}, {"address": {"type": "absolute", "value": 4245328}, "name": "__aulldiv"}, {"address": {"type": "absolute", "value": 4245440}, "name": "___ascii_strnicmp"}, {"address": {"type": "absolute", "value": 4245552}, "name": "_strlen"}, {"address": {"type": "absolute", "value": 4245691}, "name": "___check_float_string"}, {"address": {"type": "absolute", "value": 4245778}, "name": "__hextodec"}, {"address": {"type": "absolute", "value": 4245810}, "name": "__inc"}, {"address": {"type": "absolute", "value": 4245832}, "name": "__un_inc"}, {"address": {"type": "absolute", "value": 4245851}, "name": "__whiteout"}, {"address": {"type": "absolute", "value": 4245893}, "name": "__input_l"}, {"address": {"type": "absolute", "value": 4249922}, "name": "?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z"}, {"address": {"type": "absolute", "value": 4250003}, "name": "__XcptFilter"}, {"address": {"type": "absolute", "value": 4250355}, "name": "__wincmdln"}, {"address": {"type": "absolute", "value": 4250450}, "name": "__setenvp"}, {"address": {"type": "absolute", "value": 4250672}, "name": "_parse_cmdline"}, {"address": {"type": "absolute", "value": 4251082}, "name": "__setargv"}, {"address": {"type": "absolute", "value": 4251269}, "name": "___crtGetEnvironmentStringsA"}, {"address": {"type": "absolute", "value": 4251656}, "name": "___security_init_cookie"}, {"address": {"type": "absolute", "value": 4251806}, "name": "__stbuf"}, {"address": {"type": "absolute", "value": 4251962}, "name": "__ftbuf"}, {"address": {"type": "absolute", "value": 4252014}, "name": "__onexit_nolock"}, {"address": {"type": "absolute", "value": 4252200}, "name": "___onexitinit"}, {"address": {"type": "absolute", "value": 4252249}, "name": "__onexit"}, {"address": {"type": "absolute", "value": 4252309}, "name": "_atexit"}, {"address": {"type": "absolute", "value": 4252332}, "name": "__initp_misc_cfltcvt_tab"}, {"address": {"type": "absolute", "value": 4252368}, "name": "__ValidateImageBase"}, {"address": {"type": "absolute", "value": 4252432}, "name": "__FindPESection"}, {"address": {"type": "absolute", "value": 4252512}, "name": "__IsNonwritableInCurrentImage"}, {"address": {"type": "absolute", "value": 4252701}, "name": "?terminate@@YAXXZ"}, {"address": {"type": "absolute", "value": 4252805}, "name": "_siglookup"}, {"address": {"type": "absolute", "value": 4252873}, "name": "?"}, {"address": {"type": "absolute", "value": 4253305}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4253320}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4253335}, "name": "?AFXSetTopLevelFrame@@YAXPAVCFrameWnd@@@Z"}, {"address": {"type": "absolute", "value": 4253350}, "name": "___crtInitCritSecAndSpinCount"}, {"address": {"type": "absolute", "value": 4253446}, "name": "__write_nolock"}, {"address": {"type": "absolute", "value": 4255509}, "name": "__commit"}, {"address": {"type": "absolute", "value": 4256112}, "name": "_strcmp"}, {"address": {"type": "absolute", "value": 4256256}, "name": "?__crtGetStringTypeA_stat@@YAHPAUlocaleinfo_struct@@KPBDHPAGHHH@Z"}, {"address": {"type": "absolute", "value": 4256698}, "name": "___crtGetStringTypeA"}, {"address": {"type": "absolute", "value": 4256764}, "name": "?"}, {"address": {"type": "absolute", "value": 4256833}, "name": "?"}, {"address": {"type": "absolute", "value": 4256909}, "name": "?"}, {"address": {"type": "absolute", "value": 4256987}, "name": "?"}, {"address": {"type": "absolute", "value": 4257069}, "name": "___free_lc_time"}, {"address": {"type": "absolute", "value": 4257474}, "name": "___free_lconv_num"}, {"address": {"type": "absolute", "value": 4257543}, "name": "___free_lconv_mon"}, {"address": {"type": "absolute", "value": 4257685}, "name": "_strcat_s"}, {"address": {"type": "absolute", "value": 4257808}, "name": "_strcspn"}, {"address": {"type": "absolute", "value": 4257878}, "name": "_strncpy_s"}, {"address": {"type": "absolute", "value": 4258059}, "name": "_strcpy_s"}, {"address": {"type": "absolute", "value": 4258176}, "name": "_strpbrk"}, {"address": {"type": "absolute", "value": 4258240}, "name": "__lseeki64_nolock"}, {"address": {"type": "absolute", "value": 4258373}, "name": "__lseeki64"}, {"address": {"type": "absolute", "value": 4258654}, "name": "__getbuf"}, {"address": {"type": "absolute", "value": 4258727}, "name": "__isatty"}, {"address": {"type": "absolute", "value": 4258827}, "name": "__wctomb_s_l"}, {"address": {"type": "absolute", "value": 4259191}, "name": "_wctomb_s"}, {"address": {"type": "absolute", "value": 4259232}, "name": "__aulldvrm"}, {"address": {"type": "absolute", "value": 4259392}, "name": "?"}, {"address": {"type": "absolute", "value": 4259544}, "name": "?"}, {"address": {"type": "absolute", "value": 4259588}, "name": "?"}, {"address": {"type": "absolute", "value": 4259624}, "name": "?"}, {"address": {"type": "absolute", "value": 4259688}, "name": "?"}, {"address": {"type": "absolute", "value": 4259940}, "name": "?"}, {"address": {"type": "absolute", "value": 4259976}, "name": "?"}, {"address": {"type": "absolute", "value": 4260016}, "name": "?"}, {"address": {"type": "absolute", "value": 4260100}, "name": "?"}, {"address": {"type": "absolute", "value": 4260622}, "name": "__set_error_mode"}, {"address": {"type": "absolute", "value": 4260704}, "name": "__allmul"}, {"address": {"type": "absolute", "value": 4260756}, "name": "__fcloseall"}, {"address": {"type": "absolute", "value": 4260915}, "name": "__tsopen_nolock"}, {"address": {"type": "absolute", "value": 4262974}, "name": "__mbsnbcmp_l"}, {"address": {"type": "absolute", "value": 4263336}, "name": "__mbsnbcmp"}, {"address": {"type": "absolute", "value": 4263364}, "name": "__global_unwind2"}, {"address": {"type": "absolute", "value": 4263396}, "name": "__unwind_handler"}, {"address": {"type": "absolute", "value": 4263465}, "name": "__local_unwind2"}, {"address": {"type": "absolute", "value": 4263631}, "name": "_at_done"}, {"address": {"type": "absolute", "value": 4263641}, "name": "__NLG_Notify"}, {"address": {"type": "absolute", "value": 4263672}, "name": "__NLG_Call"}, {"address": {"type": "absolute", "value": 4263675}, "name": "__set_osfhnd"}, {"address": {"type": "absolute", "value": 4263804}, "name": "__free_osfhnd"}, {"address": {"type": "absolute", "value": 4263938}, "name": "__get_osfhandle"}, {"address": {"type": "absolute", "value": 4264057}, "name": "___lock_fhandle"}, {"address": {"type": "absolute", "value": 4264217}, "name": "__unlock_fhandle"}, {"address": {"type": "absolute", "value": 4264256}, "name": "__alloc_osfhnd"}, {"address": {"type": "absolute", "value": 4264666}, "name": "_fastzero_I"}, {"address": {"type": "absolute", "value": 4264753}, "name": "?"}, {"address": {"type": "absolute", "value": 4264896}, "name": "_has_osfxsr_set"}, {"address": {"type": "absolute", "value": 4264976}, "name": "?"}, {"address": {"type": "absolute", "value": 4265087}, "name": "___ansicp"}, {"address": {"type": "absolute", "value": 4265160}, "name": "___convertcp"}, {"address": {"type": "absolute", "value": 4265600}, "name": "__alloca_probe_16"}, {"address": {"type": "absolute", "value": 4265644}, "name": "_fastcopy_I"}, {"address": {"type": "absolute", "value": 4265779}, "name": "?"}, {"address": {"type": "absolute", "value": 4265967}, "name": "?"}, {"address": {"type": "absolute", "value": 4266006}, "name": "__isdigit_l"}, {"address": {"type": "absolute", "value": 4266087}, "name": "_isdigit"}, {"address": {"type": "absolute", "value": 4266133}, "name": "__isxdigit_l"}, {"address": {"type": "absolute", "value": 4266219}, "name": "_isxdigit"}, {"address": {"type": "absolute", "value": 4266267}, "name": "__isspace_l"}, {"address": {"type": "absolute", "value": 4266348}, "name": "_isspace"}, {"address": {"type": "absolute", "value": 4266635}, "name": "__mbtowc_l"}, {"address": {"type": "absolute", "value": 4266914}, "name": "_mbtowc"}, {"address": {"type": "absolute", "value": 4266940}, "name": "?x_ismbbtype_l@@YAHPAUlocaleinfo_struct@@IHH@Z"}, {"address": {"type": "absolute", "value": 4267023}, "name": "__ismbblead"}, {"address": {"type": "absolute", "value": 4267047}, "name": "__msize"}, {"address": {"type": "absolute", "value": 4267210}, "name": "__fptrap"}, {"address": {"type": "absolute", "value": 4267219}, "name": "_abort"}, {"address": {"type": "absolute", "value": 4267498}, "name": "__putwch_nolock"}, {"address": {"type": "absolute", "value": 4267696}, "name": "__alloca_probe"}, {"address": {"type": "absolute", "value": 4267739}, "name": "__calloc_impl"}, {"address": {"type": "absolute", "value": 4268025}, "name": "__recalloc"}, {"address": {"type": "absolute", "value": 4268148}, "name": "__chsize_nolock"}, {"address": {"type": "absolute", "value": 4268586}, "name": "__setmode_nolock"}, {"address": {"type": "absolute", "value": 4268862}, "name": "___termcon"}]}}, "rules": {"encode data using XOR": {"meta": {"name": "encode data using XOR", "namespace": "data-manipulation/encoding/xor", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [{"parts": ["Defense Evasion", "Obfuscated Files or Information"], "tactic": "Defense Evasion", "technique": "Obfuscated Files or Information", "subtechnique": "", "id": "T1027"}], "mbc": [{"parts": ["Defense Evasion", "Obfuscated Files or Information", "Encoding-Standard Algorithm"], "objective": "Defense Evasion", "behavior": "Obfuscated Files or Information", "method": "Encoding-Standard Algorithm", "id": "E1027.m02"}, {"parts": ["Data", "Encode Data", "XOR"], "objective": "Data", "behavior": "Encode Data", "method": "XOR", "id": "C0026.002"}], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403D7E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n", "matches": [[{"type": "absolute", "value": 4199793}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199793}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "nzxor"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199806}], "captures": {}}, {"success": true, "node": {"statement": {"type": "not", "description": "filter for potential false positives"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or", "description": "unsigned bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 4294967295, "description": "bitwise negation for unsigned 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 18446744073709551615, "description": "bitwise negation for unsigned 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "signed bitwise negation operation (~i)"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 268435455, "description": "bitwise negation for signed 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1152921504606846975, "description": "bitwise negation for signed 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or", "description": "Magic constants used in the implementation of strings functions."}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2130640639, "description": "optimized string constant for 32 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326657, "description": "-0x81010101 = 0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2164326656, "description": "0x81010100 = ~0x7EFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9151031864016699135, "description": "optimized string constant for 64 bits"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852481, "description": "-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 9295712209692852480, "description": "0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 4201029}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201077}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202656}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202667}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202678}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202683}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203457}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203472}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203532}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203550}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204301}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204317}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204506}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204511}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204846}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204923}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206612}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206614}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206941}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206957}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208724}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208729}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210211}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210289}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process suspended": {"meta": {"name": "create process suspended", "namespace": "host-interaction/process/create", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process", "Create Suspended Process"], "objective": "Process", "behavior": "Create Process", "method": "Create Suspended Process", "id": "C0017.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process suspended\n    namespace: host-interaction/process/create\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process::Create Suspended Process [C0017.003]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n  features:\n    - and:\n      - or:\n        - number: 0x08000004 = CREATE_NO_WINDOW | CREATE_SUSPENDED\n        - number: 4 = CREATE_SUSPENDED\n      - or:\n        - api: kernel32.CreateProcess\n        - api: advapi32.CreateProcessAsUser\n", "matches": [[{"type": "absolute", "value": 4201029}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 134217732, "description": "CREATE_NO_WINDOW | CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201051}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201064}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 4201029}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201064}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204301}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204306}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204846}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205002}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209132}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209176}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate memory": {"meta": {"name": "allocate memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-03.exe_:0x4010EA", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n", "matches": [[{"type": "absolute", "value": 4201307}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201344}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201620}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201662}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate RW memory": {"meta": {"name": "allocate RW memory", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Memory", "Allocate Memory"], "objective": "Memory", "behavior": "Allocate Memory", "method": "", "id": "C0007"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate RW memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x4 = PAGE_READWRITE\n", "matches": [[{"type": "absolute", "value": 4201307}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "allocate memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAlloc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201344}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualAllocExNuma"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.VirtualProtectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwAllocateVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwMapViewOfSection"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201307}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201323}], "captures": {}}], "locations": [], "captures": {}}]]}, "resume thread": {"meta": {"name": "resume thread", "namespace": "host-interaction/thread/resume", "authors": ["0x534a@mailbox.org", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Resume Thread"], "objective": "Process", "behavior": "Resume Thread", "method": "", "id": "C0054"}], "references": [], "examples": ["Practical Malware Analysis Lab 12-02.exe_:0x4010EA", "787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:0x4044C7"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: resume thread\n    namespace: host-interaction/thread/resume\n    authors:\n      - 0x534a@mailbox.org\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Resume Thread [C0054]\n    examples:\n      - Practical Malware Analysis Lab 12-02.exe_:0x4010EA\n      - 787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:0x4044C7\n  features:\n    - or:\n      - api: kernel32.ResumeThread\n      - api: ntdll.NtResumeThread\n      - api: ntdll.ZwResumeThread\n      - api: System.Threading.Thread::Resume\n", "matches": [[{"type": "absolute", "value": 4201827}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ResumeThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201833}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Resume"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205012}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ResumeThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205071}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Resume"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 4201963}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201991}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205107}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205137}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205147}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get HTTP content length": {"meta": {"name": "get HTTP content length", "namespace": "communication/http", "authors": ["william.ballenthin@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication"], "objective": "Communication", "behavior": "HTTP Communication", "method": "", "id": "C0002"}], "references": [], "examples": ["0596c4ea5aa8def47f22c85d75aaca95:0x1079C70"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get HTTP content length\n    namespace: communication/http\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    mbc:\n      - Communication::HTTP Communication [C0002]\n    examples:\n      - 0596c4ea5aa8def47f22c85d75aaca95:0x1079C70\n  features:\n    - and:\n      - api: wininet.HttpQueryInfo\n      - number: 0x20000005 = HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_CONTENT_LENGTH\n", "matches": [[{"type": "absolute", "value": 4202725}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.HttpQueryInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202740}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 536870917, "description": "HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_CONTENT_LENGTH"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202734}], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 4204702}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204829}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209478}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209498}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209596}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209618}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212860}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212879}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4268831}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4268850}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check for sandbox and av modules": {"meta": {"name": "check for sandbox and av modules", "namespace": "anti-analysis/anti-av", "authors": ["@_re_fox"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}, {"parts": ["Anti-Behavioral Analysis", "Sandbox Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Sandbox Detection", "method": "", "id": "B0007"}], "references": [], "examples": ["ccbf7cba35bab56563c0fbe4237fdc41:0x0040a4a0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check for sandbox and av modules\n    namespace: anti-analysis/anti-av\n    authors:\n      - \"@_re_fox\"\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n      - Anti-Behavioral Analysis::Sandbox Detection [B0007]\n    examples:\n      - ccbf7cba35bab56563c0fbe4237fdc41:0x0040a4a0\n  features:\n    - and:\n      - api: GetModuleHandle\n      - or:\n        - string: /avghook(x|a)\\.dll/i\n          description: AVG\n        - string: /snxhk\\.dll/i\n          description: Avast\n        - string: /sf2\\.dll/i\n          description: Avast\n        - string: /sbiedll\\.dll/i\n          description: Sandboxie\n        - string: /dbghelp\\.dll/i\n          description: WindBG\n        - string: /api_log\\.dll/i\n          description: iDefense Lab\n        - string: /dir_watch\\.dll/i\n          description: iDefense Lab\n        - string: /pstorec\\.dll/i\n          description: SunBelt Sandbox\n        - string: /vmcheck\\.dll/i\n          description: Virtual PC\n        - string: /wpespy\\.dll/i\n          description: WPE Pro\n        - string: /cmdvrt(64|32).dll/i\n          description: Comodo Container\n        - string: /sxin.dll/i\n          description: 360 SOFTWARE\n        - string: /dbghelp\\.dll/i\n          description: WINE\n        - string: /printfhelp\\.dll/i\n          description: Unknown Sandbox\n", "matches": [[{"type": "absolute", "value": 4206280}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206285}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/avghook(x|a)\\.dll/i", "description": "AVG"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/snxhk\\.dll/i", "description": "Avast"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/sf2\\.dll/i", "description": "Avast"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/sbiedll\\.dll/i", "description": "Sandboxie"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206280}], "captures": {"sbieDll.dll": [{"type": "absolute", "value": 4206280}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/dbghelp\\.dll/i", "description": "WindBG"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/api_log\\.dll/i", "description": "iDefense Lab"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/dir_watch\\.dll/i", "description": "iDefense Lab"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/pstorec\\.dll/i", "description": "SunBelt Sandbox"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmcheck\\.dll/i", "description": "Virtual PC"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/wpespy\\.dll/i", "description": "WPE Pro"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/cmdvrt(64|32).dll/i", "description": "Comodo Container"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/sxin.dll/i", "description": "360 SOFTWARE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/dbghelp\\.dll/i", "description": "WINE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/printfhelp\\.dll/i", "description": "Unknown Sandbox"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 4206917}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206929}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210211}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210275}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate thread": {"meta": {"name": "terminate thread", "namespace": "host-interaction/thread/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Terminate Thread"], "objective": "Process", "behavior": "Terminate Thread", "method": "", "id": "C0039"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003286", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate thread\n    namespace: host-interaction/thread/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Terminate Thread [C0039]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003286\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x407E90\n  features:\n    - or:\n      - api: kernel32.TerminateThread\n      - api: PsTerminateSystemThread\n      - api: System.Threading.Thread.Abort\n", "matches": [[{"type": "absolute", "value": 4206941}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206966}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsTerminateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread.Abort"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210302}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210304}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsTerminateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread.Abort"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create TCP socket": {"meta": {"name": "create TCP socket", "namespace": "communication/socket/tcp", "authors": ["william.ballenthin@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Create TCP Socket"], "objective": "Communication", "behavior": "Socket Communication", "method": "Create TCP Socket", "id": "C0001.011"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n      - property/read: System.Net.Sockets.TcpClient::Client\n", "matches": [[{"type": "absolute", "value": 4211631}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Net.Sockets.TcpClient::Client"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 6, "description": "IPPROTO_TCP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211631}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "SOCK_STREAM"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211633}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "AF_INET"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211635}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASocket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file attributes": {"meta": {"name": "get file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Get File Attributes"], "objective": "File System", "behavior": "Get File Attributes", "method": "", "id": "C0049"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x180019824", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 4212816}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212817}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212848}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212849}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "PEB access": {"meta": {"name": "PEB access", "authors": ["michael.hunhoff@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Debugger Detection", "Process Environment Block"], "objective": "Anti-Behavioral Analysis", "behavior": "Debugger Detection", "method": "Process Environment Block", "id": "B0001.019"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"], "examples": ["al-khaser_x86.exe_:0x420D20"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n", "matches": [[{"type": "absolute", "value": 4214096}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "peb access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214096}], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214096}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/92748920e88c4393bed62c8a8991b23d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "arch", "arch": "i386"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "fs access"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214096}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 48}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/6ee4f69365124c8f9e63d2e1667bf49d"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "arch", "arch": "amd64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "gs access"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "offset", "offset": 96}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "PEB access/052a2fb05e4e49829acecc636679fe79"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4198400}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198400}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198451}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198552}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198552}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4198687}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198687}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198854}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199318}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199318}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199451}, {"type": "absolute", "value": 4199598}, {"type": "absolute", "value": 4199655}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199763}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199763}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199793}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199824}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200491}, {"type": "absolute", "value": 4200133}, {"type": "absolute", "value": 4199950}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200695}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200913}, {"type": "absolute", "value": 4200962}, {"type": "absolute", "value": 4201010}, {"type": "absolute", "value": 4200901}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201871}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202256}, {"type": "absolute", "value": 4202084}, {"type": "absolute", "value": 4202181}, {"type": "absolute", "value": 4202201}, {"type": "absolute", "value": 4202218}, {"type": "absolute", "value": 4201947}, {"type": "absolute", "value": 4202110}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202291}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202291}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202605}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202605}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202900}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203074}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203233}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203233}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203402}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203581}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203581}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204264}, {"type": "absolute", "value": 4203780}, {"type": "absolute", "value": 4203797}, {"type": "absolute", "value": 4204373}, {"type": "absolute", "value": 4204389}, {"type": "absolute", "value": 4204248}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205107}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205195}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205246}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205393}, {"type": "absolute", "value": 4205330}, {"type": "absolute", "value": 4205371}, {"type": "absolute", "value": 4205351}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205449}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205481}, {"type": "absolute", "value": 4205498}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205856}, {"type": "absolute", "value": 4205961}, {"type": "absolute", "value": 4205818}, {"type": "absolute", "value": 4205839}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206403}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206403}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206465}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206564}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206564}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206790}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206790}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208096}, {"type": "absolute", "value": 4208455}, {"type": "absolute", "value": 4208649}, {"type": "absolute", "value": 4207466}, {"type": "absolute", "value": 4208522}, {"type": "absolute", "value": 4207152}, {"type": "absolute", "value": 4207797}, {"type": "absolute", "value": 4207606}, {"type": "absolute", "value": 4207130}, {"type": "absolute", "value": 4208539}, {"type": "absolute", "value": 4208668}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208845}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208979}, {"type": "absolute", "value": 4208995}, {"type": "absolute", "value": 4208917}, {"type": "absolute", "value": 4209108}, {"type": "absolute", "value": 4209124}, {"type": "absolute", "value": 4209085}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209197}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209588}, {"type": "absolute", "value": 4209574}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209680}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209808}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209922}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210064}, {"type": "absolute", "value": 4210083}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4210175}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211704}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211704}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212144}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212144}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212560}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212560}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212912}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212912}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212944}, {"type": "absolute", "value": 4212976}, {"type": "absolute", "value": 4212917}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4213954}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213954}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4251580}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4251580}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4251618}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4251618}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get MAC address on Windows": {"meta": {"name": "get MAC address on Windows", "namespace": "collection/network", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["al-khaser_x64.exe_:0x14001A1BC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get MAC address on Windows\n    namespace: collection/network\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - al-khaser_x64.exe_:0x14001A1BC\n  features:\n    - or:\n      - api: System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress\n      - and:\n        - os: windows\n        - api: iphlpapi.GetAdaptersInfo\n        - or:\n          - offset: 0x194 = IP_ADAPTER_INFO.Address\n          - offset: 0x195 = IP_ADAPTER_INFO.Address+1\n          - offset: 0x196 = IP_ADAPTER_INFO.Address+2\n          - offset: 0x197 = IP_ADAPTER_INFO.Address+3\n          - offset: 0x198 = IP_ADAPTER_INFO.Address+4\n          - offset: 0x199 = IP_ADAPTER_INFO.Address+5\n        - optional:\n          - string: \"%02X-%02X-%02X-%02X-%02X-%02X\"\n", "matches": [[{"type": "absolute", "value": 4198687}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "iphlpapi.GetAdaptersInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198747}, {"type": "absolute", "value": 4198774}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "offset", "offset": 404, "description": "IP_ADAPTER_INFO.Address"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198950}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 405, "description": "IP_ADAPTER_INFO.Address+1"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198942}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 406, "description": "IP_ADAPTER_INFO.Address+2"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198934}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 407, "description": "IP_ADAPTER_INFO.Address+3"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198926}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 408, "description": "IP_ADAPTER_INFO.Address+4"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198918}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 409, "description": "IP_ADAPTER_INFO.Address+5"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198910}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "string", "string": "%02X-%02X-%02X-%02X-%02X-%02X"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get local IPv4 addresses": {"meta": {"name": "get local IPv4 addresses", "namespace": "host-interaction/network/address", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Network Configuration Discovery"], "tactic": "Discovery", "technique": "System Network Configuration Discovery", "subtechnique": "", "id": "T1016"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x100037e6", "4C0553285D724DCAF5909924B4E3E90A:0x402010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get local IPv4 addresses\n    namespace: host-interaction/network/address\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x100037e6\n      - 4C0553285D724DCAF5909924B4E3E90A:0x402010\n  features:\n    - or:\n      - api: getsockname\n      - and:\n        - api: GetAdaptersInfo\n        - offset: 0x1B0 = IP_ADAPTER_INFO.IpAddressList.IpAddress\n        # loop feature?\n      - and:\n        - api: GetAdaptersAddresses\n        - optional:\n          - or:\n            - number: 0 = AF_UNSPEC\n            - number: 2 = AF_INET\n            - number: 23 = AF_INET6\n", "matches": [[{"type": "absolute", "value": 4198687}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "getsockname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "GetAdaptersInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198747}, {"type": "absolute", "value": 4198774}], "captures": {}}, {"success": true, "node": {"feature": {"type": "offset", "offset": 432, "description": "IP_ADAPTER_INFO.IpAddressList.IpAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198819}, {"type": "absolute", "value": 4198843}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "GetAdaptersAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 0, "description": "AF_UNSPEC"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198897}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "AF_INET"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 23, "description": "AF_INET6"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 4199030}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199079}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get system information on Windows": {"meta": {"name": "get system information on Windows", "namespace": "host-interaction/os/info", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [], "references": [], "examples": ["563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n", "matches": [[{"type": "absolute", "value": 4199030}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemInfo"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199271}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetNativeSystemInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlGetNativeSystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQuerySystemInformationEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 4199030}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199257}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199283}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199250}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201252}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201275}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201215}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200878}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206790}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208043}, {"type": "absolute", "value": 4207676}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208592}, {"type": "absolute", "value": 4208035}, {"type": "absolute", "value": 4207688}, {"type": "absolute", "value": 4208043}, {"type": "absolute", "value": 4207676}, {"type": "absolute", "value": 4207662}, {"type": "absolute", "value": 4208511}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208035}, {"type": "absolute", "value": 4207662}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4208783}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208808}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208801}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209197}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209279}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209338}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209272}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4213792}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213811}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213838}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4213804}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4260261}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260400}, {"type": "absolute", "value": 4260358}, {"type": "absolute", "value": 4260424}, {"type": "absolute", "value": 4260329}, {"type": "absolute", "value": 4260379}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260546}, {"type": "absolute", "value": 4260578}, {"type": "absolute", "value": 4260611}, {"type": "absolute", "value": 4260358}, {"type": "absolute", "value": 4260486}, {"type": "absolute", "value": 4260424}, {"type": "absolute", "value": 4260329}, {"type": "absolute", "value": 4260400}, {"type": "absolute", "value": 4260505}, {"type": "absolute", "value": 4260379}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260301}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check OS version": {"meta": {"name": "check OS version", "namespace": "host-interaction/os/version", "authors": ["michael.hunhoff@mandiant.com", "johnk3r"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check OS version\n    namespace: host-interaction/os/version\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - and:\n      - match: get OS version\n      - or:\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 5 = Windows 2000\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows XP\n                - number: 2 = Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 6 = Windows Vista / Windows Server 2008\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows Server 2008 R2 / Windows 7\n                - number: 2 = Windows Server 2012 / Windows 8\n                - number: 3 = Windows Server 2012 R2 / Windows 8.1\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 10 = Windows Server 2016 / Windows Server 2019 / Windows 10\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - number: 0\n", "matches": [[{"type": "absolute", "value": 4199030}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "get OS version"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199079}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199030}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check OS version/38a4140538f249cb86269767adcf70d4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows XP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows XP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199177}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows XP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199177}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199156}, {"type": "absolute", "value": 4199116}, {"type": "absolute", "value": 4199177}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199292}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 6, "description": "Windows Vista / Windows Server 2008"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199292}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199292}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows Server 2008 R2 / Windows 7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows Server 2012 / Windows 8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 3, "description": "Windows Server 2012 R2 / Windows 8.1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows Server 2008 R2 / Windows 7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2, "description": "Windows Server 2012 / Windows 8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 3, "description": "Windows Server 2012 R2 / Windows 8.1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199177}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 1, "description": "Windows Server 2008 R2 / Windows 7"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "Windows Server 2012 / Windows 8"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199177}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 3, "description": "Windows Server 2012 R2 / Windows 8.1"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199156}, {"type": "absolute", "value": 4199116}, {"type": "absolute", "value": 4199177}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "check OS version/72626041d71d4fb681dd5502bfac5cdc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199156}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199116}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199156}, {"type": "absolute", "value": 4199116}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 4199318}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199558}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199723}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199515}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199513}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199511}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202291}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202345}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202389}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202315}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202313}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4202291}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get hostname": {"meta": {"name": "get hostname", "namespace": "host-interaction/os/hostname", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "7351f8a40c5450557b24622417fc478d:0x405438"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n", "matches": [[{"type": "absolute", "value": 4199824}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200118}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerNameEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetComputerObjectName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write process memory": {"meta": {"name": "write process memory", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "", "id": "T1055"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x4027CF"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write process memory\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection [T1055]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - or:\n      - api: kernel32.WriteProcessMemory\n      - api: ntdll.NtWriteVirtualMemory\n      - api: ntdll.ZwWriteVirtualMemory\n      - api: NtWow64WriteVirtualMemory64\n", "matches": [[{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201505}, {"type": "absolute", "value": 4201775}, {"type": "absolute", "value": 4201383}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "inspect section memory permissions": {"meta": {"name": "inspect section memory permissions", "namespace": "load-code/pe", "authors": ["@Ana06"], "scope": "function", "attack": [], "mbc": [{"parts": ["Discovery", "Code Discovery", "Inspect Section Memory Permissions"], "objective": "Discovery", "behavior": "Code Discovery", "method": "Inspect Section Memory Permissions", "id": "B0046.002"}], "references": [], "examples": ["E4C33AC3638EEF68311F8AC0D72483C7:0x401480"], "description": "translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n", "matches": [[{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "PAGE_NOACCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201281}, {"type": "absolute", "value": 4201127}, {"type": "absolute", "value": 4201185}, {"type": "absolute", "value": 4200959}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"count": 3, "type": "some"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "IMAGE_SCN_MEM_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201535}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "PAGE_READONLY"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201601}, {"type": "absolute", "value": 4201542}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 536870912, "description": "IMAGE_SCN_MEM_EXECUTE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201566}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 16, "description": "PAGE_EXECUTE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201442}, {"type": "absolute", "value": 4201573}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1610612736, "description": "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "IMAGE_SCN_MEM_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201535}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 536870912, "description": "IMAGE_SCN_MEM_EXECUTE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201566}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 32, "description": "PAGE_EXECUTE_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201610}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 3221225472, "description": "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "IMAGE_SCN_MEM_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201535}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "IMAGE_SCN_MEM_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "PAGE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201323}, {"type": "absolute", "value": 4201556}, {"type": "absolute", "value": 4201734}, {"type": "absolute", "value": 4201144}, {"type": "absolute", "value": 4201051}, {"type": "absolute", "value": 4201580}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 3758096384, "description": "IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "IMAGE_SCN_MEM_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201535}], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "IMAGE_SCN_MEM_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 536870912, "description": "IMAGE_SCN_MEM_EXECUTE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201566}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 64, "description": "PAGE_EXECUTE_READWRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201589}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201289}, {"type": "absolute", "value": 4201195}, {"type": "absolute", "value": 4201135}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4215178}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4224294}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "use process replacement": {"meta": {"name": "use process replacement", "namespace": "host-interaction/process/inject", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [{"parts": ["Defense Evasion", "Process Injection", "Process Hollowing"], "tactic": "Defense Evasion", "technique": "Process Injection", "subtechnique": "Process Hollowing", "id": "T1055.012"}, {"parts": ["Defense Evasion", "Reflective Code Loading"], "tactic": "Defense Evasion", "technique": "Reflective Code Loading", "subtechnique": "", "id": "T1620"}], "mbc": [], "references": ["http://www.autosectools.com/process-hollowing.pdf", "https://www.andreafortuna.org/2017/10/09/understanding-process-hollowing/"], "examples": ["Practical Malware Analysis Lab 12-02.exe_:0x4010EA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: use process replacement\n    namespace: host-interaction/process/inject\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Process Injection::Process Hollowing [T1055.012]\n      - Defense Evasion::Reflective Code Loading [T1620]\n    references:\n      - http://www.autosectools.com/process-hollowing.pdf\n      - https://www.andreafortuna.org/2017/10/09/understanding-process-hollowing/\n    examples:\n      - Practical Malware Analysis Lab 12-02.exe_:0x4010EA\n  features:\n    - and:\n      - match: create process suspended\n      - match: write process memory\n      - match: resume thread\n", "matches": [[{"type": "absolute", "value": 4200695}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create process suspended"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 134217732, "description": "CREATE_NO_WINDOW | CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "CREATE_SUSPENDED"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201051}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201064}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201029}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "write process memory"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteProcessMemory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201505}, {"type": "absolute", "value": 4201775}, {"type": "absolute", "value": 4201383}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwWriteVirtualMemory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWow64WriteVirtualMemory64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4200695}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "resume thread"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ResumeThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201833}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwResumeThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Resume"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201827}], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 4201871}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201991}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201963}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegQueryMultipleValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtEnumerateValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlQueryRegistryValues"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHEnumValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetInt"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHQueryValueEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegEnumUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHOpenRegStream2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegQueryUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create HTTP request": {"meta": {"name": "create HTTP request", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Create Request"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Create Request", "id": "C0002.012"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n", "matches": [[{"type": "absolute", "value": 4202900}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203016}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 4203581}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204346}, {"type": "absolute", "value": 4204221}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206790}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208592}, {"type": "absolute", "value": 4208511}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 4204533}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204817}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204829}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204813}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204906}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4209197}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209618}, {"type": "absolute", "value": 4209498}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209598}, {"type": "absolute", "value": 4209486}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209651}, {"type": "absolute", "value": 4209524}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "move file": {"meta": {"name": "move file", "namespace": "host-interaction/file-system/move", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Move File"], "objective": "File System", "behavior": "Move File", "method": "", "id": "C0063"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n", "matches": [[{"type": "absolute", "value": 4204533}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.MoveFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.MoveFileEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204691}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "MoveFileWithProgress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "MoveFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "rename"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wrename"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::MoveTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Move"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "move file/a251b177a54f4e67ab7feb3d66037c00"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delete file": {"meta": {"name": "delete file", "namespace": "host-interaction/file-system/delete", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Delete File"], "objective": "File System", "behavior": "Delete File", "method": "", "id": "C0047"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x100015F0", "31600AD0D1A7EA615690DF111AE36C73:0x401A15", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n", "matches": [[{"type": "absolute", "value": 4204533}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.DeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DeleteFileTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwDeleteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "remove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_wremove"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileSystemInfo::Delete"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "delete file/d1f6739f255b4ce3a84b18b28b31c517"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 4, "description": "MOVEFILE_DELAY_UNTIL_REBOOT"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204686}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 0, "description": "NULL"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204688}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "MoveFileEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204691}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204686}], "captures": {}}], "locations": [], "captures": {}}]]}, "write and execute a file": {"meta": {"name": "write and execute a file", "namespace": "communication/c2/file-transfer", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Execution", "Install Additional Program"], "objective": "Execution", "behavior": "Install Additional Program", "method": "", "id": "B0023"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403A40", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {"malware_category": "launcher"}}, "source": "rule:\n  meta:\n    name: write and execute a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: launcher\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403A40\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n  features:\n    - and:\n      - match: host-interaction/file-system/write\n      - match: host-interaction/process/create\n", "matches": [[{"type": "absolute", "value": 4204533}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/file-system/write"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204817}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204829}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204813}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204906}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204533}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205002}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204846}], "captures": {}}], "locations": [], "captures": {}}]]}, "set registry value": {"meta": {"name": "set registry value", "namespace": "host-interaction/registry/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Set Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Set Registry Key", "id": "C0036.001"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E", "98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n", "matches": [[{"type": "absolute", "value": 4205107}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "host-interaction/process/create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/add/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "regex", "regex": "/reg(|.exe)/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hklm/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_LOCAL_MACHINE/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/hkcu/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/HKEY_CURRENT_USER/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create or open registry key"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205137}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenCurrentUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegOpenUserClassesRoot"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateKeyTransacted"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegOpenUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegCreateUSKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateRegistryKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4205147}, {"type": "absolute", "value": 4205107}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.RegSetValueEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205217}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.RegSetKeyValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtSetValueKey"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlWriteRegistryValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegSetUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHRegWriteUSValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.Win32.Registry::SetValue"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read file on Windows": {"meta": {"name": "read file on Windows", "namespace": "host-interaction/file-system/read", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Read File"], "objective": "File System", "behavior": "Read File", "method": "", "id": "C0051"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n", "matches": [[{"type": "absolute", "value": 4205449}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205572}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205780}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205920}, {"type": "absolute", "value": 4206025}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4206790}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4208405}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "find graphical window": {"meta": {"name": "find graphical window", "namespace": "host-interaction/gui/window/find", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Application Window Discovery"], "tactic": "Discovery", "technique": "Application Window Discovery", "subtechnique": "", "id": "T1010"}], "mbc": [], "references": [], "examples": ["7C843E75D4F02087B932FE280DF9C90C:0x41B180"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n", "matches": [[{"type": "absolute", "value": 4206564}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "user32.FindWindow"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4206580}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.FindWindowEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "extract resource via kernel32 functions": {"meta": {"name": "extract resource via kernel32 functions", "namespace": "executable/resource", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["BF88E1BD4A3BDE10B419A622278F1FF7:0x401000", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - match: contain a resource (.rsrc) section\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n", "matches": [[{"type": "absolute", "value": 4209197}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.LoadResource"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LockResource"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209360}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "LdrAccessResource"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "contain a resource (.rsrc) section"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209272}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.FindResource"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209298}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FindResourceEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "LdrFindResource_U"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "LdrFindResourceEx_U"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SizeofResource"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209348}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.FreeResource"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect to HTTP server": {"meta": {"name": "connect to HTTP server", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Connect to Server"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Connect to Server", "id": "C0002.009"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: connect to HTTP server\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Connect to Server [C0002.009]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetConnect\n", "matches": [[{"type": "absolute", "value": 4209680}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4209713}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send data on socket": {"meta": {"name": "send data on socket", "namespace": "communication/socket/send", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Send Data"], "objective": "Communication", "behavior": "Socket Communication", "method": "Send Data", "id": "C0001.007"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.send\n      - api: ws2_32.sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: send\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n", "matches": [[{"type": "absolute", "value": 4210175}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211771}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "send data": {"meta": {"name": "send data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Send Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Send Data", "id": "B0030.001"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for sending data to a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n", "matches": [[{"type": "absolute", "value": 4210175}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4210680}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4210175}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211771}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211771}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "create UDP socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "send HTTP request"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "send data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.sendto"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASend"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "send"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211825}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendTo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::SendToAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.UdpClient::Send"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211771}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "send file via HTTP"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data on socket": {"meta": {"name": "receive data on socket", "namespace": "communication/socket/receive", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Receive Data"], "objective": "Communication", "behavior": "Socket Communication", "method": "Receive Data", "id": "C0001.006"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recv\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n", "matches": [[{"type": "absolute", "value": 4211179}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211494}, {"type": "absolute", "value": 4211379}, {"type": "absolute", "value": 4211454}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211494}, {"type": "absolute", "value": 4211379}, {"type": "absolute", "value": 4211454}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211704}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read data from Internet": {"meta": {"name": "read data from Internet", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Get Response"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Get Response", "id": "C0002.017"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40D590"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read data from Internet\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Get Response [C0002.017]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40D590\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: connect to HTTP server\n          - match: connect to URL\n      - or:\n        - api: wininet.InternetReadFile\n        - api: wininet.InternetReadFileEx\n        - api: System.Net.WebClient::DownloadString\n        - api: System.Net.WebClient::DownloadStringAsync\n        - api: System.Net.WebClient::DownloadStringTaskAsync\n        - api: System.Net.WebClient::DownloadData\n        - api: System.Net.WebClient::DownloadDataAsync\n        - api: System.Net.WebClient::DownloadDataTaskAsync\n", "matches": [[{"type": "absolute", "value": 4211179}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211228}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data": {"meta": {"name": "receive data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Receive Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Receive Data", "id": "B0030.002"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for receiving data from a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n", "matches": [[{"type": "absolute", "value": 4211179}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211494}, {"type": "absolute", "value": 4211379}, {"type": "absolute", "value": 4211454}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211494}, {"type": "absolute", "value": 4211379}, {"type": "absolute", "value": 4211454}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211179}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211228}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211179}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4211704}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.recvfrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvDisconnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSARecvMsg"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "recv"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211726}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::Receive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::ReceiveMessageFromAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::BeginReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceive"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.Socket::EndReceiveMessageFrom"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211704}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "initialize Winsock library": {"meta": {"name": "initialize Winsock library", "namespace": "communication/socket", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Initialize Winsock Library"], "objective": "Communication", "behavior": "Socket Communication", "method": "Initialize Winsock Library", "id": "C0001.009"}], "references": [], "examples": ["6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n", "matches": [[{"type": "absolute", "value": 4211517}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.WSAStartup"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211552}], "captures": {}}], "locations": [], "captures": {}}]]}, "resolve DNS": {"meta": {"name": "resolve DNS", "namespace": "communication/dns", "authors": ["william.ballenthin@mandiant.com", "johnk3r", "joakim@intezer.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "DNS Communication", "Resolve"], "objective": "Communication", "behavior": "DNS Communication", "method": "Resolve", "id": "C0011.001"}], "references": [], "examples": ["17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: ws2_32.gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: getaddrinfo\n      - api: GetAddrInfo\n      - api: GetAddrInfoEx\n      - api: gethostbyname\n      - api: getaddrinfo\n      - api: getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n", "matches": [[{"type": "absolute", "value": 4211517}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211585}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_A"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_W"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQuery_UTF8"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "DnsQueryEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAddrInfoEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "gethostbyname"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211585}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getaddrinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "getnameinfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Dns::GetHostAddresses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect TCP socket": {"meta": {"name": "connect TCP socket", "namespace": "communication/socket/tcp", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "Connect Socket"], "objective": "Communication", "behavior": "Socket Communication", "method": "Connect Socket", "id": "C0001.004"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: connect TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Connect Socket [C0001.004]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - match: create TCP socket\n      - or:\n        - api: connect\n        - api: ws2_32.connect\n        - api: ws2_32.WSAConnect\n        - api: ConnectEx\n        - and:\n          - basic block:\n            # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\n            - and:\n              - number: 0x25A207B9\n              - number: 0x4660DDF3\n              - number: 0xE576E98E\n              - number: 0x3E06748C\n          - basic block:\n            - and:\n              - api: WSAIoctl\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n          - basic block:\n            - and:\n              - api: setsockopt\n              - number: 0xFFFF = SOL_SOCKET\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n          # socket must be bound to ConnectEx\n          # https://gist.github.com/joeyadams/4158972\n          - api: bind\n", "matches": [[{"type": "absolute", "value": 4211517}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Net.Sockets.TcpClient::Client"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 6, "description": "IPPROTO_TCP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211631}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "SOCK_STREAM"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211633}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "AF_INET"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211635}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASocket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211631}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "connect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211678}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.connect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211678}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSAConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ConnectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/9242c5c287e24173a445369dcd26c49f"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/ac5555f2b71c46fe8c4dbda2ff3ca5a4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/fc4c1936f10642eaaa23ae2341835ef2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "bind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "act as TCP client": {"meta": {"name": "act as TCP client", "namespace": "communication/tcp/client", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Socket Communication", "TCP Client"], "objective": "Communication", "behavior": "Socket Communication", "method": "TCP Client", "id": "C0001.008"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-01.dll_:0x10001010"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: act as TCP client\n    namespace: communication/tcp/client\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::TCP Client [C0001.008]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - match: connect TCP socket\n      - api: System.Net.Sockets.TcpClient::ctor\n", "matches": [[{"type": "absolute", "value": 4211517}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "connect TCP socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create TCP socket"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Net.Sockets.TcpClient::Client"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 6, "description": "IPPROTO_TCP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211631}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "SOCK_STREAM"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211633}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "AF_INET"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211635}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSASocket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "socket"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211637}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211631}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "connect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211678}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "ws2_32.connect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4211678}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.WSAConnect"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ConnectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/9242c5c287e24173a445369dcd26c49f"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/ac5555f2b71c46fe8c4dbda2ff3ca5a4"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect TCP socket/fc4c1936f10642eaaa23ae2341835ef2"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "bind"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4211517}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.Sockets.TcpClient::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get token membership": {"meta": {"name": "get token membership", "namespace": "host-interaction/session", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Owner/User Discovery"], "tactic": "Discovery", "technique": "System Owner/User Discovery", "subtechnique": "", "id": "T1033"}], "mbc": [], "references": [], "examples": ["mimikatz.exe_:0x40DABE"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get token membership\n    namespace: host-interaction/session\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n    examples:\n      - mimikatz.exe_:0x40DABE\n  features:\n    - and:\n      - api: advapi32.CheckTokenMembership\n      - optional:\n        - api: advapi32.AllocateAndInitializeSid\n        - api: advapi32.FreeSid\n", "matches": [[{"type": "absolute", "value": 4212672}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.CheckTokenMembership"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212764}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.AllocateAndInitializeSid"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212739}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.FreeSid"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212783}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if file exists": {"meta": {"name": "check if file exists", "namespace": "host-interaction/file-system/exists", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["31600AD0D1A7EA615690DF111AE36C73:0x401284"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n", "matches": [[{"type": "absolute", "value": 4212816}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212817}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212825}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212825}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4212825}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4212816}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/f46d6a1ebc034901b1d8493b448eaa88"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4212848}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212849}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212855}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4212855}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4212855}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4212848}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/f46d6a1ebc034901b1d8493b448eaa88"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "allocate thread local storage": {"meta": {"name": "allocate thread local storage", "namespace": "host-interaction/process", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Allocate Thread Local Storage"], "objective": "Process", "behavior": "Allocate Thread Local Storage", "method": "", "id": "C0040"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n", "matches": [[{"type": "absolute", "value": 4227107}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TlsAlloc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4227107}], "captures": {}}], "locations": [], "captures": {}}]]}, "link many functions at runtime": {"meta": {"name": "link many functions at runtime", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com"], "scope": "function", "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["b7b5e1253710d8927cbe07d52d2d2e10:0x401000"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n", "matches": [[{"type": "absolute", "value": 4260261}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "link function at runtime on Windows"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260400}, {"type": "absolute", "value": 4260358}, {"type": "absolute", "value": 4260424}, {"type": "absolute", "value": 4260329}, {"type": "absolute", "value": 4260379}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "indirect call"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260546}, {"type": "absolute", "value": 4260578}, {"type": "absolute", "value": 4260611}, {"type": "absolute", "value": 4260358}, {"type": "absolute", "value": 4260486}, {"type": "absolute", "value": 4260424}, {"type": "absolute", "value": 4260329}, {"type": "absolute", "value": 4260400}, {"type": "absolute", "value": 4260505}, {"type": "absolute", "value": 4260379}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.LoadLibrary"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4260301}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetModuleHandleEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.LdrLoadDll"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4260261}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "kernel32.GetProcAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [{"type": "absolute", "value": 4260400}, {"type": "absolute", "value": 4260358}, {"type": "absolute", "value": 4260424}, {"type": "absolute", "value": 4260329}, {"type": "absolute", "value": 4260379}], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "ntdll.LdrGetProcedureAddress"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "link function at runtime on Linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"min": 5, "max": 9223372036854775808, "child": {"type": "api", "api": "dlvsym"}, "type": "range"}, "type": "statement"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4304896}], "captures": {}}]]}, "reference anti-VM strings targeting VMWare": {"meta": {"name": "reference anti-VM strings targeting VMWare", "namespace": "anti-analysis/anti-vm/vm-detection", "authors": ["michael.hunhoff@mandiant.com", "@johnk3r"], "scope": "file", "attack": [{"parts": ["Defense Evasion", "Virtualization/Sandbox Evasion", "System Checks"], "tactic": "Defense Evasion", "technique": "Virtualization/Sandbox Evasion", "subtechnique": "System Checks", "id": "T1497.001"}], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Virtual Machine Detection"], "objective": "Anti-Behavioral Analysis", "behavior": "Virtual Machine Detection", "method": "", "id": "B0009"}], "references": ["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp"], "examples": ["al-khaser_x86.exe_", "b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "regex", "regex": "/VMWare/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 78180}, {"type": "file", "value": 78132}, {"type": "file", "value": 78148}], "captures": {"VMware": [{"type": "file", "value": 78132}], "VMware Pointing Device": [{"type": "file", "value": 78148}], "VMware VMCI Bus Driver": [{"type": "file", "value": 78180}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VMTools/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmnet\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmusb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dmp\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmci\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmhgfs\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmemctl\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmx86\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmrawdsk\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmkdb\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmnetuserif\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmnetadapter\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\HGFS/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/\\\\\\\\.\\\\vmci/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmtoolsd\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmwaretray\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmwareuser\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VGAuthService\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmacthlp\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmci/i", "description": "VMWare VMCI Bus Driver"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 78180}, {"type": "file", "value": 78172}], "captures": {"vmci": [{"type": "file", "value": 78172}], "VMware VMCI Bus Driver": [{"type": "file", "value": 78180}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmhgfs/i", "description": "VMWare Host Guest Control Redirector"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "regex", "regex": "/vmmouse/i"}, "type": "feature"}, "children": [], "locations": [{"type": "file", "value": 78140}], "captures": {"vmmouse": [{"type": "file", "value": 78140}]}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmemctl/i", "description": "VMWare Guest Memory Controller Driver"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmusb/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmusbmouse/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmx_svga/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmxnet/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmx86/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VMwareVMware/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmGuestLib\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/Applications\\\\VMwareHostOpen\\.exe/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dgl\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmdum\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vm3dver\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmtray\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VMToolsHook\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmmousever\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/VmGuestLibJava\\.dll/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "regex", "regex": "/vmscsi\\.sys/i"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}}}
