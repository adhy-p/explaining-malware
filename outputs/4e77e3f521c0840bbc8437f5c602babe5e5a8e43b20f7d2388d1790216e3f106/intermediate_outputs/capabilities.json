{"meta": {"timestamp": "2023-05-14T14:37:36.405953", "version": "5.0.0", "argv": ["-j", "../inputs//4e77e3f521c0840bbc8437f5c602babe5e5a8e43b20f7d2388d1790216e3f106"], "sample": {"md5": "f904ea9bc8e2d7ce13a6007183da5957", "sha1": "313db2d9812bf393e78d3e08c1bc460b9a2d152d", "sha256": "4e77e3f521c0840bbc8437f5c602babe5e5a8e43b20f7d2388d1790216e3f106", "path": "../inputs/4e77e3f521c0840bbc8437f5c602babe5e5a8e43b20f7d2388d1790216e3f106"}, "analysis": {"format": "pe", "arch": "i386", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/home/adhy/NUS/Y4S2/FYP/explaining-malware/venv/src/flare-capa/rules"], "base_address": {"type": "absolute", "value": 4194304}, "layout": {"functions": [{"address": {"type": "absolute", "value": 4198400}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198428}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198520}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198592}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4198809}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198849}}]}, {"address": {"type": "absolute", "value": 4198878}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4198918}}]}, {"address": {"type": "absolute", "value": 4198971}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199011}}]}, {"address": {"type": "absolute", "value": 4199040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199080}}]}, {"address": {"type": "absolute", "value": 4199109}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199109}}, {"address": {"type": "absolute", "value": 4199131}}, {"address": {"type": "absolute", "value": 4199268}}]}, {"address": {"type": "absolute", "value": 4199311}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4199335}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4199372}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4199430}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4199430}}, {"address": {"type": "absolute", "value": 4199527}}, {"address": {"type": "absolute", "value": 4199620}}, {"address": {"type": "absolute", "value": 4199770}}, {"address": {"type": "absolute", "value": 4199862}}, {"address": {"type": "absolute", "value": 4199898}}, {"address": {"type": "absolute", "value": 4199947}}, {"address": {"type": "absolute", "value": 4200003}}, {"address": {"type": "absolute", "value": 4200011}}, {"address": {"type": "absolute", "value": 4200097}}, {"address": {"type": "absolute", "value": 4200122}}, {"address": {"type": "absolute", "value": 4200160}}, {"address": {"type": "absolute", "value": 4200255}}, {"address": {"type": "absolute", "value": 4200321}}, {"address": {"type": "absolute", "value": 4200432}}, {"address": {"type": "absolute", "value": 4200609}}]}, {"address": {"type": "absolute", "value": 4200810}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4200810}}, {"address": {"type": "absolute", "value": 4200845}}, {"address": {"type": "absolute", "value": 4200918}}, {"address": {"type": "absolute", "value": 4200927}}]}, {"address": {"type": "absolute", "value": 4201008}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4201075}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201188}}]}, {"address": {"type": "absolute", "value": 4201232}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201253}}, {"address": {"type": "absolute", "value": 4201319}}]}, {"address": {"type": "absolute", "value": 4201379}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201429}}, {"address": {"type": "absolute", "value": 4201472}}, {"address": {"type": "absolute", "value": 4201518}}, {"address": {"type": "absolute", "value": 4201531}}]}, {"address": {"type": "absolute", "value": 4201601}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4201601}}, {"address": {"type": "absolute", "value": 4201744}}, {"address": {"type": "absolute", "value": 4201762}}, {"address": {"type": "absolute", "value": 4201802}}, {"address": {"type": "absolute", "value": 4201908}}, {"address": {"type": "absolute", "value": 4201928}}, {"address": {"type": "absolute", "value": 4201993}}, {"address": {"type": "absolute", "value": 4202037}}, {"address": {"type": "absolute", "value": 4202080}}, {"address": {"type": "absolute", "value": 4202103}}, {"address": {"type": "absolute", "value": 4202142}}, {"address": {"type": "absolute", "value": 4202183}}]}, {"address": {"type": "absolute", "value": 4202237}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4202237}}, {"address": {"type": "absolute", "value": 4202294}}, {"address": {"type": "absolute", "value": 4202389}}, {"address": {"type": "absolute", "value": 4202610}}, {"address": {"type": "absolute", "value": 4202706}}, {"address": {"type": "absolute", "value": 4202780}}, {"address": {"type": "absolute", "value": 4202999}}]}, {"address": {"type": "absolute", "value": 4203037}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203037}}, {"address": {"type": "absolute", "value": 4203088}}]}, {"address": {"type": "absolute", "value": 4203389}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4203389}}, {"address": {"type": "absolute", "value": 4203616}}, {"address": {"type": "absolute", "value": 4203696}}, {"address": {"type": "absolute", "value": 4203718}}, {"address": {"type": "absolute", "value": 4203928}}]}, {"address": {"type": "absolute", "value": 4204018}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204032}}, {"address": {"type": "absolute", "value": 4204090}}]}, {"address": {"type": "absolute", "value": 4204123}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204123}}, {"address": {"type": "absolute", "value": 4204177}}]}, {"address": {"type": "absolute", "value": 4204478}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204496}}]}, {"address": {"type": "absolute", "value": 4204540}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4204589}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4204589}}, {"address": {"type": "absolute", "value": 4204617}}, {"address": {"type": "absolute", "value": 4204640}}, {"address": {"type": "absolute", "value": 4204720}}, {"address": {"type": "absolute", "value": 4204845}}, {"address": {"type": "absolute", "value": 4204892}}]}, {"address": {"type": "absolute", "value": 4204947}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 4205009}}, {"address": {"type": "absolute", "value": 4205108}}, {"address": {"type": "absolute", "value": 4205136}}]}, {"address": {"type": "absolute", "value": 4205166}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205172}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205178}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205184}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205190}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205196}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205202}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205208}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205232}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205238}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205244}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205594}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205600}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205606}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205624}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205627}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205634}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205640}, "matched_basic_blocks": []}, {"address": {"type": "absolute", "value": 4205646}, "matched_basic_blocks": []}]}, "feature_counts": {"file": 586, "functions": [{"address": {"type": "absolute", "value": 4198400}, "count": 21}, {"address": {"type": "absolute", "value": 4198428}, "count": 36}, {"address": {"type": "absolute", "value": 4198520}, "count": 28}, {"address": {"type": "absolute", "value": 4198592}, "count": 86}, {"address": {"type": "absolute", "value": 4198809}, "count": 36}, {"address": {"type": "absolute", "value": 4198878}, "count": 53}, {"address": {"type": "absolute", "value": 4198971}, "count": 36}, {"address": {"type": "absolute", "value": 4199040}, "count": 36}, {"address": {"type": "absolute", "value": 4199109}, "count": 73}, {"address": {"type": "absolute", "value": 4199311}, "count": 15}, {"address": {"type": "absolute", "value": 4199335}, "count": 21}, {"address": {"type": "absolute", "value": 4199372}, "count": 29}, {"address": {"type": "absolute", "value": 4199430}, "count": 151}, {"address": {"type": "absolute", "value": 4200810}, "count": 80}, {"address": {"type": "absolute", "value": 4201008}, "count": 36}, {"address": {"type": "absolute", "value": 4201075}, "count": 49}, {"address": {"type": "absolute", "value": 4201232}, "count": 54}, {"address": {"type": "absolute", "value": 4201379}, "count": 59}, {"address": {"type": "absolute", "value": 4201601}, "count": 106}, {"address": {"type": "absolute", "value": 4202237}, "count": 132}, {"address": {"type": "absolute", "value": 4203037}, "count": 80}, {"address": {"type": "absolute", "value": 4203389}, "count": 94}, {"address": {"type": "absolute", "value": 4204018}, "count": 39}, {"address": {"type": "absolute", "value": 4204123}, "count": 80}, {"address": {"type": "absolute", "value": 4204478}, "count": 31}, {"address": {"type": "absolute", "value": 4204540}, "count": 23}, {"address": {"type": "absolute", "value": 4204589}, "count": 67}, {"address": {"type": "absolute", "value": 4204947}, "count": 72}, {"address": {"type": "absolute", "value": 4205166}, "count": 7}, {"address": {"type": "absolute", "value": 4205172}, "count": 7}, {"address": {"type": "absolute", "value": 4205178}, "count": 7}, {"address": {"type": "absolute", "value": 4205184}, "count": 7}, {"address": {"type": "absolute", "value": 4205190}, "count": 7}, {"address": {"type": "absolute", "value": 4205196}, "count": 7}, {"address": {"type": "absolute", "value": 4205202}, "count": 7}, {"address": {"type": "absolute", "value": 4205208}, "count": 7}, {"address": {"type": "absolute", "value": 4205232}, "count": 7}, {"address": {"type": "absolute", "value": 4205238}, "count": 7}, {"address": {"type": "absolute", "value": 4205594}, "count": 7}, {"address": {"type": "absolute", "value": 4205600}, "count": 7}, {"address": {"type": "absolute", "value": 4205624}, "count": 6}, {"address": {"type": "absolute", "value": 4205627}, "count": 6}, {"address": {"type": "absolute", "value": 4205634}, "count": 7}, {"address": {"type": "absolute", "value": 4205640}, "count": 7}, {"address": {"type": "absolute", "value": 4205646}, "count": 7}]}, "library_functions": [{"address": {"type": "absolute", "value": 4205244}, "name": "_WinMainCRTStartup"}, {"address": {"type": "absolute", "value": 4205606}, "name": "__setdefaultprecision"}]}}, "rules": {"delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 4199620}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199636}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199947}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199953}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200255}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200286}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200609}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200630}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201319}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201324}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201472}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201474}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202080}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202092}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202142}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202147}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204032}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204064}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4205136}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "sleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "usleep"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Sleep"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205148}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SleepEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SignalObjectAndWait"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForSingleObjectEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.RegisterWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "WaitOnAddress"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjects"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "user32.MsgWaitForMultipleObjectsEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtDelayExecution"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeWaitForSingleObject"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "KeDelayExecutionThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 4200255}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "os", "os": "linux"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "pthread_create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Threading.Thread::ctor"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateThread"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200275}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_beginthreadex"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "PsCreateSystemThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHCreateThreadWithHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateRemoteThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlCreateUserThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateThreadEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 4200845}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200864}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203616}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203623}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "CreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "IoCreateFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fopen64"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fdopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "freopen"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "open"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "openat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create process on Windows": {"meta": {"name": "create process on Windows", "namespace": "host-interaction/process/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Create Process"], "objective": "Process", "behavior": "Create Process", "method": "", "id": "C0017"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x406DB0", "Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n", "matches": [[{"type": "absolute", "value": 4201253}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201309}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201993}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202019}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202103}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202126}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204177}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204228}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204720}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WinExec"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecute"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.ShellExecuteEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessAsUser"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204801}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithLogon"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateProcessWithToken"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateProcessInternal"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateProcessEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.ZwCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.RtlCreateUserProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Start"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file attributes": {"meta": {"name": "get file attributes", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["File System", "Get File Attributes"], "objective": "File System", "behavior": "Get File Attributes", "method": "", "id": "C0049"}], "references": [], "examples": ["03B236B23B1EC37C663527C1F53AF3FE:0x180019824", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n", "matches": [[{"type": "absolute", "value": 4201744}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201751}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryDirectoryFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtQueryInformationFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetAttributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetCreationTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastAccessTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTime"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::GetLastWriteTimeUtc"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Attributes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "open process": {"meta": {"name": "open process", "authors": ["0x534a@mailbox.org"], "scope": "basic block", "attack": [], "mbc": [{"parts": ["Process", "Open Process"], "objective": "Process", "behavior": "Open Process", "method": "", "id": "C0065"}], "references": [], "examples": ["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n", "matches": [[{"type": "absolute", "value": 4201908}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201915}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203088}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203108}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204617}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204626}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create HTTP request": {"meta": {"name": "create HTTP request", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Create Request"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Create Request", "id": "C0002.012"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n", "matches": [[{"type": "absolute", "value": 4198592}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198608}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "connect to HTTP server": {"meta": {"name": "connect to HTTP server", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Connect to Server"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Connect to Server", "id": "C0002.009"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: connect to HTTP server\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Connect to Server [C0002.009]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetConnect\n", "matches": [[{"type": "absolute", "value": 4198592}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetConnect"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198714}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "create HTTP request"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetCloseHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetOpen"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4198608}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::Create"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateDefault"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebRequest::CreateHttp"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4198592}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 4199109}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199109}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199430}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200518}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4200810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200927}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201008}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201008}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201075}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201075}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201379}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201379}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4202237}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202237}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202610}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203389}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203389}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204947}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204947}], "captures": {}}, {"success": true, "node": {"feature": {"type": "characteristic", "characteristic": "tight loop"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205035}], "captures": {}}, {"success": false, "node": {"feature": {"type": "characteristic", "characteristic": "recursive call"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read data from Internet": {"meta": {"name": "read data from Internet", "namespace": "communication/http/client", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Get Response"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Get Response", "id": "C0002.017"}], "references": [], "examples": ["6f99a2c8944cb02ff28c6f9ced59b161:0x40D590"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read data from Internet\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Get Response [C0002.017]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40D590\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: connect to HTTP server\n          - match: connect to URL\n      - or:\n        - api: wininet.InternetReadFile\n        - api: wininet.InternetReadFileEx\n        - api: System.Net.WebClient::DownloadString\n        - api: System.Net.WebClient::DownloadStringAsync\n        - api: System.Net.WebClient::DownloadStringTaskAsync\n        - api: System.Net.WebClient::DownloadData\n        - api: System.Net.WebClient::DownloadDataAsync\n        - api: System.Net.WebClient::DownloadDataTaskAsync\n", "matches": [[{"type": "absolute", "value": 4199311}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199326}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "receive data": {"meta": {"name": "receive data", "namespace": "communication", "authors": ["william.ballenthin@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Command and Control", "C2 Communication", "Receive Data"], "objective": "Command and Control", "behavior": "C2 Communication", "method": "Receive Data", "id": "B0030.002"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"], "description": "all known techniques for receiving data from a potential C2 server", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n", "matches": [[{"type": "absolute", "value": 4199311}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "connect to HTTP server"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "connect to URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199326}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "wininet.InternetReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadStringTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadData"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadDataTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4199311}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204540}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "receive data on socket"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "read data from Internet"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "match", "match": "download URL"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "urlmon.URLDownloadToFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204566}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLDownloadToCacheFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenBlockingStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenPullStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFileAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFileTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.VisualBasic.Devices.Network::DownloadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204540}], "captures": {}}], "locations": [], "captures": {}}]]}, "set current directory": {"meta": {"name": "set current directory", "namespace": "host-interaction/file-system", "authors": ["michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": [], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::SetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.SetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199814}], "captures": {}}], "locations": [], "captures": {}}]]}, "create pipe": {"meta": {"name": "create pipe", "namespace": "communication/named-pipe/create", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Create Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Create Pipe", "id": "C0003.001"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003a13"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create pipe\n    namespace: communication/named-pipe/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Create Pipe [C0003.001]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003a13\n  features:\n    - or:\n      - api: kernel32.CreatePipe\n      - api: kernel32.CreateNamedPipe\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreatePipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199756}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateNamedPipe"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get hostname": {"meta": {"name": "get hostname", "namespace": "host-interaction/os/hostname", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "7351f8a40c5450557b24622417fc478d:0x405438"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199573}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerNameEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetComputerObjectName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204947}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerName"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4205071}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetComputerNameEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetComputerObjectName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ws2_32.gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "gethostname"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get common file path": {"meta": {"name": "get common file path", "namespace": "host-interaction/file-system", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10003415", "972B219F18379907A045431303F4DA7D:0x404887"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4199782}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201601}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetTempFileName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemDirectory"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201719}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetWindowsDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetSystemWow64Directory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAllUsersProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetAppContainerFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetDefaultUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetProfilesDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetUserProfileDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "SHGetFolderPathAndSubDir"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shell32.SHGetSpecialFolderLocation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.Directory::GetCurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetFolderPath"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::SystemDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::CurrentDirectory"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "terminate process": {"meta": {"name": "terminate process", "namespace": "host-interaction/process/terminate", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Process", "Terminate Process"], "objective": "Process", "behavior": "Terminate Process", "method": "", "id": "C0018"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77", "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200616}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4201232}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201351}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203037}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::Kill"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::WaitForExitAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Windows.Forms.Application::Exit"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "open process"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.OpenProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203108}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwOpenProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4203088}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.TerminateProcess"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203124}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntdll.NtTerminateProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ExitProcess"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get session user name": {"meta": {"name": "get session user name", "namespace": "host-interaction/session", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Owner/User Discovery"], "tactic": "Discovery", "technique": "System Owner/User Discovery", "subtechnique": "", "id": "T1033"}, {"parts": ["Discovery", "Account Discovery"], "tactic": "Discovery", "technique": "Account Discovery", "subtechnique": "", "id": "T1087"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 14-01.exe_:0x401285"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get session user name\n    namespace: host-interaction/session\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n      - Discovery::Account Discovery [T1087]\n    examples:\n      - Practical Malware Analysis Lab 14-01.exe_:0x401285\n  features:\n    - or:\n      - api: advapi32.GetUserName\n      - api: secur32.GetUserNameEx\n      - basic block:\n        - and:\n          # - match: get session information (see #463)\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - api: System.Security.Principal.WindowsIdentity::GetCurrent\n      - property/read: System.Environment::UserName\n", "matches": [[{"type": "absolute", "value": 4199430}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.GetUserName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "secur32.GetUserNameEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200341}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "get session user name/c330018476714498947d24c7f18e2611"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Security.Principal.WindowsIdentity::GetCurrent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Environment::UserName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "manipulate console buffer": {"meta": {"name": "manipulate console buffer", "namespace": "host-interaction/console", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Operating System", "Console"], "objective": "Operating System", "behavior": "Console", "method": "", "id": "C0033"}], "references": ["https://stackoverflow.com/a/15770935/87207"], "examples": ["3aa7ee4d67f562933bc998f352b1f319:0x705413A0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: manipulate console buffer\n    namespace: host-interaction/console\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Console [C0033]\n    references:\n      - https://stackoverflow.com/a/15770935/87207\n    examples:\n      - 3aa7ee4d67f562933bc998f352b1f319:0x705413A0\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.SetConsoleCursorPosition\n          - api: kernel32.ReadConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutputCharacter\n          - api: kernel32.WriteConsoleOutput\n          - api: kernel32.WriteConsoleInput\n        - optional:\n          - api: kernel32.GetStdHandle\n          - number: 0xfffffff5 = STD_OUTPUT_HANDLE\n      - api: System.Console::Write\n      - api: System.Console::WriteLine\n", "matches": [[{"type": "absolute", "value": 4200810}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Console::Write"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Console::WriteLine"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.SetConsoleCursorPosition"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.ReadConsoleOutputCharacter"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteConsoleOutputCharacter"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteConsoleOutput"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteConsoleInput"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4200979}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetStdHandle"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "number", "number": 4294967285, "description": "STD_OUTPUT_HANDLE"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read pipe": {"meta": {"name": "read pipe", "namespace": "communication/named-pipe/read", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Read Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Read Pipe", "id": "C0003.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4014C0"], "description": "PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read pipe\n    namespace: communication/named-pipe/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    description: PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Read Pipe [C0003.003]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4014C0\n  features:\n    - or:\n      - and:\n        - api: kernel32.PeekNamedPipe\n        - api: kernel32.ReadFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n", "matches": [[{"type": "absolute", "value": 4201379}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.TransactNamedPipe", "description": "writes and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.PeekNamedPipe"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201450}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201508}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read file on Windows": {"meta": {"name": "read file on Windows", "namespace": "host-interaction/file-system/read", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Read File"], "objective": "File System", "behavior": "Read File", "method": "", "id": "C0051"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n", "matches": [[{"type": "absolute", "value": 4201379}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201508}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4203389}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::ReadLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203611}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203623}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ReadFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203846}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ReadFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwReadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_read"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fread"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query environment variable": {"meta": {"name": "query environment variable", "namespace": "host-interaction/environment-variable", "authors": ["michael.hunhoff@mandiant.com", "@_re_fox"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x401880", "0761142efbda6c4b1e801223de723578:0x65483490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n", "matches": [[{"type": "absolute", "value": 4201601}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.ExpandEnvironmentStrings"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201701}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcr90.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "msvcrt.getenv"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "check if file exists": {"meta": {"name": "check if file exists", "namespace": "host-interaction/file-system/exists", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["31600AD0D1A7EA615690DF111AE36C73:0x401284"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n", "matches": [[{"type": "absolute", "value": 4201601}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileAttributes"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201751}], "captures": {}}, {"success": true, "node": {"statement": {"scope": "instruction", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "mnemonic", "mnemonic": "cmp"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201757}], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 4294967295, "description": "INVALID_FILE_ATTRIBUTES"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4201757}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201757}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4201744}], "captures": {}}, {"success": false, "node": {"feature": {"type": "match", "match": "check if file exists/baf4b26aa4d543908c1305d8206b0b7b"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "shlwapi.PathFileExists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileSystemInfo::Exists"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate services": {"meta": {"name": "enumerate services", "namespace": "host-interaction/service/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Service Discovery"], "tactic": "Discovery", "technique": "System Service Discovery", "subtechnique": "", "id": "T1007"}], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 05-01.dll_:0x1000B823"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate services\n    namespace: host-interaction/service/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Service Discovery [T1007]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x1000B823\n  features:\n    - or:\n      - api: advapi32.EnumServicesStatus\n      - api: advapi32.EnumServicesStatusEx\n      - api: advapi32.EnumDependentServices\n", "matches": [[{"type": "absolute", "value": 4202237}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatus"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.EnumServicesStatusEx"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202600}, {"type": "absolute", "value": 4202529}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.EnumDependentServices"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get disk information": {"meta": {"name": "get disk information", "namespace": "host-interaction/hardware/storage", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "972B219F18379907A045431303F4DA7D:0x41064E"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n", "matches": [[{"type": "absolute", "value": 4202237}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetDriveType"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202843}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDrives"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202709}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeInformation"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202947}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumeNameForVolumeMountPoint"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetVolumePathNamesForVolumeName"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetLogicalDriveStrings"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.QueryDosDevice"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::VolumeLabel"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveType"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::DriveFormat"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.DriveInfo::Name"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "enumerate processes": {"meta": {"name": "enumerate processes", "namespace": "host-interaction/process/list", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "Process Discovery"], "tactic": "Discovery", "technique": "Process Discovery", "subtechnique": "", "id": "T1057"}, {"parts": ["Discovery", "Software Discovery"], "tactic": "Discovery", "technique": "Software Discovery", "subtechnique": "", "id": "T1518"}], "mbc": [], "references": [], "examples": ["2D3EDC218A90F03089CC01715A9F047F:0x403DAB", "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n", "matches": [[{"type": "absolute", "value": 4202237}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.Diagnostics.Process::GetProcesses"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32First"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202380}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.Process32Next"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202446}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"scope": "basic block", "type": "subscope"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateToolhelp32Snapshot"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202338}], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "number", "number": 15, "description": "TH32CS_SNAPALL"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "TH32CS_SNAPPROCESS"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4202336}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4202294}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get service handle": {"meta": {"name": "get service handle", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n", "matches": [[{"type": "absolute", "value": 4203037}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateService"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.OpenService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203230}], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 4204123}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateService"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.OpenService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204350}], "captures": {}}], "locations": [], "captures": {}}]]}, "stop service": {"meta": {"name": "stop service", "namespace": "host-interaction/service/stop", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Persistence", "Create or Modify System Process", "Windows Service"], "tactic": "Persistence", "technique": "Create or Modify System Process", "subtechnique": "Windows Service", "id": "T1543.003"}, {"parts": ["Impact", "Service Stop"], "tactic": "Impact", "technique": "Service Stop", "subtechnique": "", "id": "T1489"}], "mbc": [], "references": [], "examples": ["E544A4D616B60147D9774B48C2B65EF2:0x402140"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: stop service\n    namespace: host-interaction/service/stop\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Impact::Service Stop [T1489]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x402140\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - number: 0x1 = SERVICE_CONTROL_STOP\n      - or:\n        - api: advapi32.ControlService\n        - api: advapi32.ControlServiceEx\n", "matches": [[{"type": "absolute", "value": 4203037}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1, "description": "SERVICE_CONTROL_STOP"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203121}, {"type": "absolute", "value": 4203290}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "get service handle"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateService"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.OpenService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203230}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4203037}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.ControlService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203293}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "advapi32.ControlServiceEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get file size": {"meta": {"name": "get file size", "namespace": "host-interaction/file-system/meta", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [{"parts": ["Discovery", "File and Directory Discovery"], "tactic": "Discovery", "technique": "File and Directory Discovery", "subtechnique": "", "id": "T1083"}], "mbc": [{"parts": ["Discovery", "File and Directory Discovery"], "objective": "Discovery", "behavior": "File and Directory Discovery", "method": "", "id": "E1083"}], "references": [], "examples": ["mimikatz.exe_:0x40630D"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n", "matches": [[{"type": "absolute", "value": 4203389}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSize"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203670}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.GetFileSizeEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.IO.FileInfo::Length"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 4203389}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.File::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "os", "os": "windows"}, "type": "feature"}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 1073741824, "description": "GENERIC_WRITE"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203594}], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "kernel32.CreateFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203623}], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "number", "number": 2, "description": "FILE_WRITE_DATA"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203590}], "captures": {}}, {"success": false, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "NtCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwCreateFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "kernel32.WriteFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203922}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "kernel32.WriteFileEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "NtWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ZwWriteFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "_fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "fwrite"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "reference HTTP User-Agent string": {"meta": {"name": "reference HTTP User-Agent string", "namespace": "communication/http", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": ["https://www.useragents.me/", "https://www.whatismybrowser.com/guides/the-latest-user-agent/"], "examples": ["0796F1C1EA0A142FC1EB7109A44C86CB:0x4043F0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: reference HTTP User-Agent string\n    namespace: communication/http\n    authors:\n      - \"@mr-tz\"\n    scope: function\n    references:\n      - https://www.useragents.me/\n      - https://www.whatismybrowser.com/guides/the-latest-user-agent/\n    examples:\n      - 0796F1C1EA0A142FC1EB7109A44C86CB:0x4043F0\n  features:\n    - or:\n      - substring: \"Mozilla/5.0\"\n      - substring: \"like Gecko\"\n      - api: urlmon.ObtainUserAgentString\n      - property/read: System.Net.HttpWebRequest::UserAgent\n", "matches": [[{"type": "absolute", "value": 4203389}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "urlmon.ObtainUserAgentString"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "property", "access": "read", "property": "System.Net.HttpWebRequest::UserAgent"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "substring", "substring": "Mozilla/5.0"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4203425}], "captures": {"Mozilla/5.0": [{"type": "absolute", "value": 4203425}]}}, {"success": false, "node": {"feature": {"type": "substring", "substring": "like Gecko"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "start service": {"meta": {"name": "start service", "namespace": "host-interaction/service/start", "authors": ["moritz.raabe@mandiant.com"], "scope": "function", "attack": [{"parts": ["Persistence", "Create or Modify System Process", "Windows Service"], "tactic": "Persistence", "technique": "Create or Modify System Process", "subtechnique": "Windows Service", "id": "T1543.003"}], "mbc": [], "references": [], "examples": ["E544A4D616B60147D9774B48C2B65EF2:0x401FA0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n", "matches": [[{"type": "absolute", "value": 4204123}, {"success": true, "node": {"statement": {"type": "and"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "advapi32.StartService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204409}], "captures": {}}, {"success": true, "node": {"statement": {"type": "optional"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "match", "match": "get service handle"}, "type": "feature"}, "children": [{"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "advapi32.CreateService"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "advapi32.OpenService"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204350}], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 4204123}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "download URL": {"meta": {"name": "download URL", "namespace": "communication/http/client", "authors": ["matthew.williams@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scope": "function", "attack": [], "mbc": [{"parts": ["Communication", "HTTP Communication", "Download URL"], "objective": "Communication", "behavior": "HTTP Communication", "method": "Download URL", "id": "C0002.006"}], "references": [], "examples": ["F5C93AC768C8206E87544DDD76B3277C:0x100020F0", "Practical Malware Analysis Lab 20-01.exe_:0x401040"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: download URL\n    namespace: communication/http/client\n    authors:\n      - matthew.williams@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Download URL [C0002.006]\n    examples:\n      - F5C93AC768C8206E87544DDD76B3277C:0x100020F0\n      - Practical Malware Analysis Lab 20-01.exe_:0x401040\n  features:\n    - or:\n      - api: urlmon.URLDownloadToFile\n      - api: urlmon.URLDownloadToCacheFile\n      - api: urlmon.URLOpenBlockingStream\n      - api: urlmon.URLOpenPullStream\n      - api: urlmon.URLOpenStream\n      - api: System.Net.WebClient::DownloadFile\n      - api: System.Net.WebClient::DownloadFileAsync\n      - api: System.Net.WebClient::DownloadFileTaskAsync\n      - api: Microsoft.VisualBasic.Devices.Network::DownloadFile\n", "matches": [[{"type": "absolute", "value": 4204540}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": true, "node": {"feature": {"type": "api", "api": "urlmon.URLDownloadToFile"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204566}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLDownloadToCacheFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenBlockingStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenPullStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "urlmon.URLOpenStream"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFileAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "System.Net.WebClient::DownloadFileTaskAsync"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "Microsoft.VisualBasic.Devices.Network::DownloadFile"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scope": "function", "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n", "matches": [[{"type": "absolute", "value": 4204947}, {"success": true, "node": {"statement": {"type": "or"}, "type": "statement"}, "children": [{"success": false, "node": {"feature": {"type": "api", "api": "RtlGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "ntoskrnl.PsGetVersion"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"feature": {"type": "api", "api": "GetVersion"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4204953}], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "GetVersionEx"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerifyVersionInfo"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "VerSetConditionMask"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}, "type": "feature"}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain a resource (.rsrc) section": {"meta": {"name": "contain a resource (.rsrc) section", "namespace": "executable/pe/section/rsrc", "authors": ["moritz.raabe@mandiant.com"], "scope": "file", "attack": [], "mbc": [], "references": [], "examples": ["A933A1A402775CFA94B6BEE0963F4B46:0x41fd25"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n", "matches": [[{"type": "no address"}, {"success": true, "node": {"feature": {"type": "section", "section": ".rsrc"}, "type": "feature"}, "children": [], "locations": [{"type": "absolute", "value": 4214784}], "captures": {}}]]}}}
