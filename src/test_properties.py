#!/usr/bin/python3

import ast
import pydot

prop = {
    'is_top_node': False, # -> bool
    'capa_node': False, # -> bool
    'capa_id': None, # -> list(str)
    'capa_title': None, # -> list(str)
    'mbc_id': None, # -> list(str)
    'mbc_title': None, # -> list(str)
    'instruction_sets': None, # -> str
    'label': None, # -> list(str)
    'location': None, # -> int or None
    'start_ea': 0x0, # -> int
    'end_ea': 0x0 # -> int
}

imported_graph = pydot.graph_from_dot_file("../outputs/00be6858156b0be404b4fa4852ffc550c25565236beaa4cb13ffe288bcb48d8e/behavior-graph.dot")[0]

nodes = imported_graph.get_node_list()
for n in nodes:
    idx = n.get_name().strip("\"")
    if not idx.isnumeric():
        continue
    print("node :", idx)
    lbl = n.get_comment()
    print("content of comment:\n\t", lbl)
    o = ast.literal_eval(lbl.strip("\""))
    print("loading each section of prop")
    for k,v in o.items():
        print("\t", k, v)